var Jc=Object.defineProperty;var go=Object.getOwnPropertySymbols;var Xc=Object.prototype.hasOwnProperty,Yc=Object.prototype.propertyIsEnumerable;var po=(r,t,e)=>t in r?Jc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,tn=(r,t)=>{for(var e in t||(t={}))Xc.call(t,e)&&po(r,e,t[e]);if(go)for(var e of go(t))Yc.call(t,e)&&po(r,e,t[e]);return r};import{K as Kc,L as Zc,M as Qc,N as tu,O as eu,P as nu,Q as iu,R as en,S as ru,T as su,U as ou,V as au,W as lu,X as cu,Y as uu,Z as hu,_ as du,$ as fu,a0 as gu,a1 as pu,a2 as mu,a3 as mo,a4 as nn,a5 as yu,a6 as Xr,a7 as yo,a8 as bu,a9 as vu,aa as wu,ab as re,ac as bo,ad as E,r as xu,ae as Pu,o as Ne,c as Te,b as jt,a as bt,q as Qt,af as Ou,F as Eu,s as Cu,ag as _u,ah as Su,z as Yr,ai as vo,d as wo,f as te,i as xo,aj as Mu,x as Au,y as Nu,ak as Po,al as Tu,A as ju,am as Du,an as Lu,ao as $u,ap as Bu,aq as Ru}from"./vendor.5429ab58.js";import{_ as Kr}from"./index.9fbf0fe6.js";var R={},Zr={},rn={},Pt={};typeof window=="object"&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);typeof window!="undefined"&&function(r){r.forEach(t=>{Object.prototype.hasOwnProperty.call(t,"append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value(...e){const n=document.createDocumentFragment();e.forEach(s=>{const a=s instanceof Node;n.appendChild(a?s:document.createTextNode(String(s)))}),this.appendChild(n)}})})}([Element.prototype,Document.prototype,DocumentFragment.prototype]);class je{get disposed(){return this._disposed===!0}dispose(){this._disposed=!0}}(function(r){function t(){return(e,n,s)=>{const a=s.value,u=e.__proto__;s.value=function(...h){this.disposed||(a.call(this,...h),u.dispose.call(this))}}}r.dispose=t})(je||(je={}));class Iu{constructor(t){this.callback=t}get disposed(){return!this.callback}dispose(){if(!this.callback)return;const t=this.callback;this.callback=null,t()}}class Qr{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach(t=>{t.dispose()}),this.items.clear())}contains(t){return this.items.has(t)}add(t){this.items.add(t)}remove(t){this.items.delete(t)}clear(){this.items.clear()}}(function(r){function t(e){const n=new r;return e.forEach(s=>{n.add(s)}),n}r.from=t})(Qr||(Qr={}));function ts(r,t,e){if(e)switch(e.length){case 0:return r.call(t);case 1:return r.call(t,e[0]);case 2:return r.call(t,e[0],e[1]);case 3:return r.call(t,e[0],e[1],e[2]);case 4:return r.call(t,e[0],e[1],e[2],e[3]);case 5:return r.call(t,e[0],e[1],e[2],e[3],e[4]);case 6:return r.call(t,e[0],e[1],e[2],e[3],e[4],e[5]);default:return r.apply(t,e)}return r.call(t)}function Vu(r,t,...e){return ts(r,t,e)}function Oo(r){return typeof r=="object"&&r.then&&typeof r.then=="function"}function es(r){return r!=null&&(r instanceof Promise||Oo(r))}function $n(...r){const t=[];if(r.forEach(n=>{Array.isArray(n)?t.push(...n):t.push(n)}),t.some(n=>es(n))){const n=t.map(s=>es(s)?s:Promise.resolve(s!==!1));return Promise.all(n).then(s=>s.reduce((a,u)=>u!==!1&&a,!0))}return t.every(n=>n!==!1)}function Fu(...r){const t=$n(r);return typeof t=="boolean"?Promise.resolve(t):t}var zu=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",debounce:Kc,throttle:Zc,apply:ts,call:Vu,isAsyncLike:Oo,isAsync:es,toAsyncBoolean:$n,toDeferredBoolean:Fu});function ns(r,t){const e=[];for(let n=0;n<r.length;n+=2){const s=r[n],a=r[n+1],u=Array.isArray(t)?t:[t],h=ts(s,a,u);e.push(h)}return $n(e)}class Eo{constructor(){this.listeners={}}on(t,e,n){return e==null?this:(this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e,n),this)}once(t,e,n){const s=(...a)=>(this.off(t,s),ns([e,n],a));return this.on(t,s,this)}off(t,e,n){if(!(t||e||n))return this.listeners={},this;const s=this.listeners;return(t?[t]:Object.keys(s)).forEach(u=>{const h=s[u];if(!!h){if(!(e||n)){delete s[u];return}for(let d=h.length-2;d>=0;d-=2)e&&h[d]!==e||n&&h[d+1]!==n||h.splice(d,2)}}),this}trigger(t,...e){let n=!0;if(t!=="*"){const a=this.listeners[t];a!=null&&(n=ns([...a],e))}const s=this.listeners["*"];return s!=null?$n([n,ns([...s],[t,...e])]):n}emit(t,...e){return this.trigger(t,...e)}}function Co(r,...t){t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n))})})}const ku=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])};function _o(r,t){ku(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}class Hu{}const Gu=/^\s*class\s+/.test(`${Hu}`)||/^\s*class\s*\{/.test(`${class{}}`);function qu(r,t){let e;return Gu?e=class extends t{}:(e=function(){return t.apply(this,arguments)},_o(e,t)),Object.defineProperty(e,"name",{value:r}),e}function So(r,t){return r!=null?r:t}function Wu(r,t,e){const n=r!=null?r[t]:null;return e!==void 0?So(n,e):n}function Uu(r,t,e){let n=r!=null?r[t]:null;return n==null||(n=+n,Number.isNaN(n)||!Number.isFinite(n))?e:n}function Ju(r,t,e){const n=r!=null?r[t]:null;return n==null?e:!!n}function is(r){return r==="__proto__"}function Mo(r,t,e="/"){let n;const s=Array.isArray(t)?t:t.split(e);if(s.length)for(n=r;s.length;){const a=s.shift();if(Object(n)===n&&a&&a in n)n=n[a];else return}return n}function Xu(r,t,e,n="/"){const s=Array.isArray(t)?t:t.split(n),a=s.pop();if(a&&!is(a)){let u=r;s.forEach(h=>{is(h)||(u[h]==null&&(u[h]={}),u=u[h])}),u[a]=e}return r}function Yu(r,t,e="/"){const n=Array.isArray(t)?t.slice():t.split(e),s=n.pop();if(s)if(n.length>0){const a=Mo(r,n);a&&delete a[s]}else delete r[s];return r}function Ao(r,t="/",e){const n={};Object.keys(r).forEach(s=>{const a=r[s];let u=typeof a=="object"||Array.isArray(a);if(u&&e&&e(a)&&(u=!1),u){const h=Ao(a,t,e);Object.keys(h).forEach(d=>{n[s+t+d]=h[d]})}else n[s]=a});for(const s in r)!!Object.prototype.hasOwnProperty.call(r,s);return n}var Ku=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",ensure:So,getValue:Wu,getNumber:Uu,getBoolean:Ju,isMaliciousProp:is,getByPath:Mo,setByPath:Xu,unsetByPath:Yu,flatten:Ao,has:Qc,pick:tu,merge:eu,isEqual:nu,isEmpty:iu,isObject:en,isPlainObject:ru,clone:su,cloneDeep:ou,defaults:au,defaultsDeep:lu,applyMixins:Co,inherit:_o,createClass:qu}),Zu=globalThis&&globalThis.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};class De extends Eo{dispose(){this.off()}}Zu([je.dispose()],De.prototype,"dispose",null);(function(r){r.dispose=je.dispose})(De||(De={}));Co(De,je);class Qu extends De{get disabled(){return this._disabled===!0}enable(){delete this._disabled}disable(){this._disabled=!0}}var th=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uniq:cu,union:uu,sortedIndex:hu,sortedIndexBy:du,sortBy:fu,groupBy:gu,difference:pu,max:mu});const me=r=>{const t=Object.create(null);return e=>t[e]||(t[e]=r(e))},No=me(r=>r.replace(/\B([A-Z])/g,"-$1").toLowerCase()),eh=me(r=>mo(nn(r)).replace(/ /g,"")),nh=me(r=>yu(r).replace(/ /g,"_")),ih=me(r=>Xr(r).replace(/ /g,".")),rh=me(r=>Xr(r).replace(/ /g,"/")),sh=me(r=>yo(Xr(r))),oh=me(r=>mo(nn(r)));function ah(r){let t=2166136261,e=!1,n=r;for(let s=0,a=n.length;s<a;s+=1){let u=n.charCodeAt(s);u>127&&!e&&(n=unescape(encodeURIComponent(n)),u=n.charCodeAt(s),e=!0),t^=u,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)}return t>>>0}function To(){let r="";const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let e=0,n=t.length;e<n;e+=1){const s=t[e],a=Math.random()*16|0;r+=(s==="x"?a:s==="y"?a&3|8:s).toString(16)}return r}function lh(r,t,e){const n=Math.min(2,Math.floor(r.length*.34));let s=Math.floor(r.length*.4)+1,a,u=!1;const h=r.toLowerCase();for(const d of t){const c=e(d);if(c!==void 0&&Math.abs(c.length-h.length)<=n){const i=c.toLowerCase();if(i===h){if(c===r)continue;return d}if(u||c.length<3)continue;const o=ch(h,i,s-1);if(o===void 0)continue;o<3?(u=!0,a=d):(s=o,a=d)}}return a}function ch(r,t,e){let n=new Array(t.length+1),s=new Array(t.length+1);const a=e+1;for(let h=0;h<=t.length;h+=1)n[h]=h;for(let h=1;h<=r.length;h+=1){const d=r.charCodeAt(h-1),c=h>e?h-e:1,i=t.length>e+h?e+h:t.length;s[0]=h;let o=h;for(let f=1;f<c;f+=1)s[f]=a;for(let f=c;f<=i;f+=1){const g=d===t.charCodeAt(f-1)?n[f-1]:Math.min(n[f]+1,s[f-1]+1,n[f-1]+2);s[f]=g,o=Math.min(o,g)}for(let f=i+1;f<=t.length;f+=1)s[f]=a;if(o>e)return;const l=n;n=s,s=l}const u=n[t.length];return u>e?void 0:u}var uh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",uniqueId:bu,lowerFirst:vu,upperFirst:yo,camelCase:nn,kebabCase:No,pascalCase:eh,constantCase:nh,dotCase:ih,pathCase:rh,sentenceCase:sh,titleCase:oh,hashcode:ah,uuid:To,getSpellingSuggestion:lh});function hh(r,t){return(r%t+t)%t}function dh(r,t){if(t==null)t=r==null?1:r,r=0;else if(t<r){const e=r;r=t,t=e}return Math.floor(Math.random()*(t-r+1)+r)}function jo(r){return typeof r=="string"&&r.slice(-1)==="%"}function fh(r,t){if(r==null)return 0;let e;if(typeof r=="string"){if(e=parseFloat(r),jo(r)&&(e/=100,Number.isFinite(e)))return e*t}else e=r;return Number.isFinite(e)?e>0&&e<1?e*t:e:0}function gh(r,t){function e(u){const h=new RegExp(`(?:\\d+(?:\\.\\d+)*)(${u})$`).exec(r);return h?h[1]:null}const n=parseFloat(r);if(Number.isNaN(n))return null;let s;if(t==null)s="[A-Za-z]*";else if(Array.isArray(t)){if(t.length===0)return null;s=t.join("|")}else typeof t=="string"&&(s=t);const a=e(s);return a===null?null:{unit:a,value:n}}function ph(r){if(typeof r=="object"){let e=0,n=0,s=0,a=0;return r.vertical!=null&&Number.isFinite(r.vertical)&&(n=a=r.vertical),r.horizontal!=null&&Number.isFinite(r.horizontal)&&(s=e=r.horizontal),r.left!=null&&Number.isFinite(r.left)&&(e=r.left),r.top!=null&&Number.isFinite(r.top)&&(n=r.top),r.right!=null&&Number.isFinite(r.right)&&(s=r.right),r.bottom!=null&&Number.isFinite(r.bottom)&&(a=r.bottom),{top:n,right:s,bottom:a,left:e}}let t=0;return r!=null&&Number.isFinite(r)&&(t=r),{top:t,right:t,bottom:t,left:t}}var mh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",mod:hh,random:dh,isPercentage:jo,normalizePercentage:fh,parseCssNumeric:gh,normalizeSides:ph,isNumber:wu,clamp:re});let rs=!1,Do=!1,Lo=!1,$o=!1,Bo=!1,Ro=!1,Io=!1,Vo=!1,Fo=!1,zo=!1,ko=!1,Ho=!1,Go=!1,qo=!1,Wo=!1,Uo=!1;if(typeof navigator=="object"){const r=navigator.userAgent;rs=r.indexOf("Macintosh")>=0,Do=!!r.match(/(iPad|iPhone|iPod)/g),Lo=r.indexOf("Windows")>=0,$o=r.indexOf("MSIE")>=0,Bo=!!r.match(/Trident\/7\./),Ro=!!r.match(/Edge\//),Io=r.indexOf("Mozilla/")>=0&&r.indexOf("MSIE")<0&&r.indexOf("Edge/")<0,Fo=r.indexOf("Chrome/")>=0&&r.indexOf("Edge/")<0,zo=r.indexOf("Opera/")>=0||r.indexOf("OPR/")>=0,ko=r.indexOf("Firefox/")>=0,Ho=r.indexOf("AppleWebKit/")>=0&&r.indexOf("Chrome/")<0&&r.indexOf("Edge/")<0,typeof document=="object"&&(Uo=!document.createElementNS||`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`!="[object SVGForeignObjectElement]"||r.indexOf("Opera/")>=0)}typeof window=="object"&&(Vo=window.chrome!=null&&window.chrome.app!=null&&window.chrome.app.runtime!=null,qo=window.PointerEvent!=null&&!rs);if(typeof document=="object"){Go="ontouchstart"in document.documentElement;try{const r=Object.defineProperty({},"passive",{get(){Wo=!0}}),t=document.createElement("div");t.addEventListener&&t.addEventListener("click",()=>{},r)}catch{}}var ye;(function(r){r.IS_MAC=rs,r.IS_IOS=Do,r.IS_WINDOWS=Lo,r.IS_IE=$o,r.IS_IE11=Bo,r.IS_EDGE=Ro,r.IS_NETSCAPE=Io,r.IS_CHROME_APP=Vo,r.IS_CHROME=Fo,r.IS_OPERA=zo,r.IS_FIREFOX=ko,r.IS_SAFARI=Ho,r.SUPPORT_TOUCH=Go,r.SUPPORT_POINTER=qo,r.SUPPORT_PASSIVE=Wo,r.NO_FOREIGNOBJECT=Uo,r.SUPPORT_FOREIGNOBJECT=!r.NO_FOREIGNOBJECT})(ye||(ye={}));(function(r){function t(){const a=window.module;return a!=null&&a.hot!=null&&a.hot.status!=null?a.hot.status():"unkonwn"}r.getHMRStatus=t;function e(){return t()==="apply"}r.isApplyingHMR=e;const n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function s(a){const u=document.createElement(n[a]||"div"),h=`on${a}`;let d=h in u;return d||(u.setAttribute(h,"return;"),d=typeof u[h]=="function"),d}r.isEventSupported=s})(ye||(ye={}));const ss=/[\t\r\n\f]/g,os=/\S+/g,Le=r=>` ${r} `;function be(r){return r&&r.getAttribute&&r.getAttribute("class")||""}function sn(r,t){if(r==null||t==null)return!1;const e=Le(be(r)),n=Le(t);return r.nodeType===1?e.replace(ss," ").includes(n):!1}function on(r,t){if(!(r==null||t==null)){if(typeof t=="function")return on(r,t(be(r)));if(typeof t=="string"&&r.nodeType===1){const e=t.match(os)||[],n=Le(be(r)).replace(ss," ");let s=e.reduce((a,u)=>a.indexOf(Le(u))<0?`${a}${u} `:a,n);s=s.trim(),n!==s&&r.setAttribute("class",s)}}}function an(r,t){if(r!=null){if(typeof t=="function")return an(r,t(be(r)));if((!t||typeof t=="string")&&r.nodeType===1){const e=(t||"").match(os)||[],n=Le(be(r)).replace(ss," ");let s=e.reduce((a,u)=>{const h=Le(u);return a.indexOf(h)>-1?a.replace(h," "):a},n);s=t?s.trim():"",n!==s&&r.setAttribute("class",s)}}}function as(r,t,e){if(!(r==null||t==null)){if(e!=null&&typeof t=="string"){e?on(r,t):an(r,t);return}if(typeof t=="function")return as(r,t(be(r),e),e);typeof t=="string"&&(t.match(os)||[]).forEach(s=>{sn(r,s)?an(r,s):on(r,s)})}}let Jo=0;function Xo(){return Jo+=1,`v${Jo}`}function yh(r){return(r.id==null||r.id==="")&&(r.id=Xo()),r.id}function ln(r){return r==null?!1:typeof r.getScreenCTM=="function"&&r instanceof SVGElement}const kt={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},ls="1.1";function bh(r,t=document){return t.createElement(r)}function Yo(r,t=kt.xhtml,e=document){return e.createElementNS(t,r)}function $e(r,t=document){return Yo(r,kt.svg,t)}function Bn(r){if(r){const e=`<svg xmlns="${kt.svg}" xmlns:xlink="${kt.xlink}" version="${ls}">${r}</svg>`,{documentElement:n}=Ko(e,{async:!1});return n}const t=document.createElementNS(kt.svg,"svg");return t.setAttributeNS(kt.xmlns,"xmlns:xlink",kt.xlink),t.setAttribute("version",ls),t}function Ko(r,t={}){let e;try{const n=new DOMParser;if(t.async!=null){const s=n;s.async=t.async}e=n.parseFromString(r,t.mimeType||"text/xml")}catch{e=void 0}if(!e||e.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${r}`);return e}function Zo(r,t=!0){const e=r.nodeName;return t?e.toLowerCase():e.toUpperCase()}function Qo(r){let t=0,e=r.previousSibling;for(;e;)e.nodeType===1&&(t+=1),e=e.previousSibling;return t}function ta(r,t){return r.querySelectorAll(t)}function ea(r,t){return r.querySelector(t)}function na(r,t,e){const n=r.ownerSVGElement;let s=r.parentNode;for(;s&&s!==e&&s!==n;){if(sn(s,t))return s;s=s.parentNode}return null}function ia(r,t){const e=t&&t.parentNode;return r===e||!!(e&&e.nodeType===1&&r.compareDocumentPosition(e)&16)}function ra(r){r&&(Array.isArray(r)?r:[r]).forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})}function cs(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function us(r,t){(Array.isArray(t)?t:[t]).forEach(n=>{n!=null&&r.appendChild(n)})}function sa(r,t){const e=r.firstChild;return e?hs(e,t):us(r,t)}function hs(r,t){const e=r.parentNode;e&&(Array.isArray(t)?t:[t]).forEach(s=>{s!=null&&e.insertBefore(s,r)})}function vh(r,t){const e=r.parentNode;e&&(Array.isArray(t)?t:[t]).forEach(s=>{s!=null&&e.insertBefore(s,r.nextSibling)})}function oa(r,t){t!=null&&t.appendChild(r)}function aa(r){return!!r&&r.nodeType===1}function wh(r){try{return r instanceof HTMLElement}catch{return typeof r=="object"&&r.nodeType===1&&typeof r.style=="object"&&typeof r.ownerDocument=="object"}}function xh(r,t){const e=[];let n=r.firstChild;for(;n;n=n.nextSibling)n.nodeType===1&&(!t||sn(n,t))&&e.push(n);return e}const la=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function ca(r,t){return r.getAttribute(t)}function ds(r,t){const e=gs(t);e.ns?r.hasAttributeNS(e.ns,e.local)&&r.removeAttributeNS(e.ns,e.local):r.hasAttribute(t)&&r.removeAttribute(t)}function Rn(r,t,e){if(e==null)return ds(r,t);const n=gs(t);n.ns&&typeof e=="string"?r.setAttributeNS(n.ns,t,e):t==="id"?r.id=`${e}`:r.setAttribute(t,`${e}`)}function fs(r,t){Object.keys(t).forEach(e=>{Rn(r,e,t[e])})}function vt(r,t,e){if(t==null){const n=r.attributes,s={};for(let a=0;a<n.length;a+=1)s[n[a].name]=n[a].value;return s}if(typeof t=="string"&&e===void 0)return r.getAttribute(t);typeof t=="object"?fs(r,t):Rn(r,t,e)}function gs(r){if(r.indexOf(":")!==-1){const t=r.split(":");return{ns:kt[t[0]],local:t[1]}}return{ns:null,local:r}}function Ph(r){const t={};return Object.keys(r).forEach(e=>{const n=la.includes(e)?e:No(e);t[n]=r[e]}),t}function cn(r){const t={};return r.split(";").forEach(n=>{const s=n.trim();if(s){const a=s.split("=");a.length&&(t[a[0].trim()]=a[1]?a[1].trim():"")}}),t}function In(r,t){return Object.keys(t).forEach(e=>{if(e==="class")r[e]=r[e]?`${r[e]} ${t[e]}`:t[e];else if(e==="style"){const n=typeof r[e]=="object",s=typeof t[e]=="object";let a,u;n&&s?(a=r[e],u=t[e]):n?(a=r[e],u=cn(t[e])):s?(a=cn(r[e]),u=t[e]):(a=cn(r[e]),u=cn(t[e])),r[e]=In(a,u)}else r[e]=t[e]}),r}function ua(r,t,e={}){const n=e.offset||0,s=[],a=[];let u,h,d=null;for(let c=0;c<r.length;c+=1){u=a[c]=r[c];for(let i=0,o=t.length;i<o;i+=1){const l=t[i],f=l.start+n,g=l.end+n;c>=f&&c<g&&(typeof u=="string"?u=a[c]={t:r[c],attrs:l.attrs}:u.attrs=In(In({},u.attrs),l.attrs),e.includeAnnotationIndices&&(u.annotations==null&&(u.annotations=[]),u.annotations.push(i)))}h=a[c-1],h?en(u)&&en(h)?(d=d,JSON.stringify(u.attrs)===JSON.stringify(h.attrs)?d.t+=u.t:(s.push(d),d=u)):en(u)||en(h)?(d=d,s.push(d),d=u):d=(d||"")+u:d=u}return d!=null&&s.push(d),s}function Oh(r,t){return r?r.filter(e=>e.start<t&&t<=e.end):[]}function Eh(r,t,e){return r?r.filter(n=>t>=n.start&&t<n.end||e>n.start&&e<=n.end||n.start>=t&&n.end<e):[]}function Ch(r,t,e){return r&&r.forEach(n=>{n.start<t&&n.end>=t?n.end+=e:n.start>=t&&(n.start+=e,n.end+=e)}),r}function ha(r){return r.replace(/ /g,"\xA0")}var _h=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",annotate:ua,findAnnotationsAtIndex:Oh,findAnnotationsBetweenIndexes:Eh,shiftAnnotations:Ch,sanitize:ha}),ps;(function(r){function t(c){const i="data:";return c.substr(0,i.length)===i}r.isDataUrl=t;function e(c,i){if(!c||t(c)){setTimeout(()=>i(null,c));return}const o=()=>{i(new Error(`Failed to load image: ${c}`))},l=window.FileReader?g=>{if(g.status===200){const p=new FileReader;p.onload=m=>{const y=m.target.result;i(null,y)},p.onerror=o,p.readAsDataURL(g.response)}else o()}:g=>{const p=m=>{const y=32768,b=[];for(let v=0;v<m.length;v+=y)b.push(String.fromCharCode.apply(null,m.subarray(v,v+y)));return b.join("")};if(g.status===200){let m=c.split(".").pop()||"png";m==="svg"&&(m="svg+xml");const y=`data:image/${m};base64,`,b=new Uint8Array(g.response),v=y+btoa(p(b));i(null,v)}else o()},f=new XMLHttpRequest;f.responseType=window.FileReader?"blob":"arraybuffer",f.open("GET",c,!0),f.addEventListener("error",o),f.addEventListener("load",()=>l(f)),f.send()}r.imageToDataUri=e;function n(c){let i=c.replace(/\s/g,"");i=decodeURIComponent(i);const o=i.indexOf(","),l=i.slice(0,o),f=l.split(":")[1].split(";")[0],g=i.slice(o+1);let p;l.indexOf("base64")>=0?p=atob(g):p=unescape(encodeURIComponent(g));const m=new Uint8Array(p.length);for(let y=0;y<p.length;y+=1)m[y]=p.charCodeAt(y);return new Blob([m],{type:f})}r.dataUriToBlob=n;function s(c,i){const o=window.navigator.msSaveBlob;if(o)o(c,i);else{const l=window.URL.createObjectURL(c),f=document.createElement("a");f.href=l,f.download=i,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(l)}}r.downloadBlob=s;function a(c,i){const o=n(c);s(o,i)}r.downloadDataUri=a;function u(c){const i=c.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return i&&i[2]?i[2].replace(/\s+/," ").split(" "):null}function h(c){const i=parseFloat(c);return Number.isNaN(i)?null:i}function d(c,i={}){let o=null;const l=v=>(o==null&&(o=u(c)),o!=null?h(o[v]):null),f=v=>{const x=c.match(v);return x&&x[2]?h(x[2]):null};let g=i.width;if(g==null&&(g=f(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),g==null&&(g=l(2)),g==null)throw new Error("Can not parse width from svg string");let p=i.height;if(p==null&&(p=f(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),p==null&&(p=l(3)),p==null)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(c).replace(/'/g,"%27").replace(/"/g,"%22")}`}r.svgToDataUrl=d})(ps||(ps={}));let ve;const Sh={px(r){return r},mm(r){return ve*r},cm(r){return ve*r*10},in(r){return ve*r*25.4},pt(r){return ve*(25.4*r/72)},pc(r){return ve*(25.4*r/6)}};var ms;(function(r){function t(n,s,a){const u=document.createElement("div"),h=u.style;h.display="inline-block",h.position="absolute",h.left="-15000px",h.top="-15000px",h.width=n+(a||"px"),h.height=s+(a||"px"),document.body.appendChild(u);const d=u.getBoundingClientRect(),c={width:d.width||0,height:d.height||0};return document.body.removeChild(u),c}r.measure=t;function e(n,s){ve==null&&(ve=t("1","1","mm").width);const a=s?Sh[s]:null;return a?a(n):n}r.toPx=e})(ms||(ms={}));const Mh=/-(.)/g;function Ah(r){return r.replace(Mh,(t,e)=>e.toUpperCase())}const ys={},da=["webkit","ms","moz","o"],fa=typeof document!="undefined"?document.createElement("div").style:{};function Nh(r){for(let t=0;t<da.length;t+=1){const e=da[t]+r;if(e in fa)return e}return null}function bs(r){const t=Ah(r);if(ys[t]==null){const e=t.charAt(0).toUpperCase()+t.slice(1);ys[t]=t in fa?t:Nh(e)}return ys[t]}function Th(r,t,e){const n=bs(t);n!=null&&(r[n]=e),r[t]=e}function ga(r,t){const e=r.ownerDocument&&r.ownerDocument.defaultView&&r.ownerDocument.defaultView.opener?r.ownerDocument.defaultView.getComputedStyle(r,null):window.getComputedStyle(r,null);return e&&t?e.getPropertyValue(t)||e[t]:e}function jh(r){const t=ga(r);return t!=null&&(t.overflow==="scroll"||t.overflow==="auto")}const Dh=function(){if(typeof document=="undefined")return function(){};const r=document;return r.selection?function(){r.selection.empty()}:window.getSelection?function(){const t=window.getSelection();t&&(t.empty?t.empty():t.removeAllRanges&&t.removeAllRanges())}:function(){}}(),Lh={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function pa(r){return/^--/.test(r)}function un(r,t,e){const n=window.getComputedStyle(r,null);return e?n.getPropertyValue(t)||void 0:n[t]||r.style[t]}function hn(r,t){return parseInt(un(r,t),10)||0}function $h(r,t){return!Lh[r]&&typeof t=="number"?`${t}px`:t}function ma(r,t,e){if(typeof t=="string"){const n=pa(t);if(n||(t=bs(t)),e===void 0)return un(r,t,n);n||(e=$h(t,e));const s=r.style;n?s.setProperty(t,e):s[t]=e;return}for(const n in t)ma(r,n,t[n])}const Vn=new WeakMap;function vs(r,t){const e=nn(t),n=Vn.get(r);if(n)return n[e]}function ya(r,t,e){const n=nn(t),s=Vn.get(r);s?s[n]=e:Vn.set(r,{[n]:e})}function ba(r,t,e){if(!t){const n={};return Object.keys(Vn).forEach(s=>{n[s]=vs(r,s)}),n}if(typeof t=="string"){if(e===void 0)return vs(r,t);ya(r,t,e);return}for(const n in t)ba(r,n,t[n])}const Bh={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};function va(r,t,e){if(!!t){if(typeof t=="string"){if(t=Bh[t]||t,arguments.length<3)return r[t];r[t]=e;return}for(const n in t)va(r,n,t[n])}}class G{get[Symbol.toStringTag](){return G.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(t){this.node.id=t}constructor(t,e,n){if(!t)throw new TypeError("Invalid element to create vector");let s;if(G.isVector(t))s=t.node;else if(typeof t=="string")if(t.toLowerCase()==="svg")s=Bn();else if(t[0]==="<"){const a=Bn(t);s=document.importNode(a.firstChild,!0)}else s=document.createElementNS(kt.svg,t);else s=t;this.node=s,e&&this.setAttributes(e),n&&this.append(n)}transform(t,e){return t==null?Es(this.node):(Es(this.node,t,e),this)}translate(t,e=0,n={}){return t==null?Cs(this.node):(Cs(this.node,t,e,n),this)}rotate(t,e,n,s={}){return t==null?_s(this.node):(_s(this.node,t,e,n,s),this)}scale(t,e){return t==null?Ss(this.node):(Ss(this.node,t,e),this)}getTransformToElement(t){const e=G.toNode(t);return Ms(this.node,e)}removeAttribute(t){return ds(this.node,t),this}getAttribute(t){return ca(this.node,t)}setAttribute(t,e){return Rn(this.node,t,e),this}setAttributes(t){return fs(this.node,t),this}attr(t,e){return t==null?vt(this.node):typeof t=="string"&&e===void 0?vt(this.node,t):(typeof t=="object"?vt(this.node,t):vt(this.node,t,e),this)}svg(){return this.node instanceof SVGSVGElement?this:G.create(this.node.ownerSVGElement)}defs(){const t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?G.create(e):G.create("defs").appendTo(t)}text(t,e={}){return xa(this.node,t,e),this}tagName(){return Zo(this.node)}clone(){return G.create(this.node.cloneNode(!0))}remove(){return ra(this.node),this}empty(){return cs(this.node),this}append(t){return us(this.node,G.toNodes(t)),this}appendTo(t){return oa(this.node,G.isVector(t)?t.node:t),this}prepend(t){return sa(this.node,G.toNodes(t)),this}before(t){return hs(this.node,G.toNodes(t)),this}replace(t){return this.node.parentNode&&this.node.parentNode.replaceChild(G.toNode(t),this.node),G.create(t)}first(){return this.node.firstChild?G.create(this.node.firstChild):null}last(){return this.node.lastChild?G.create(this.node.lastChild):null}get(t){const e=this.node.childNodes[t];return e?G.create(e):null}indexOf(t){return Array.prototype.slice.call(this.node.childNodes).indexOf(G.toNode(t))}find(t){const e=[],n=ta(this.node,t);if(n)for(let s=0,a=n.length;s<a;s+=1)e.push(G.create(n[s]));return e}findOne(t){const e=ea(this.node,t);return e?G.create(e):null}findParentByClass(t,e){const n=na(this.node,t,e);return n?G.create(n):null}matches(t){const e=this.node;this.node.matches;const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return n&&n.call(e,t)}contains(t){return ia(this.node,G.isVector(t)?t.node:t)}wrap(t){const e=G.create(t),n=this.node.parentNode;return n!=null&&n.insertBefore(e.node,this.node),e.append(this)}parent(t){let e=this;if(e.node.parentNode==null)return null;if(e=G.create(e.node.parentNode),t==null)return e;do if(typeof t=="string"?e.matches(t):e instanceof t)return e;while(e=G.create(e.node.parentNode));return e}children(){const t=this.node.childNodes,e=[];for(let n=0;n<t.length;n+=1)t[n].nodeType===1&&e.push(G.create(t[n]));return e}eachChild(t,e){const n=this.children();for(let s=0,a=n.length;s<a;s+=1)t.call(n[s],n[s],s,n),e&&n[s].eachChild(t,e);return this}index(){return Qo(this.node)}hasClass(t){return sn(this.node,t)}addClass(t){return on(this.node,t),this}removeClass(t){return an(this.node,t),this}toggleClass(t,e){return as(this.node,t,e),this}toLocalPoint(t,e){return Ra(this.node,t,e)}sample(t=1){return this.node instanceof SVGPathElement?Oa(this.node,t):[]}toPath(){return G.create(ja(this.node))}toPathData(){return Ps(this.node)}}(function(r){r.toStringTag=`X6.${r.name}`;function t(u){if(u==null)return!1;if(u instanceof r)return!0;const h=u[Symbol.toStringTag],d=u;return(h==null||h===r.toStringTag)&&d.node instanceof SVGElement&&typeof d.sample=="function"&&typeof d.toPath=="function"}r.isVector=t;function e(u,h,d){return new r(u,h,d)}r.create=e;function n(u){if(u[0]==="<"){const h=Bn(u),d=[];for(let c=0,i=h.childNodes.length;c<i;c+=1){const o=h.childNodes[c];d.push(e(document.importNode(o,!0)))}return d}return[e(u)]}r.createVectors=n;function s(u){return t(u)?u.node:u}r.toNode=s;function a(u){return Array.isArray(u)?u.map(h=>s(h)):[s(u)]}r.toNodes=a})(G||(G={}));function Rh(r,t){const e=G.create(t),n=G.create("textPath"),s=r.d;if(s&&r["xlink:href"]===void 0){const a=G.create("path").attr("d",s).appendTo(e.defs());n.attr("xlink:href",`#${a.id}`)}return typeof r=="object"&&n.attr(r),n.node}function Ih(r,t,e){const n=e.eol,s=e.baseSize,a=e.lineHeight;let u=0,h;const d={},c=t.length-1;for(let i=0;i<=c;i+=1){let o=t[i],l=null;if(typeof o=="object"){const f=o.attrs,g=G.create("tspan",f);h=g.node;let p=o.t;n&&i===c&&(p+=n),h.textContent=p;const m=f.class;m&&g.addClass(m),e.includeAnnotationIndices&&g.attr("annotations",o.annotations.join(",")),l=parseFloat(f["font-size"]),l===void 0&&(l=s),l&&l>u&&(u=l)}else n&&i===c&&(o+=n),h=document.createTextNode(o||" "),s&&s>u&&(u=s);r.appendChild(h)}return u&&(d.maxFontSize=u),a?d.lineHeight=a:u&&(d.lineHeight=u*1.2),d}const wa=/em$/;function Fn(r,t){const e=parseFloat(r);return wa.test(r)?e*t:e}function Vh(r,t,e,n){if(!Array.isArray(t))return 0;const s=t.length;if(!s)return 0;let a=t[0];const u=Fn(a.maxFontSize,e)||e;let h=0;const d=Fn(n,e);for(let o=1;o<s;o+=1)a=t[o],h+=Fn(a.lineHeight,e)||d;const c=Fn(a.maxFontSize,e)||e;let i;switch(r){case"middle":i=u/2-.15*c-h/2;break;case"bottom":i=-(.25*c)-h;break;case"top":default:i=.8*u;break}return i}function xa(r,t,e={}){t=ha(t);const n=e.eol;let s=e.textPath;const a=e.textVerticalAnchor,u=a==="middle"||a==="bottom"||a==="top";let h=e.x;h===void 0&&(h=r.getAttribute("x")||0);const d=e.includeAnnotationIndices;let c=e.annotations;c&&!Array.isArray(c)&&(c=[c]);const i=e.lineHeight,o=i==="auto",l=o?"1.5em":i||"1em";let f=!0;const g=r.childNodes;if(g.length===1){const S=g[0];S&&S.tagName.toUpperCase()==="TITLE"&&(f=!1)}f&&cs(r),vt(r,{"xml:space":"preserve",display:t||e.displayEmpty?null:"none"});const p=vt(r,"font-size");let m=parseFloat(p);m||(m=16,(u||c)&&!p&&vt(r,"font-size",`${m}`));let y;s?(typeof s=="string"&&(s={d:s}),y=Rh(s,r)):y=document.createDocumentFragment();let b,v=0,x;const P=t.split(`
`),C=[],_=P.length-1;for(let S=0;S<=_;S+=1){b=l;let w="v-line";const O=$e("tspan");let M,T=P[S];if(T)if(c){const j=ua(T,c,{offset:-v,includeAnnotationIndices:d});M=Ih(O,j,{eol:S!==_&&n,baseSize:m,lineHeight:o?null:l,includeAnnotationIndices:d});const N=M.lineHeight;N&&o&&S!==0&&(b=N),S===0&&(x=M.maxFontSize*.8)}else n&&S!==_&&(T+=n),O.textContent=T;else{O.textContent="-",w+=" v-empty-line";const j=O.style;j.fillOpacity=0,j.strokeOpacity=0,c&&(M={})}M&&C.push(M),S>0&&O.setAttribute("dy",b),(S>0||s)&&O.setAttribute("x",h),O.className.baseVal=w,y.appendChild(O),v+=T.length+1}if(u)if(c)b=Vh(a,C,m,l);else if(a==="top")b="0.8em";else{let S;switch(_>0?(S=parseFloat(l)||1,S*=_,wa.test(l)||(S/=m)):S=0,a){case"middle":b=`${.3-S/2}em`;break;case"bottom":b=`${-S-.3}em`;break}}else a===0?b="0em":a?b=a:(b=0,r.getAttribute("y")==null&&r.setAttribute("y",`${x||"0.8em"}`));y.firstChild.setAttribute("dy",b),r.appendChild(y)}function Be(r,t={}){const e=document.createElement("canvas").getContext("2d");if(!r)return{width:0};const n=[],s=t["font-size"]?`${parseFloat(t["font-size"])}px`:"14px";return n.push(t["font-style"]||"normal"),n.push(t["font-variant"]||"normal"),n.push(t["font-weight"]||400),n.push(s),n.push(t["font-family"]||"sans-serif"),e.font=n.join(" "),e.measureText(r)}function ws(r,t,e,n={}){if(t>=e)return[r,""];const s=r.length,a={};let u=Math.round(t/e*s-1);for(u<0&&(u=0);u>=0&&u<s;){const h=r.slice(0,u),d=a[h]||Be(h,n).width,c=r.slice(0,u+1),i=a[c]||Be(c,n).width;if(a[h]=d,a[c]=i,d>t)u-=1;else if(i<=t)u+=1;else break}return[r.slice(0,u),r.slice(u)]}function Pa(r,t,e={},n={}){const s=t.width,a=t.height,u=n.eol||`
`,h=e.fontSize||14,d=e.lineHeight?parseFloat(e.lineHeight):Math.ceil(h*1.4),c=Math.floor(a/d);if(r.indexOf(u)>-1){const m=To(),y=[];return r.split(u).map(b=>{const v=Pa(b,Object.assign(Object.assign({},t),{height:Number.MAX_SAFE_INTEGER}),e,Object.assign(Object.assign({},n),{eol:m}));v&&y.push(...v.split(m))}),y.slice(0,c).join(u)}const{width:i}=Be(r,e);if(i<s)return r;const o=[];let l=r,f=i,g=n.ellipsis,p=0;g&&(typeof g!="string"&&(g="\u2026"),p=Be(g,e).width);for(let m=0;m<c;m+=1)if(f>s)if(m===c-1){const[b]=ws(l,s-p,f,e);o.push(g?`${b}${g}`:b)}else{const[b,v]=ws(l,s,f,e);o.push(b),l=v,f=Be(l,e).width}else{o.push(l);break}return o.join(u)}const zn=.551784;function lt(r,t,e=NaN){const n=r.getAttribute(t);if(n==null)return e;const s=parseFloat(n);return Number.isNaN(s)?e:s}function Oa(r,t=1){const e=r.getTotalLength(),n=[];let s=0,a;for(;s<e;)a=r.getPointAtLength(s),n.push({distance:s,x:a.x,y:a.y}),s+=t;return n}function Ea(r){return["M",lt(r,"x1"),lt(r,"y1"),"L",lt(r,"x2"),lt(r,"y2")].join(" ")}function Ca(r){const t=xs(r);return t.length===0?null:`${Sa(t)} Z`}function _a(r){const t=xs(r);return t.length===0?null:Sa(t)}function Sa(r){return`M ${r.map(e=>`${e.x} ${e.y}`).join(" L")}`}function xs(r){const t=[],e=r.points;if(e)for(let n=0,s=e.numberOfItems;n<s;n+=1)t.push(e.getItem(n));return t}function Ma(r){const t=lt(r,"cx",0),e=lt(r,"cy",0),n=lt(r,"r"),s=n*zn;return["M",t,e-n,"C",t+s,e-n,t+n,e-s,t+n,e,"C",t+n,e+s,t+s,e+n,t,e+n,"C",t-s,e+n,t-n,e+s,t-n,e,"C",t-n,e-s,t-s,e-n,t,e-n,"Z"].join(" ")}function Aa(r){const t=lt(r,"cx",0),e=lt(r,"cy",0),n=lt(r,"rx"),s=lt(r,"ry")||n,a=n*zn,u=s*zn;return["M",t,e-s,"C",t+a,e-s,t+n,e-u,t+n,e,"C",t+n,e+u,t+a,e+s,t,e+s,"C",t-a,e+s,t-n,e+u,t-n,e,"C",t-n,e-u,t-a,e-s,t,e-s,"Z"].join(" ")}function Na(r){return Ta({x:lt(r,"x",0),y:lt(r,"y",0),width:lt(r,"width",0),height:lt(r,"height",0),rx:lt(r,"rx",0),ry:lt(r,"ry",0)})}function Ta(r){let t;const e=r.x,n=r.y,s=r.width,a=r.height,u=Math.min(r.rx||r["top-rx"]||0,s/2),h=Math.min(r.rx||r["bottom-rx"]||0,s/2),d=Math.min(r.ry||r["top-ry"]||0,a/2),c=Math.min(r.ry||r["bottom-ry"]||0,a/2);return u||h||d||c?t=["M",e,n+d,"v",a-d-c,"a",h,c,0,0,0,h,c,"h",s-2*h,"a",h,c,0,0,0,h,-c,"v",-(a-c-d),"a",u,d,0,0,0,-u,-d,"h",-(s-2*u),"a",u,d,0,0,0,-u,d,"Z"]:t=["M",e,n,"H",e+s,"V",n+a,"H",e,"V",n,"Z"],t.join(" ")}function ja(r){const t=$e("path");vt(t,vt(r));const e=Ps(r);return e&&t.setAttribute("d",e),t}function Ps(r){const t=r.tagName.toLowerCase();switch(t){case"path":return r.getAttribute("d");case"line":return Ea(r);case"polygon":return Ca(r);case"polyline":return _a(r);case"ellipse":return Aa(r);case"circle":return Ma(r);case"rect":return Na(r)}throw new Error(`"${t}" cannot be converted to svg path element.`)}function Fh(r,t,e,n){const s=2*Math.PI-1e-6,a=r,u=t;let h=e,d=n;if(d<h){const p=h;h=d,d=p}const c=d-h,i=c<Math.PI?"0":"1",o=Math.cos(h),l=Math.sin(h),f=Math.cos(d),g=Math.sin(d);return c>=s?a?`M0,${u}A${u},${u} 0 1,1 0,${-u}A${u},${u} 0 1,1 0,${u}M0,${a}A${a},${a} 0 1,0 0,${-a}A${a},${a} 0 1,0 0,${a}Z`:`M0,${u}A${u},${u} 0 1,1 0,${-u}A${u},${u} 0 1,1 0,${u}Z`:a?`M${u*o},${u*l}A${u},${u} 0 ${i},1 ${u*f},${u*g}L${a*f},${a*g}A${a},${a} 0 ${i},0 ${a*o},${a*l}Z`:`M${u*o},${u*l}A${u},${u} 0 ${i},1 ${u*f},${u*g}L0,0Z`}const zh=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,Da=/[ ,]+/,kh=/^(\w+)\((.*)\)/;function Hh(r,t){const n=$e("svg").createSVGPoint();return n.x=r,n.y=t,n}function Re(r){const e=$e("svg").createSVGMatrix();if(r!=null){const n=r,s=e;for(const a in n)s[a]=n[a]}return e}function La(r){const t=$e("svg");return r!=null?(r instanceof DOMMatrix||(r=Re(r)),t.createSVGTransformFromMatrix(r)):t.createSVGTransform()}function kn(r){let t=Re();const e=r!=null&&r.match(zh);if(!e)return t;for(let n=0,s=e.length;n<s;n+=1){const u=e[n].match(kh);if(u){let h,d,c,i,o,l=Re();const f=u[2].split(Da);switch(u[1].toLowerCase()){case"scale":h=parseFloat(f[0]),d=f[1]===void 0?h:parseFloat(f[1]),l=l.scaleNonUniform(h,d);break;case"translate":c=parseFloat(f[0]),i=parseFloat(f[1]),l=l.translate(c,i);break;case"rotate":o=parseFloat(f[0]),c=parseFloat(f[1])||0,i=parseFloat(f[2])||0,c!==0||i!==0?l=l.translate(c,i).rotate(o).translate(-c,-i):l=l.rotate(o);break;case"skewx":o=parseFloat(f[0]),l=l.skewX(o);break;case"skewy":o=parseFloat(f[0]),l=l.skewY(o);break;case"matrix":l.a=parseFloat(f[0]),l.b=parseFloat(f[1]),l.c=parseFloat(f[2]),l.d=parseFloat(f[3]),l.e=parseFloat(f[4]),l.f=parseFloat(f[5]);break;default:continue}t=t.multiply(l)}}return t}function $a(r){const t=r||{},e=t.a!=null?t.a:1,n=t.b!=null?t.b:0,s=t.c!=null?t.c:0,a=t.d!=null?t.d:1,u=t.e!=null?t.e:0,h=t.f!=null?t.f:0;return`matrix(${e},${n},${s},${a},${u},${h})`}function Hn(r){let t,e,n;if(r){const a=Da;if(r.trim().indexOf("matrix")>=0){const u=kn(r),h=Ba(u);t=[h.translateX,h.translateY],e=[h.rotation],n=[h.scaleX,h.scaleY];const d=[];(t[0]!==0||t[1]!==0)&&d.push(`translate(${t.join(",")})`),(n[0]!==1||n[1]!==1)&&d.push(`scale(${n.join(",")})`),e[0]!==0&&d.push(`rotate(${e[0]})`),r=d.join(" ")}else{const u=r.match(/translate\((.*?)\)/);u&&(t=u[1].split(a));const h=r.match(/rotate\((.*?)\)/);h&&(e=h[1].split(a));const d=r.match(/scale\((.*?)\)/);d&&(n=d[1].split(a))}}const s=n&&n[0]?parseFloat(n[0]):1;return{raw:r||"",translation:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotation:{angle:e&&e[0]?parseInt(e[0],10):0,cx:e&&e[1]?parseInt(e[1],10):void 0,cy:e&&e[2]?parseInt(e[2],10):void 0},scale:{sx:s,sy:n&&n[1]?parseFloat(n[1]):s}}}function Os(r,t){const e=t.x*r.a+t.y*r.c+0,n=t.x*r.b+t.y*r.d+0;return{x:e,y:n}}function Ba(r){const t=Os(r,{x:0,y:1}),e=Os(r,{x:1,y:0}),n=180/Math.PI*Math.atan2(t.y,t.x)-90,s=180/Math.PI*Math.atan2(e.y,e.x);return{skewX:n,skewY:s,translateX:r.e,translateY:r.f,scaleX:Math.sqrt(r.a*r.a+r.b*r.b),scaleY:Math.sqrt(r.c*r.c+r.d*r.d),rotation:n}}function Gh(r){let t,e,n,s;return r?(t=r.a==null?1:r.a,s=r.d==null?1:r.d,e=r.b,n=r.c):t=s=1,{sx:e?Math.sqrt(t*t+e*e):t,sy:n?Math.sqrt(n*n+s*s):s}}function qh(r){let t={x:0,y:1};r&&(t=Os(r,t));const e=180*Math.atan2(t.y,t.x)/Math.PI%360-90;return{angle:e%360+(e<0?360:0)}}function Wh(r){return{tx:r&&r.e||0,ty:r&&r.f||0}}function Es(r,t,e={}){if(t==null)return kn(vt(r,"transform"));if(e.absolute){r.setAttribute("transform",$a(t));return}const n=r.transform,s=La(t);n.baseVal.appendItem(s)}function Cs(r,t,e=0,n={}){let s=vt(r,"transform");const a=Hn(s);if(t==null)return a.translation;s=a.raw,s=s.replace(/translate\([^)]*\)/g,"").trim();const u=n.absolute?t:a.translation.tx+t,h=n.absolute?e:a.translation.ty+e,d=`translate(${u},${h})`;r.setAttribute("transform",`${d} ${s}`.trim())}function _s(r,t,e,n,s={}){let a=vt(r,"transform");const u=Hn(a);if(t==null)return u.rotation;a=u.raw,a=a.replace(/rotate\([^)]*\)/g,"").trim(),t%=360;const h=s.absolute?t:u.rotation.angle+t,d=e!=null&&n!=null?`,${e},${n}`:"",c=`rotate(${h}${d})`;r.setAttribute("transform",`${a} ${c}`.trim())}function Ss(r,t,e){let n=vt(r,"transform");const s=Hn(n);if(t==null)return s.scale;e=e==null?t:e,n=s.raw,n=n.replace(/scale\([^)]*\)/g,"").trim();const a=`scale(${t},${e})`;r.setAttribute("transform",`${n} ${a}`.trim())}function Ms(r,t){if(ln(t)&&ln(r)){const e=t.getScreenCTM(),n=r.getScreenCTM();if(e&&n)return e.inverse().multiply(n)}return Re()}function Uh(r,t){let e=Re();if(ln(t)&&ln(r)){let n=r;const s=[];for(;n&&n!==t;){const a=n.getAttribute("transform")||null,u=kn(a);s.push(u),n=n.parentNode}s.reverse().forEach(a=>{e=e.multiply(a)})}return e}function Ra(r,t,e){const n=r instanceof SVGSVGElement?r:r.ownerSVGElement,s=n.createSVGPoint();s.x=t,s.y=e;try{const a=n.getScreenCTM(),u=s.matrixTransform(a.inverse()),h=Ms(r,n).inverse();return u.matrixTransform(h)}catch{return s}}var Ot;(function(r){const t={};function e(a){return t[a]||{}}r.get=e;function n(a,u){t[a]=u}r.register=n;function s(a){delete t[a]}r.unregister=s})(Ot||(Ot={}));var we;(function(r){const t=new WeakMap;function e(a){return t.has(a)||t.set(a,{events:Object.create(null)}),t.get(a)}r.ensure=e;function n(a){return t.get(a)}r.get=n;function s(a){return t.delete(a)}r.remove=s})(we||(we={}));var k;(function(r){r.returnTrue=()=>!0,r.returnFalse=()=>!1;function t(s){s.stopPropagation()}r.stopPropagationCallback=t;function e(s,a,u){s.addEventListener!=null&&s.addEventListener(a,u)}r.addEventListener=e;function n(s,a,u){s.removeEventListener!=null&&s.removeEventListener(a,u)}r.removeEventListener=n})(k||(k={}));(function(r){const t=/[^\x20\t\r\n\f]+/g,e=/^([^.]*)(?:\.(.+)|)/;function n(h){return(h||"").match(t)||[""]}r.splitType=n;function s(h){const d=e.exec(h)||[];return{originType:d[1]?d[1].trim():d[1],namespaces:d[2]?d[2].split(".").map(c=>c.trim()).sort():[]}}r.normalizeType=s;function a(h){return h.nodeType===1||h.nodeType===9||!+h.nodeType}r.isValidTarget=a;function u(h,d){if(d){const c=h;return c.querySelector!=null&&c.querySelector(d)!=null}return!0}r.isValidSelector=u})(k||(k={}));(function(r){let t=0;const e=new WeakMap;function n(h){return e.has(h)||(e.set(h,t),t+=1),e.get(h)}r.ensureHandlerId=n;function s(h){return e.get(h)}r.getHandlerId=s;function a(h){return e.delete(h)}r.removeHandlerId=a;function u(h,d){return e.set(h,d)}r.setHandlerId=u})(k||(k={}));(function(r){function t(e,n){const s=[],a=we.get(e),u=a&&a.events&&a.events[n.type],h=u&&u.handlers||[],d=u?u.delegateCount:0;if(d>0&&!(n.type==="click"&&typeof n.button=="number"&&n.button>=1)){for(let c=n.target;c!==e;c=c.parentNode||e)if(c.nodeType===1&&!(n.type==="click"&&c.disabled===!0)){const i=[],o={};for(let l=0;l<d;l+=1){const f=h[l],g=f.selector;if(g!=null&&o[g]==null){const p=e,m=[];p.querySelectorAll(g).forEach(y=>{m.push(y)}),o[g]=m.includes(c)}o[g]&&i.push(f)}i.length&&s.push({elem:c,handlers:i})}}return d<h.length&&s.push({elem:e,handlers:h.slice(d)}),s}r.getHandlerQueue=t})(k||(k={}));(function(r){function t(e){return e!=null&&e===e.window}r.isWindow=t})(k||(k={}));(function(r){function t(e,n){const s=e.nodeType===9?e.documentElement:e,a=n&&n.parentNode;return e===a||!!(a&&a.nodeType===1&&(s.contains?s.contains(a):e.compareDocumentPosition&&e.compareDocumentPosition(a)&16))}r.contains=t})(k||(k={}));class Ht{constructor(t,e){this.isDefaultPrevented=k.returnFalse,this.isPropagationStopped=k.returnFalse,this.isImmediatePropagationStopped=k.returnFalse,this.isSimulated=!1,this.preventDefault=()=>{const n=this.originalEvent;this.isDefaultPrevented=k.returnTrue,n&&!this.isSimulated&&n.preventDefault()},this.stopPropagation=()=>{const n=this.originalEvent;this.isPropagationStopped=k.returnTrue,n&&!this.isSimulated&&n.stopPropagation()},this.stopImmediatePropagation=()=>{const n=this.originalEvent;this.isImmediatePropagationStopped=k.returnTrue,n&&!this.isSimulated&&n.stopImmediatePropagation(),this.stopPropagation()},typeof t=="string"?this.type=t:t.type&&(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?k.returnTrue:k.returnFalse,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.timeStamp=t.timeStamp),e&&Object.assign(this,e),this.timeStamp||(this.timeStamp=Date.now())}}(function(r){function t(e){return e instanceof r?e:new r(e)}r.create=t})(Ht||(Ht={}));(function(r){function t(e,n){Object.defineProperty(r.prototype,e,{enumerable:!0,configurable:!0,get:typeof n=="function"?function(){if(this.originalEvent)return n(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set(s){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:s})}})}r.addProperty=t})(Ht||(Ht={}));(function(r){const t={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(t).forEach(e=>r.addProperty(e,t[e]))})(Ht||(Ht={}));(function(r){Ot.register("load",{noBubble:!0})})();(function(r){Ot.register("beforeunload",{postDispatch(t,e){e.result!==void 0&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}})})();(function(r){Ot.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle(t,e){let n;const s=e.relatedTarget,a=e.handleObj;return(!s||s!==t&&!k.contains(t,s))&&(e.type=a.originType,n=a.handler.call(t,e),e.type="mouseover"),n}}),Ot.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle(t,e){let n;const s=e.relatedTarget,a=e.handleObj;return(!s||s!==t&&!k.contains(t,s))&&(e.type=a.originType,n=a.handler.call(t,e),e.type="mouseout"),n}})})();var Jh=globalThis&&globalThis.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e},dn;(function(r){let t;function e(u,h,d,c,i){if(!k.isValidTarget(u))return;let o;if(typeof d!="function"){const{handler:p,selector:m}=d,y=Jh(d,["handler","selector"]);d=p,i=m,o=y}const l=we.ensure(u);let f=l.handler;f==null&&(f=l.handler=function(p,...m){return t!==p.type?s(u,p,...m):void 0});const g=k.ensureHandlerId(d);k.splitType(h).forEach(p=>{const{originType:m,namespaces:y}=k.normalizeType(p);if(!m)return;let b=m,v=Ot.get(b);b=(i?v.delegateType:v.bindType)||b,v=Ot.get(b);const x=Object.assign({type:b,originType:m,data:c,selector:i,guid:g,handler:d,namespace:y.join(".")},o),P=l.events;let C=P[b];C||(C=P[b]={handlers:[],delegateCount:0},(!v.setup||v.setup(u,c,y,f)===!1)&&k.addEventListener(u,b,f)),v.add&&(k.removeHandlerId(x.handler),v.add(u,x),k.setHandlerId(x.handler,g)),i?(C.handlers.splice(C.delegateCount,0,x),C.delegateCount+=1):C.handlers.push(x)})}r.on=e;function n(u,h,d,c,i){const o=we.get(u);if(!o)return;const l=o.events;!l||(k.splitType(h).forEach(f=>{const{originType:g,namespaces:p}=k.normalizeType(f);if(!g){Object.keys(l).forEach(P=>{n(u,P+f,d,c,!0)});return}let m=g;const y=Ot.get(m);m=(c?y.delegateType:y.bindType)||m;const b=l[m];if(!b)return;const v=p.length>0?new RegExp(`(^|\\.)${p.join("\\.(?:.*\\.|)")}(\\.|$)`):null,x=b.handlers.length;for(let P=b.handlers.length-1;P>=0;P-=1){const C=b.handlers[P];(i||g===C.originType)&&(!d||k.getHandlerId(d)===C.guid)&&(v==null||C.namespace&&v.test(C.namespace))&&(c==null||c===C.selector||c==="**"&&C.selector)&&(b.handlers.splice(P,1),C.selector&&(b.delegateCount-=1),y.remove&&y.remove(u,C))}x&&b.handlers.length===0&&((!y.teardown||y.teardown(u,p,o.handler)===!1)&&k.removeEventListener(u,m,o.handler),delete l[m])}),Object.keys(l).length===0&&we.remove(u))}r.off=n;function s(u,h,...d){const c=Ht.create(h);c.delegateTarget=u;const i=Ot.get(c.type);if(i.preDispatch&&i.preDispatch(u,c)===!1)return;const o=k.getHandlerQueue(u,c);for(let l=0,f=o.length;l<f&&!c.isPropagationStopped();l+=1){const g=o[l];c.currentTarget=g.elem;for(let p=0,m=g.handlers.length;p<m&&!c.isImmediatePropagationStopped();p+=1){const y=g.handlers[p];if(c.rnamespace==null||y.namespace&&c.rnamespace.test(y.namespace)){c.handleObj=y,c.data=y.data;const b=Ot.get(y.originType).handle,v=b?b(g.elem,c,...d):y.handler.call(g.elem,c,...d);v!==void 0&&(c.result=v,v===!1&&(c.preventDefault(),c.stopPropagation()))}}}return i.postDispatch&&i.postDispatch(u,c),c.result}r.dispatch=s;function a(u,h,d,c){let i=u,o=typeof u=="string"?u:u.type,l=typeof u=="string"||i.namespace==null?[]:i.namespace.split(".");const f=d;if(f.nodeType===3||f.nodeType===8)return;o.indexOf(".")>-1&&(l=o.split("."),o=l.shift(),l.sort());const g=o.indexOf(":")<0&&`on${o}`;i=u instanceof Ht?u:new Ht(o,typeof u=="object"?u:null),i.namespace=l.join("."),i.rnamespace=i.namespace?new RegExp(`(^|\\.)${l.join("\\.(?:.*\\.|)")}(\\.|$)`):null,i.result=void 0,i.target||(i.target=f);const p=[i];Array.isArray(h)?p.push(...h):p.push(h);const m=Ot.get(o);if(!c&&m.trigger&&m.trigger(f,i,h)===!1)return;let y;const b=[f];if(!c&&!m.noBubble&&!k.isWindow(f)){y=m.delegateType||o;let x=f,P=f.parentNode;for(;P!=null;)b.push(P),x=P,P=P.parentNode;const C=f.ownerDocument||document;if(x===C){const _=x.defaultView||x.parentWindow||window;b.push(_)}}let v=f;for(let x=0,P=b.length;x<P&&!i.isPropagationStopped();x+=1){const C=b[x];v=C,i.type=x>1?y:m.bindType||o;const _=we.get(C);_&&_.events[i.type]&&_.handler&&_.handler.call(C,...p);const A=g&&C[g]||null;A&&k.isValidTarget(C)&&(i.result=A.call(C,...p),i.result===!1&&i.preventDefault())}if(i.type=o,!c&&!i.isDefaultPrevented()){const x=m.preventDefault;if((x==null||x(b.pop(),i,h)===!1)&&k.isValidTarget(f)&&g&&typeof f[o]=="function"&&!k.isWindow(f)){const P=f[g];P&&(f[g]=null),t=o,i.isPropagationStopped()&&v.addEventListener(o,k.stopPropagationCallback),f[o](),i.isPropagationStopped()&&v.removeEventListener(o,k.stopPropagationCallback),t=void 0,P&&(f[g]=P)}}return i.result}r.trigger=a})(dn||(dn={}));var As;(function(r){function t(a,u,h,d,c){return fn.on(a,u,h,d,c),a}r.on=t;function e(a,u,h,d,c){return fn.on(a,u,h,d,c,!0),a}r.once=e;function n(a,u,h,d){return fn.off(a,u,h,d),a}r.off=n;function s(a,u,h,d){return dn.trigger(u,h,a,d),a}r.trigger=s})(As||(As={}));var fn;(function(r){function t(n,s,a,u,h,d){if(typeof s=="object"){typeof a!="string"&&(u=u||a,a=void 0),Object.keys(s).forEach(c=>t(n,c,a,u,s[c],d));return}if(u==null&&h==null?(h=a,u=a=void 0):h==null&&(typeof a=="string"?(h=u,u=void 0):(h=u,u=a,a=void 0)),h===!1)h=k.returnFalse;else if(!h)return;if(d){const c=h;h=function(i,...o){return r.off(n,i),c.call(this,i,...o)},k.setHandlerId(h,k.ensureHandlerId(c))}dn.on(n,s,h,u,a)}r.on=t;function e(n,s,a,u){const h=s;if(h&&h.preventDefault!=null&&h.handleObj!=null){const d=h.handleObj;e(h.delegateTarget,d.namespace?`${d.originType}.${d.namespace}`:d.originType,d.selector,d.handler);return}if(typeof s=="object"){const d=s;Object.keys(d).forEach(c=>e(n,c,a,d[c]));return}(a===!1||typeof a=="function")&&(u=a,a=void 0),u===!1&&(u=k.returnFalse),dn.off(n,s,u,a)}r.off=e})(fn||(fn={}));class Xh{constructor(t,e,n){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=ye.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=e,this.onWheelGuard=n,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}disable(){this.target.removeEventListener(this.eventName,this.onWheel)}onWheel(t){if(this.onWheelGuard!=null&&!this.onWheelGuard(t))return;this.deltaX+=t.deltaX,this.deltaY+=t.deltaY,t.preventDefault();let e;(this.deltaX!==0||this.deltaY!==0)&&(t.stopPropagation(),e=!0),e===!0&&this.animationFrameId===0&&(this.animationFrameId=requestAnimationFrame(()=>{this.didWheel(t)}))}didWheel(t){this.animationFrameId=0,this.onWheelCallback(t,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}function Ns(r){const t=r.getBoundingClientRect(),e=r.ownerDocument.defaultView;return{top:t.top+e.pageYOffset,left:t.left+e.pageXOffset}}function Yh(r){return r.getBoundingClientRect().width}function Kh(r){return r.getBoundingClientRect().height}function Zh(r){const t=un(r,"position")==="fixed";let e;if(t){const n=r.getBoundingClientRect();e={left:n.left,top:n.top}}else e=Ns(r);if(!t){const n=r.ownerDocument;let s=r.offsetParent||n.documentElement;for(;(s===n.body||s===n.documentElement)&&un(s,"position")==="static";)s=s.parentNode;if(s!==r&&aa(s)){const a=Ns(s);e.top-=a.top+hn(s,"borderTopWidth"),e.left-=a.left+hn(s,"borderLeftWidth")}}return{top:e.top-hn(r,"marginTop"),left:e.left-hn(r,"marginLeft")}}var Qh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",CASE_SENSITIVE_ATTR:la,getAttribute:ca,removeAttribute:ds,setAttribute:Rn,setAttributes:fs,attr:vt,qualifyAttr:gs,kebablizeAttrs:Ph,styleToObject:cn,mergeAttrs:In,uniqueId:Xo,ensureId:yh,isSVGGraphicsElement:ln,ns:kt,svgVersion:ls,createElement:bh,createElementNS:Yo,createSvgElement:$e,createSvgDocument:Bn,parseXML:Ko,tagName:Zo,index:Qo,find:ta,findOne:ea,findParentByClass:na,contains:ia,remove:ra,empty:cs,append:us,prepend:sa,before:hs,after:vh,appendTo:oa,isElement:aa,isHTMLElement:wh,children:xh,getClass:be,hasClass:sn,addClass:on,removeClass:an,toggleClass:as,setPrefixedStyle:Th,getComputedStyle:ga,hasScrollbars:jh,getVendorPrefixedName:bs,clearSelection:Dh,isCSSVariable:pa,computeStyle:un,computeStyleInt:hn,css:ma,getData:vs,setData:ya,data:ba,prop:va,text:xa,measureText:Be,splitTextByLength:ws,breakText:Pa,KAPPA:zn,sample:Oa,lineToPathData:Ea,polygonToPathData:Ca,polylineToPathData:_a,getPointsFromSvgElement:xs,circleToPathData:Ma,ellipseToPathData:Aa,rectangleToPathData:Na,rectToPathData:Ta,toPath:ja,toPathData:Ps,createSlicePathData:Fh,createSVGPoint:Hh,createSVGMatrix:Re,createSVGTransform:La,transformStringToMatrix:kn,matrixToTransformString:$a,parseTransformString:Hn,decomposeMatrix:Ba,matrixToScale:Gh,matrixToRotation:qh,matrixToTranslation:Wh,transform:Es,translate:Cs,rotate:_s,scale:Ss,getTransformToElement:Ms,getTransformToParentElement:Uh,toLocalPoint:Ra,get EventHook(){return Ot},get Event(){return As},get EventObject(){return Ht},MouseWheelHandle:Xh,offset:Ns,width:Yh,height:Kh,position:Zh});function Ia(r,t=60){let e=null;return(...n)=>{e&&clearTimeout(e),e=window.setTimeout(()=>{r.apply(this,n)},t)}}function td(r){let t=null,e=[];const n=()=>{if(getComputedStyle(r).position==="static"){const c=r.style;c.position="relative"}const d=document.createElement("object");return d.onload=()=>{d.contentDocument.defaultView.addEventListener("resize",s),s()},d.style.display="block",d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.height="100%",d.style.width="100%",d.style.overflow="hidden",d.style.pointerEvents="none",d.style.zIndex="-1",d.style.opacity="0",d.setAttribute("tabindex","-1"),d.type="text/html",r.appendChild(d),d.data="about:blank",d},s=Ia(()=>{e.forEach(d=>d(r))}),a=d=>{t||(t=n()),e.indexOf(d)===-1&&e.push(d)},u=()=>{t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",s),t.parentNode.removeChild(t),t=null,e=[])};return{element:r,bind:a,destroy:u,unbind:d=>{const c=e.indexOf(d);c!==-1&&e.splice(c,1),e.length===0&&t&&u()}}}function ed(r){let t=null,e=[];const n=Ia(()=>{e.forEach(d=>{d(r)})}),s=()=>{const d=new ResizeObserver(n);return d.observe(r),n(),d},a=d=>{t||(t=s()),e.indexOf(d)===-1&&e.push(d)},u=()=>{t&&(t.disconnect(),e=[],t=null)};return{element:r,bind:a,destroy:u,unbind:d=>{const c=e.indexOf(d);c!==-1&&e.splice(c,1),e.length===0&&t&&u()}}}const nd=typeof ResizeObserver!="undefined"?ed:td;var Ts;(function(r){const t=new WeakMap;function e(s){let a=t.get(s);return a||(a=nd(s),t.set(s,a),a)}function n(s){s.destroy(),t.delete(s.element)}r.bind=(s,a)=>{const u=e(s);return u.bind(a),()=>u.unbind(a)},r.clear=s=>{const a=e(s);n(a)}})(Ts||(Ts={}));class Ie{constructor(t={}){this.comparator=t.comparator||Ie.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}isEmpty(){return this.data.length===0}insert(t,e,n){const s={priority:t,value:e},a=this.data.length;return n&&(s.id=n,this.index[n]=a),this.data.push(s),this.bubbleUp(a),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(t,e){const n=this.index[t];if(typeof n=="undefined")throw new Error(`Node with id '${t}' was not found in the heap.`);const s=this.data,a=s[n].priority,u=this.comparator(e,a);u<0?(s[n].priority=e,this.bubbleUp(n)):u>0&&(s[n].priority=e,this.bubbleDown(n))}remove(){const t=this.data,e=t[0],n=t.pop();return e.id&&delete this.index[e.id],t.length>0&&(t[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),e?e.value:null}heapify(){for(let t=0;t<this.data.length;t+=1)this.bubbleUp(t)}bubbleUp(t){const e=this.data;let n,s,a=t;for(;a>0&&(s=a-1>>>1,this.comparator(e[a].priority,e[s].priority)<0);){n=e[s],e[s]=e[a];let u=e[a].id;u!=null&&(this.index[u]=s),e[a]=n,u=e[a].id,u!=null&&(this.index[u]=a),a=s}}bubbleDown(t){const e=this.data,n=e.length-1;let s=t;for(;;){const a=(s<<1)+1,u=a+1;let h=s;if(a<=n&&this.comparator(e[a].priority,e[h].priority)<0&&(h=a),u<=n&&this.comparator(e[u].priority,e[h].priority)<0&&(h=u),h!==s){const d=e[h];e[h]=e[s];let c=e[s].id;c!=null&&(this.index[c]=h),e[s]=d,c=e[s].id,c!=null&&(this.index[c]=s),s=h}else break}}}(function(r){r.defaultComparator=(t,e)=>t-e})(Ie||(Ie={}));var js;(function(r){function t(e,n,s=(a,u)=>1){const a={},u={},h={},d=new Ie;for(a[n]=0,Object.keys(e).forEach(c=>{c!==n&&(a[c]=1/0),d.insert(a[c],c,c)});!d.isEmpty();){const c=d.remove();h[c]=!0;const i=e[c]||[];for(let o=0;o<i.length;o+=1){const l=i[o];if(!h[l]){const f=a[c]+s(c,l);f<a[l]&&(a[l]=f,u[l]=c,d.updatePriority(l,f))}}}return u}r.run=t})(js||(js={}));class Gt{constructor(t,e,n,s){if(t==null)return this.set(255,255,255,1);if(typeof t=="number")return this.set(t,e,n,s);if(typeof t=="string")return Gt.fromString(t)||this;if(Array.isArray(t))return this.set(t);this.set(t.r,t.g,t.b,t.a==null?1:t.a)}blend(t,e,n){this.set(t.r+(e.r-t.r)*n,t.g+(e.g-t.g)*n,t.b+(e.b-t.b)*n,t.a+(e.a-t.a)*n)}lighten(t){const e=Gt.lighten(this.toArray(),t);this.r=e[0],this.g=e[1],this.b=e[2],this.a=e[3]}darken(t){this.lighten(-t)}set(t,e,n,s){const a=Array.isArray(t)?t[0]:t,u=Array.isArray(t)?t[1]:e,h=Array.isArray(t)?t[2]:n,d=Array.isArray(t)?t[3]:s;return this.r=Math.round(re(a,0,255)),this.g=Math.round(re(u,0,255)),this.b=Math.round(re(h,0,255)),this.a=d==null?1:re(d,0,1),this}toHex(){return`#${["r","g","b"].map(e=>{const n=this[e].toString(16);return n.length<2?`0${n}`:n}).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return Gt.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(t){const e=`${this.r},${this.g},${this.b},`;return t?`rgb(${e})`:`rgba(${e},${this.a})`}toGrey(){return Gt.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}}(function(r){function t(v){return new r(v)}r.fromArray=t;function e(v){return new r([...g(v),1])}r.fromHex=e;function n(v){const x=v.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(x){const P=x[1].split(/\s*,\s*/).map(C=>parseInt(C,10));return new r(P)}return null}r.fromRGBA=n;function s(v,x,P){P<0&&++P,P>1&&--P;const C=6*P;return C<1?v+(x-v)*C:2*P<1?x:3*P<2?v+(x-v)*(2/3-P)*6:v}function a(v){const x=v.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(x){const P=x[2].split(/\s*,\s*/),C=(parseFloat(P[0])%360+360)%360/360,_=parseFloat(P[1])/100,A=parseFloat(P[2])/100,S=P[3]==null?1:parseInt(P[3],10);return new r(c(C,_,A,S))}return null}r.fromHSLA=a;function u(v){if(v.startsWith("#"))return e(v);if(v.startsWith("rgb"))return n(v);const x=r.named[v];return x?e(x):a(v)}r.fromString=u;function h(v,x){return r.fromArray([v,v,v,x])}r.makeGrey=h;function d(v,x,P,C){const _=Array.isArray(v)?v[0]:v,A=Array.isArray(v)?v[1]:x,S=Array.isArray(v)?v[2]:P,w=Array.isArray(v)?v[3]:C,O=Math.max(_,A,S),M=Math.min(_,A,S),T=(O+M)/2;let j=0,N=0;if(M!==O){const D=O-M;switch(N=T>.5?D/(2-O-M):D/(O+M),O){case _:j=(A-S)/D+(A<S?6:0);break;case A:j=(S-_)/D+2;break;case S:j=(_-A)/D+4;break}j/=6}return[j,N,T,w==null?1:w]}r.rgba2hsla=d;function c(v,x,P,C){const _=Array.isArray(v)?v[0]:v,A=Array.isArray(v)?v[1]:x,S=Array.isArray(v)?v[2]:P,w=Array.isArray(v)?v[3]:C,O=S<=.5?S*(A+1):S+A-S*A,M=2*S-O;return[s(M,O,_+1/3)*256,s(M,O,_)*256,s(M,O,_-1/3)*256,w==null?1:w]}r.hsla2rgba=c;function i(v){return new r(Math.round(Math.random()*256),Math.round(Math.random()*256),Math.round(Math.random()*256),v?void 0:parseFloat(Math.random().toFixed(2)))}r.random=i;function o(){const v="0123456789ABCDEF";let x="#";for(let P=0;P<6;P+=1)x+=v[Math.floor(Math.random()*16)];return x}r.randomHex=o;function l(v){return i(v).toString()}r.randomRGBA=l;function f(v,x){if(typeof v=="string"){const S=v[0]==="#",[w,O,M]=g(v);return x?w*.299+O*.587+M*.114>186?"#000000":"#ffffff":`${S?"#":""}${p(255-w,255-O,255-M)}`}const P=v[0],C=v[1],_=v[2],A=v[3];return x?P*.299+C*.587+_*.114>186?[0,0,0,A]:[255,255,255,A]:[255-P,255-C,255-_,A]}r.invert=f;function g(v){const x=v.indexOf("#")===0?v:`#${v}`;let P=Number(`0x${x.substr(1)}`);if(!(x.length===4||x.length===7)||Number.isNaN(P))throw new Error("Invalid hex color.");const C=x.length===4?4:8,_=(1<<C)-1,A=["b","g","r"].map(()=>{const S=P&_;return P>>=C,C===4?17*S:S});return[A[2],A[1],A[0]]}function p(v,x,P){const C=_=>_.length<2?`0${_}`:_;return`${C(v.toString(16))}${C(x.toString(16))}${C(P.toString(16))}`}function m(v,x){return b(v,x)}r.lighten=m;function y(v,x){return b(v,-x)}r.darken=y;function b(v,x){if(typeof v=="string"){const _=v[0]==="#",A=parseInt(_?v.substr(1):v,16),S=re((A>>16)+x,0,255),w=re((A>>8&255)+x,0,255),O=re((A&255)+x,0,255);return`${_?"#":""}${(O|w<<8|S<<16).toString(16)}`}const P=p(v[0],v[1],v[2]),C=g(b(P,x));return[C[0],C[1],C[2],v[3]]}})(Gt||(Gt={}));(function(r){r.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}})(Gt||(Gt={}));class id{constructor(){this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(t){return this.map.has(t)}get(t){return this.map.get(t)}set(t,e){this.map.set(t,e),this.arr.push(t)}delete(t){const e=this.arr.indexOf(t);e>=0&&this.arr.splice(e,1);const n=this.map.get(t);return this.map.delete(t),n}each(t){this.arr.forEach(e=>{const n=this.map.get(e);t(n,e)})}dispose(){this.clear()}}var Ds;(function(r){function t(s){const a=[],u=[];return Array.isArray(s)?a.push(...s):s.split("|").forEach(h=>{h.indexOf("&")===-1?a.push(h):u.push(...h.split("&"))}),{or:a,and:u}}r.parse=t;function e(s,a){if(s!=null&&a!=null){const u=t(s),h=t(a),d=u.or.sort(),c=h.or.sort(),i=u.and.sort(),o=h.and.sort(),l=(f,g)=>f.length===g.length&&(f.length===0||f.every((p,m)=>p===g[m]));return l(d,c)&&l(i,o)}return s==null&&a==null}r.equals=e;function n(s,a,u){if(a==null||Array.isArray(a)&&a.length===0)return u?s.altKey!==!0&&s.ctrlKey!==!0&&s.metaKey!==!0&&s.shiftKey!==!0:!0;const{or:h,and:d}=t(a),c=i=>{const o=`${i.toLowerCase()}Key`;return s[o]===!0};return h.some(i=>c(i))&&d.every(i=>c(i))}r.isMatch=n})(Ds||(Ds={}));var xe;(function(r){r.linear=t=>t,r.quad=t=>t*t,r.cubic=t=>t*t*t,r.inout=t=>{if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},r.exponential=t=>Math.pow(2,10*(t-1)),r.bounce=t=>{for(let e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11){const s=(11-6*e-11*t)/4;return-s*s+n*n}}})(xe||(xe={}));(function(r){r.decorators={reverse(t){return e=>1-t(1-e)},reflect(t){return e=>.5*(e<.5?t(2*e):2-t(2-2*e))},clamp(t,e=0,n=1){return s=>{const a=t(s);return a<e?e:a>n?n:a}},back(t=1.70158){return e=>e*e*((t+1)*e-t)},elastic(t=1.5){return e=>Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}})(xe||(xe={}));(function(r){function t(N){return-1*Math.cos(N*(Math.PI/2))+1}r.easeInSine=t;function e(N){return Math.sin(N*(Math.PI/2))}r.easeOutSine=e;function n(N){return-.5*(Math.cos(Math.PI*N)-1)}r.easeInOutSine=n;function s(N){return N*N}r.easeInQuad=s;function a(N){return N*(2-N)}r.easeOutQuad=a;function u(N){return N<.5?2*N*N:-1+(4-2*N)*N}r.easeInOutQuad=u;function h(N){return N*N*N}r.easeInCubic=h;function d(N){const D=N-1;return D*D*D+1}r.easeOutCubic=d;function c(N){return N<.5?4*N*N*N:(N-1)*(2*N-2)*(2*N-2)+1}r.easeInOutCubic=c;function i(N){return N*N*N*N}r.easeInQuart=i;function o(N){const D=N-1;return 1-D*D*D*D}r.easeOutQuart=o;function l(N){const D=N-1;return N<.5?8*N*N*N*N:1-8*D*D*D*D}r.easeInOutQuart=l;function f(N){return N*N*N*N*N}r.easeInQuint=f;function g(N){const D=N-1;return 1+D*D*D*D*D}r.easeOutQuint=g;function p(N){const D=N-1;return N<.5?16*N*N*N*N*N:1+16*D*D*D*D*D}r.easeInOutQuint=p;function m(N){return N===0?0:Math.pow(2,10*(N-1))}r.easeInExpo=m;function y(N){return N===1?1:-Math.pow(2,-10*N)+1}r.easeOutExpo=y;function b(N){if(N===0||N===1)return N;const D=N*2,B=D-1;return D<1?.5*Math.pow(2,10*B):.5*(-Math.pow(2,-10*B)+2)}r.easeInOutExpo=b;function v(N){const D=N/1;return-1*(Math.sqrt(1-D*N)-1)}r.easeInCirc=v;function x(N){const D=N-1;return Math.sqrt(1-D*D)}r.easeOutCirc=x;function P(N){const D=N*2,B=D-2;return D<1?-.5*(Math.sqrt(1-D*D)-1):.5*(Math.sqrt(1-B*B)+1)}r.easeInOutCirc=P;function C(N,D=1.70158){return N*N*((D+1)*N-D)}r.easeInBack=C;function _(N,D=1.70158){const B=N/1-1;return B*B*((D+1)*B+D)+1}r.easeOutBack=_;function A(N,D=1.70158){const B=N*2,F=B-2,z=D*1.525;return B<1?.5*B*B*((z+1)*B-z):.5*(F*F*((z+1)*F+z)+2)}r.easeInOutBack=A;function S(N,D=.7){if(N===0||N===1)return N;const F=N/1-1,z=1-D,W=z/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*F)*Math.sin((F-W)*(2*Math.PI)/z))}r.easeInElastic=S;function w(N,D=.7){const B=1-D,F=N*2;if(N===0||N===1)return N;const z=B/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*F)*Math.sin((F-z)*(2*Math.PI)/B)+1}r.easeOutElastic=w;function O(N,D=.65){const B=1-D;if(N===0||N===1)return N;const F=N*2,z=F-1,W=B/(2*Math.PI)*Math.asin(1);return F<1?-.5*(Math.pow(2,10*z)*Math.sin((z-W)*(2*Math.PI)/B)):Math.pow(2,-10*z)*Math.sin((z-W)*(2*Math.PI)/B)*.5+1}r.easeInOutElastic=O;function M(N){const D=N/1;if(D<1/2.75)return 7.5625*D*D;if(D<2/2.75){const B=D-1.5/2.75;return 7.5625*B*B+.75}if(D<2.5/2.75){const B=D-2.25/2.75;return 7.5625*B*B+.9375}{const B=D-2.625/2.75;return 7.5625*B*B+.984375}}r.easeOutBounce=M;function T(N){return 1-M(1-N)}r.easeInBounce=T;function j(N){return N<.5?T(N*2)*.5:M(N*2-1)*.5+.5}r.easeInOutBounce=j})(xe||(xe={}));var Ls;(function(r){r.number=(t,e)=>{const n=e-t;return s=>t+n*s},r.object=(t,e)=>{const n=Object.keys(t);return s=>{const a={};for(let u=n.length-1;u!==-1;u-=1){const h=n[u];a[h]=t[h]+(e[h]-t[h])*s}return a}},r.unit=(t,e)=>{const n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,s=n.exec(t),a=n.exec(e),u=a?a[1]:"",h=s?+s[1]:0,d=a?+a[1]:0,c=u.indexOf("."),i=c>0?u[1].length-c-1:0,o=d-h,l=s?s[2]:"";return f=>(h+o*f).toFixed(i)+l},r.color=(t,e)=>{const n=parseInt(t.slice(1),16),s=parseInt(e.slice(1),16),a=n&255,u=(s&255)-a,h=n&65280,d=(s&65280)-h,c=n&16711680,i=(s&16711680)-c;return o=>{const l=a+u*o&255,f=h+d*o&65280,g=c+i*o&16711680;return`#${(1<<24|l|f|g).toString(16).slice(1)}`}}})(Ls||(Ls={}));const gn=[];function rd(r,t){const e=gn.find(n=>n.name===r);if(!(e&&(e.loadTimes+=1,e.loadTimes>1))&&!ye.isApplyingHMR()){const n=document.createElement("style");n.setAttribute("type","text/css"),n.textContent=t;const s=document.querySelector("head");s&&s.insertBefore(n,s.firstChild),gn.push({name:r,loadTimes:1,styleElement:n})}}function sd(r){const t=gn.findIndex(e=>e.name===r);if(t>-1){const e=gn[t];if(e.loadTimes-=1,e.loadTimes>0)return;let n=e.styleElement;n&&n.parentNode&&n.parentNode.removeChild(n),n=null,gn.splice(t,1)}}var od=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",ensure:rd,clean:sd}),ad=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get Disposable(){return je},DisposableDelegate:Iu,get DisposableSet(){return Qr},Disablable:Qu,get Basecoat(){return De},ArrayExt:th,ObjectExt:Ku,StringExt:uh,NumberExt:mh,FunctionExt:zu,get Platform(){return ye},Text:_h,get DataUri(){return ps},get Unit(){return ms},Dom:Qh,get Vector(){return G},get SizeSensor(){return Ts},get PriorityQueue(){return Ie},get Dijkstra(){return js},get Color(){return Gt},Events:Eo,Dictionary:id,get ModifierKey(){return Ds},get Timing(){return xe},get Interp(){return Ls},CssLoader:od}),$=bo(ad),pn={},Ve={},Fe={},pt;(function(r){function t(n){return 180*n/Math.PI%360}r.toDeg=t,r.toRad=function(n,s=!1){return(s?n:n%360)*Math.PI/180};function e(n){return n%360+(n<0?360:0)}r.normalize=e})(pt||(pt={}));var Q;(function(r){function t(h,d=0){return Number.isInteger(h)?h:+h.toFixed(d)}r.round=t;function e(h,d){let c,i;if(d==null?(i=h==null?1:h,c=0):(i=d,c=h==null?0:h),i<c){const o=c;c=i,i=o}return Math.floor(Math.random()*(i-c+1)+c)}r.random=e;function n(h,d,c){return Number.isNaN(h)?NaN:Number.isNaN(d)||Number.isNaN(c)?0:d<c?h<d?d:h>c?c:h:h<c?c:h>d?d:h}r.clamp=n;function s(h,d){return d*Math.round(h/d)}r.snapToGrid=s;function a(h,d){return d!=null&&h!=null&&d.x>=h.x&&d.x<=h.x+h.width&&d.y>=h.y&&d.y<=h.y+h.height}r.containsPoint=a;function u(h,d){const c=h.x-d.x,i=h.y-d.y;return c*c+i*i}r.squaredLength=u})(Q||(Q={}));class se{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}class L extends se{constructor(t,e){super();this.x=t==null?0:t,this.y=e==null?0:e}round(t=0){return this.x=Q.round(this.x,t),this.y=Q.round(this.y,t),this}add(t,e){const n=L.create(t,e);return this.x+=n.x,this.y+=n.y,this}update(t,e){const n=L.create(t,e);return this.x=n.x,this.y=n.y,this}translate(t,e){const n=L.create(t,e);return this.x+=n.x,this.y+=n.y,this}rotate(t,e){const n=L.rotate(this,t,e);return this.x=n.x,this.y=n.y,this}scale(t,e,n=new L){const s=L.create(n);return this.x=s.x+t*(this.x-s.x),this.y=s.y+e*(this.y-s.y),this}closest(t){if(t.length===1)return L.create(t[0]);let e=null,n=1/0;return t.forEach(s=>{const a=this.squaredDistance(s);a<n&&(e=s,n=a)}),e?L.create(e):null}distance(t){return Math.sqrt(this.squaredDistance(t))}squaredDistance(t){const e=L.create(t),n=this.x-e.x,s=this.y-e.y;return n*n+s*s}manhattanDistance(t){const e=L.create(t);return Math.abs(e.x-this.x)+Math.abs(e.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(t=new L){const e=L.create(t),n=-(e.y-this.y),s=e.x-this.x;let a=Math.atan2(n,s);return a<0&&(a=2*Math.PI+a),180*a/Math.PI}angleBetween(t,e){if(this.equals(t)||this.equals(e))return NaN;let n=this.theta(e)-this.theta(t);return n<0&&(n+=360),n}vectorAngle(t){return new L(0,0).angleBetween(this,t)}toPolar(t){return this.update(L.toPolar(this,t)),this}changeInAngle(t,e,n=new L){return this.clone().translate(-t,-e).theta(n)-this.theta(n)}adhereToRect(t){return Q.containsPoint(t,this)||(this.x=Math.min(Math.max(this.x,t.x),t.x+t.width),this.y=Math.min(Math.max(this.y,t.y),t.y+t.height)),this}bearing(t){const e=L.create(t),n=pt.toRad(this.y),s=pt.toRad(e.y),a=this.x,u=e.x,h=pt.toRad(u-a),d=Math.sin(h)*Math.cos(s),c=Math.cos(n)*Math.sin(s)-Math.sin(n)*Math.cos(s)*Math.cos(h),i=pt.toDeg(Math.atan2(d,c)),o=["NE","E","SE","S","SW","W","NW","N"];let l=i-22.5;return l<0&&(l+=360),l=parseInt(l/45,10),o[l]}cross(t,e){if(t!=null&&e!=null){const n=L.create(t),s=L.create(e);return(s.x-this.x)*(n.y-this.y)-(s.y-this.y)*(n.x-this.x)}return NaN}dot(t){const e=L.create(t);return this.x*e.x+this.y*e.y}diff(t,e){if(typeof t=="number")return new L(this.x-t,this.y-e);const n=L.create(t);return new L(this.x-n.x,this.y-n.y)}lerp(t,e){const n=L.create(t);return new L((1-e)*this.x+e*n.x,(1-e)*this.y+e*n.y)}normalize(t=1){const e=t/this.magnitude();return this.scale(e,e)}move(t,e){const n=L.create(t),s=pt.toRad(n.theta(this));return this.translate(Math.cos(s)*e,-Math.sin(s)*e)}reflection(t){return L.create(t).move(this,this.distance(t))}snapToGrid(t,e){return this.x=Q.snapToGrid(this.x,t),this.y=Q.snapToGrid(this.y,e==null?t:e),this}equals(t){const e=L.create(t);return e!=null&&e.x===this.x&&e.y===this.y}clone(){return L.clone(this)}toJSON(){return L.toJSON(this)}serialize(){return`${this.x} ${this.y}`}}(function(r){function t(e){return e!=null&&e instanceof r}r.isPoint=t})(L||(L={}));(function(r){function t(n){return n!=null&&typeof n=="object"&&typeof n.x=="number"&&typeof n.y=="number"}r.isPointLike=t;function e(n){return n!=null&&Array.isArray(n)&&n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"}r.isPointData=e})(L||(L={}));(function(r){function t(o,l){return o==null||typeof o=="number"?new r(o,l):e(o)}r.create=t;function e(o){return r.isPoint(o)?new r(o.x,o.y):Array.isArray(o)?new r(o[0],o[1]):new r(o.x,o.y)}r.clone=e;function n(o){return r.isPoint(o)?{x:o.x,y:o.y}:Array.isArray(o)?{x:o[0],y:o[1]}:{x:o.x,y:o.y}}r.toJSON=n;function s(o,l,f=new r){let g=Math.abs(o*Math.cos(l)),p=Math.abs(o*Math.sin(l));const m=e(f),y=pt.normalize(pt.toDeg(l));return y<90?p=-p:y<180?(g=-g,p=-p):y<270&&(g=-g),new r(m.x+g,m.y+p)}r.fromPolar=s;function a(o,l=new r){const f=e(o),g=e(l),p=f.x-g.x,m=f.y-g.y;return new r(Math.sqrt(p*p+m*m),pt.toRad(g.theta(f)))}r.toPolar=a;function u(o,l){return o===l?!0:o!=null&&l!=null?o.x===l.x&&o.y===l.y:!1}r.equals=u;function h(o,l){if(o==null&&l!=null||o!=null&&l==null||o!=null&&l!=null&&o.length!==l.length)return!1;if(o!=null&&l!=null){for(let f=0,g=o.length;f<g;f+=1)if(!u(o[f],l[f]))return!1}return!0}r.equalPoints=h;function d(o,l,f,g){return new r(Q.random(o,l),Q.random(f,g))}r.random=d;function c(o,l,f){const g=pt.toRad(pt.normalize(-l)),p=Math.sin(g),m=Math.cos(g);return i(o,m,p,f)}r.rotate=c;function i(o,l,f,g=new r){const p=e(o),m=e(g),y=p.x-m.x,b=p.y-m.y,v=y*l-b*f,x=b*l+y*f;return new r(v+m.x,x+m.y)}r.rotateEx=i})(L||(L={}));class Y extends se{get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new L(this.x,this.y)}get topLeft(){return new L(this.x,this.y)}get topCenter(){return new L(this.x+this.width/2,this.y)}get topRight(){return new L(this.x+this.width,this.y)}get center(){return new L(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new L(this.x,this.y+this.height)}get bottomCenter(){return new L(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new L(this.x+this.width,this.y+this.height)}get corner(){return new L(this.x+this.width,this.y+this.height)}get rightMiddle(){return new L(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new L(this.x,this.y+this.height/2)}get topLine(){return new H(this.topLeft,this.topRight)}get rightLine(){return new H(this.topRight,this.bottomRight)}get bottomLine(){return new H(this.bottomLeft,this.bottomRight)}get leftLine(){return new H(this.topLeft,this.bottomLeft)}constructor(t,e,n,s){super();this.x=t==null?0:t,this.y=e==null?0:e,this.width=n==null?0:n,this.height=s==null?0:s}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(t){if(!t)return this.clone();const e=pt.toRad(t),n=Math.abs(Math.sin(e)),s=Math.abs(Math.cos(e)),a=this.width*s+this.height*n,u=this.width*n+this.height*s;return new Y(this.x+(this.width-a)/2,this.y+(this.height-u)/2,a,u)}round(t=0){return this.x=Q.round(this.x,t),this.y=Q.round(this.y,t),this.width=Q.round(this.width,t),this.height=Q.round(this.height,t),this}add(t,e,n,s){const a=Y.create(t,e,n,s),u=Math.min(this.x,a.x),h=Math.min(this.y,a.y),d=Math.max(this.x+this.width,a.x+a.width),c=Math.max(this.y+this.height,a.y+a.height);return this.x=u,this.y=h,this.width=d-u,this.height=c-h,this}update(t,e,n,s){const a=Y.create(t,e,n,s);return this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height,this}inflate(t,e){const n=t,s=e!=null?e:t;return this.x-=n,this.y-=s,this.width+=2*n,this.height+=2*s,this}snapToGrid(t,e){const n=this.origin.snapToGrid(t,e),s=this.corner.snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=s.x-n.x,this.height=s.y-n.y,this}translate(t,e){const n=L.create(t,e);return this.x+=n.x,this.y+=n.y,this}scale(t,e,n=new L){const s=this.origin.scale(t,e,n);return this.x=s.x,this.y=s.y,this.width*=t,this.height*=e,this}rotate(t,e=this.getCenter()){if(t!==0){const n=pt.toRad(t),s=Math.cos(n),a=Math.sin(n);let u=this.getOrigin(),h=this.getTopRight(),d=this.getBottomRight(),c=this.getBottomLeft();u=L.rotateEx(u,s,a,e),h=L.rotateEx(h,s,a,e),d=L.rotateEx(d,s,a,e),c=L.rotateEx(c,s,a,e);const i=new Y(u.x,u.y,0,0);i.add(h.x,h.y,0,0),i.add(d.x,d.y,0,0),i.add(c.x,c.y,0,0),this.update(i)}return this}rotate90(){const t=(this.width-this.height)/2;this.x+=t,this.y-=t;const e=this.width;return this.width=this.height,this.height=e,this}moveAndExpand(t){const e=Y.clone(t);return this.x+=e.x||0,this.y+=e.y||0,this.width+=e.width||0,this.height+=e.height||0,this}getMaxScaleToFit(t,e=this.center){const n=Y.clone(t),s=e.x,a=e.y;let u=1/0,h=1/0,d=1/0,c=1/0,i=1/0,o=1/0,l=1/0,f=1/0;const g=n.topLeft;g.x<s&&(u=(this.x-s)/(g.x-s)),g.y<a&&(i=(this.y-a)/(g.y-a));const p=n.bottomRight;p.x>s&&(h=(this.x+this.width-s)/(p.x-s)),p.y>a&&(o=(this.y+this.height-a)/(p.y-a));const m=n.topRight;m.x>s&&(d=(this.x+this.width-s)/(m.x-s)),m.y<a&&(l=(this.y-a)/(m.y-a));const y=n.bottomLeft;return y.x<s&&(c=(this.x-s)/(y.x-s)),y.y>a&&(f=(this.y+this.height-a)/(y.y-a)),{sx:Math.min(u,h,d,c),sy:Math.min(i,o,l,f)}}getMaxUniformScaleToFit(t,e=this.center){const n=this.getMaxScaleToFit(t,e);return Math.min(n.sx,n.sy)}containsPoint(t,e){return Q.containsPoint(this,L.create(t,e))}containsRect(t,e,n,s){const a=Y.create(t,e,n,s),u=this.x,h=this.y,d=this.width,c=this.height,i=a.x,o=a.y,l=a.width,f=a.height;return d===0||c===0||l===0||f===0?!1:i>=u&&o>=h&&i+l<=u+d&&o+f<=h+c}intersectsWithLine(t){const e=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],n=[],s=[];return e.forEach(a=>{const u=t.intersectsWithLine(a);u!==null&&s.indexOf(u.toString())<0&&(n.push(u),s.push(u.toString()))}),n.length>0?n:null}intersectsWithLineFromCenterToPoint(t,e){const n=L.clone(t),s=this.center;let a=null;e!=null&&e!==0&&n.rotate(e,s);const u=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],h=new H(s,n);for(let d=u.length-1;d>=0;d-=1){const c=u[d].intersectsWithLine(h);if(c!==null){a=c;break}}return a&&e!=null&&e!==0&&a.rotate(-e,s),a}intersectsWithRect(t,e,n,s){const a=Y.create(t,e,n,s);if(!this.isIntersectWithRect(a))return null;const u=this.origin,h=this.corner,d=a.origin,c=a.corner,i=Math.max(u.x,d.x),o=Math.max(u.y,d.y);return new Y(i,o,Math.min(h.x,c.x)-i,Math.min(h.y,c.y)-o)}isIntersectWithRect(t,e,n,s){const a=Y.create(t,e,n,s),u=this.origin,h=this.corner,d=a.origin,c=a.corner;return!(c.x<=u.x||c.y<=u.y||d.x>=h.x||d.y>=h.y)}normalize(){let t=this.x,e=this.y,n=this.width,s=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,s=-this.height),this.x=t,this.y=e,this.width=n,this.height=s,this}union(t){const e=Y.clone(t),n=this.origin,s=this.corner,a=e.origin,u=e.corner,h=Math.min(n.x,a.x),d=Math.min(n.y,a.y),c=Math.max(s.x,u.x),i=Math.max(s.y,u.y);return new Y(h,d,c-h,i-d)}getNearestSideToPoint(t){const e=L.clone(t),n=e.x-this.x,s=this.x+this.width-e.x,a=e.y-this.y,u=this.y+this.height-e.y;let h=n,d="left";return s<h&&(h=s,d="right"),a<h&&(h=a,d="top"),u<h&&(d="bottom"),d}getNearestPointToPoint(t){const e=L.clone(t);if(this.containsPoint(e)){const n=this.getNearestSideToPoint(e);if(n==="left")return new L(this.x,e.y);if(n==="top")return new L(e.x,this.y);if(n==="right")return new L(this.x+this.width,e.y);if(n==="bottom")return new L(e.x,this.y+this.height)}return e.adhereToRect(this)}equals(t){return t!=null&&t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height}clone(){return new Y(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}(function(r){function t(e){return e!=null&&e instanceof r}r.isRectangle=t})(Y||(Y={}));(function(r){function t(e){return e!=null&&typeof e=="object"&&typeof e.x=="number"&&typeof e.y=="number"&&typeof e.width=="number"&&typeof e.height=="number"}r.isRectangleLike=t})(Y||(Y={}));(function(r){function t(u,h,d,c){return u==null||typeof u=="number"?new r(u,h,d,c):e(u)}r.create=t;function e(u){return r.isRectangle(u)?u.clone():Array.isArray(u)?new r(u[0],u[1],u[2],u[3]):new r(u.x,u.y,u.width,u.height)}r.clone=e;function n(u){return new r(u.x-u.a,u.y-u.b,2*u.a,2*u.b)}r.fromEllipse=n;function s(u){return new r(0,0,u.width,u.height)}r.fromSize=s;function a(u,h){return new r(u.x,u.y,h.width,h.height)}r.fromPositionAndSize=a})(Y||(Y={}));class H extends se{get center(){return new L((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}constructor(t,e,n,s){super();typeof t=="number"&&typeof e=="number"?(this.start=new L(t,e),this.end=new L(n,s)):(this.start=L.create(t),this.end=L.create(e))}getCenter(){return this.center}round(t=0){return this.start.round(t),this.end.round(t),this}translate(t,e){return typeof t=="number"?(this.start.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.end.translate(t)),this}rotate(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this}scale(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.start.x-this.end.x,e=this.start.y-this.end.y;return t*t+e*e}setLength(t){const e=this.length();if(!e)return this;const n=t/e;return this.scale(n,n,this.start)}parallel(t){const e=this.clone();if(!e.isDifferentiable())return e;const{start:n,end:s}=e,a=n.clone().rotate(270,s),u=s.clone().rotate(90,n);return n.move(u,t),s.move(a,t),e}vector(){return new L(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const t=new L(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)}bbox(){const t=Math.min(this.start.x,this.end.x),e=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),s=Math.max(this.start.y,this.end.y);return new Y(t,e,n-t,s-e)}bearing(){return this.start.bearing(this.end)}closestPoint(t){return this.pointAt(this.closestPointNormalizedLength(t))}closestPointLength(t){return this.closestPointNormalizedLength(t)*this.length()}closestPointTangent(t){return this.tangentAt(this.closestPointNormalizedLength(t))}closestPointNormalizedLength(t){const e=this.vector().dot(new H(this.start,t).vector()),n=Math.min(1,Math.max(0,e/this.squaredLength()));return Number.isNaN(n)?0:n}pointAt(t){const e=this.start,n=this.end;return t<=0?e.clone():t>=1?n.clone():e.lerp(n,t)}pointAtLength(t){const e=this.start,n=this.end;let s=!0;t<0&&(s=!1,t=-t);const a=this.length();if(t>=a)return s?n.clone():e.clone();const u=(s?t:a-t)/a;return this.pointAt(u)}divideAt(t){const e=this.pointAt(t);return[new H(this.start,e),new H(e,this.end)]}divideAtLength(t){const e=this.pointAtLength(t);return[new H(this.start,e),new H(e,this.end)]}containsPoint(t){const e=this.start,n=this.end;if(e.cross(t,n)!==0)return!1;const s=this.length();return!(new H(e,t).length()>s||new H(t,n).length()>s)}intersect(t,e){const n=t.intersectsWithLine(this,e);return n?Array.isArray(n)?n:[n]:null}intersectsWithLine(t){const e=new L(this.end.x-this.start.x,this.end.y-this.start.y),n=new L(t.end.x-t.start.x,t.end.y-t.start.y),s=e.x*n.y-e.y*n.x,a=new L(t.start.x-this.start.x,t.start.y-this.start.y),u=a.x*n.y-a.y*n.x,h=a.x*e.y-a.y*e.x;if(s===0||u*s<0||h*s<0)return null;if(s>0){if(u>s||h>s)return null}else if(u<s||h<s)return null;return new L(this.start.x+u*e.x/s,this.start.y+u*e.y/s)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(t){const e=L.clone(t),n=this.start,s=this.end;return((s.x-n.x)*(e.y-n.y)-(s.y-n.y)*(e.x-n.x))/this.length()}pointSquaredDistance(t,e){const n=L.create(t,e);return this.closestPoint(n).squaredDistance(n)}pointDistance(t,e){const n=L.create(t,e);return this.closestPoint(n).distance(n)}tangentAt(t){if(!this.isDifferentiable())return null;const e=this.start,n=this.end,s=this.pointAt(t),a=new H(e,n);return a.translate(s.x-e.x,s.y-e.y),a}tangentAtLength(t){if(!this.isDifferentiable())return null;const e=this.start,n=this.end,s=this.pointAtLength(t),a=new H(e,n);return a.translate(s.x-e.x,s.y-e.y),a}relativeCcw(t,e){const n=L.create(t,e);let s=n.x-this.start.x,a=n.y-this.start.y;const u=this.end.x-this.start.x,h=this.end.y-this.start.y;let d=s*h-a*u;return d===0&&(d=s*u+a*h,d>0&&(s-=u,a-=h,d=s*u+a*h,d<0&&(d=0))),d<0?-1:d>0?1:0}equals(t){return t!=null&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y}clone(){return new H(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}}(function(r){function t(e){return e!=null&&e instanceof r}r.isLine=t})(H||(H={}));class oe extends se{get center(){return new L(this.x,this.y)}constructor(t,e,n,s){super();this.x=t==null?0:t,this.y=e==null?0:e,this.a=n==null?0:n,this.b=s==null?0:s}bbox(){return Y.fromEllipse(this)}getCenter(){return this.center}inflate(t,e){const n=t,s=e!=null?e:t;return this.a+=2*n,this.b+=2*s,this}normalizedDistance(t,e){const n=L.create(t,e),s=n.x-this.x,a=n.y-this.y,u=this.a,h=this.b;return s*s/(u*u)+a*a/(h*h)}containsPoint(t,e){return this.normalizedDistance(t,e)<=1}intersectsWithLine(t){const e=[],n=this.a,s=this.b,a=t.start,u=t.end,h=t.vector(),d=a.diff(new L(this.x,this.y)),c=new L(h.x/(n*n),h.y/(s*s)),i=new L(d.x/(n*n),d.y/(s*s)),o=h.dot(c),l=h.dot(i),f=d.dot(i)-1,g=l*l-o*f;if(g<0)return null;if(g>0){const p=Math.sqrt(g),m=(-l-p)/o,y=(-l+p)/o;if((m<0||m>1)&&(y<0||y>1))return null;m>=0&&m<=1&&e.push(a.lerp(u,m)),y>=0&&y<=1&&e.push(a.lerp(u,y))}else{const p=-l/o;if(p>=0&&p<=1)e.push(a.lerp(u,p));else return null}return e}intersectsWithLineFromCenterToPoint(t,e=0){const n=L.clone(t);e&&n.rotate(e,this.getCenter());const s=n.x-this.x,a=n.y-this.y;let u;if(s===0)return u=this.bbox().getNearestPointToPoint(n),e?u.rotate(-e,this.getCenter()):u;const h=a/s,d=h*h,c=this.a*this.a,i=this.b*this.b;let o=Math.sqrt(1/(1/c+d/i));o=s<0?-o:o;const l=h*o;return u=new L(this.x+o,this.y+l),e?u.rotate(-e,this.getCenter()):u}tangentTheta(t){const e=L.clone(t),n=e.x,s=e.y,a=this.a,u=this.b,h=this.bbox().center,d=h.x,c=h.y,i=30,o=n>h.x+a/2,l=n<h.x-a/2;let f,g;return o||l?(g=n>h.x?s-i:s+i,f=a*a/(n-d)-a*a*(s-c)*(g-c)/(u*u*(n-d))+d):(f=s>h.y?n+i:n-i,g=u*u/(s-c)-u*u*(n-d)*(f-d)/(a*a*(s-c))+c),new L(f,g).theta(e)}scale(t,e){return this.a*=t,this.b*=e,this}rotate(t,e){const n=Y.fromEllipse(this);n.rotate(t,e);const s=oe.fromRect(n);return this.a=s.a,this.b=s.b,this.x=s.x,this.y=s.y,this}translate(t,e){const n=L.create(t,e);return this.x+=n.x,this.y+=n.y,this}equals(t){return t!=null&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b}clone(){return new oe(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}(function(r){function t(e){return e!=null&&e instanceof r}r.isEllipse=t})(oe||(oe={}));(function(r){function t(s,a,u,h){return s==null||typeof s=="number"?new r(s,a,u,h):e(s)}r.create=t;function e(s){return r.isEllipse(s)?s.clone():Array.isArray(s)?new r(s[0],s[1],s[2],s[3]):new r(s.x,s.y,s.a,s.b)}r.parse=e;function n(s){const a=s.center;return new r(a.x,a.y,s.width/2,s.height/2)}r.fromRect=n})(oe||(oe={}));const ld=new RegExp("^[\\s\\dLMCZz,.]*$");function cd(r){return typeof r!="string"?!1:ld.test(r)}function $s(r,t){return(r%t+t)%t}function ud(r,t,e,n,s){const a=[],u=r[r.length-1],h=t!=null&&t>0,d=t||0;if(n&&h){r=r.slice();const o=r[0],l=new L(u.x+(o.x-u.x)/2,u.y+(o.y-u.y)/2);r.splice(0,0,l)}let c=r[0],i=1;for(e?a.push("M",c.x,c.y):a.push("L",c.x,c.y);i<(n?r.length:r.length-1);){let o=r[$s(i,r.length)],l=c.x-o.x,f=c.y-o.y;if(h&&(l!==0||f!==0)&&(s==null||s.indexOf(i-1)<0)){let g=Math.sqrt(l*l+f*f);const p=l*Math.min(d,g/2)/g,m=f*Math.min(d,g/2)/g,y=o.x+p,b=o.y+m;a.push("L",y,b);let v=r[$s(i+1,r.length)];for(;i<r.length-2&&Math.round(v.x-o.x)===0&&Math.round(v.y-o.y)===0;)v=r[$s(i+2,r.length)],i+=1;l=v.x-o.x,f=v.y-o.y,g=Math.max(1,Math.sqrt(l*l+f*f));const x=l*Math.min(d,g/2)/g,P=f*Math.min(d,g/2)/g,C=o.x+x,_=o.y+P;a.push("Q",o.x,o.y,C,_),o=new L(C,_)}else a.push("L",o.x,o.y);c=o,i+=1}return n?a.push("Z"):a.push("L",u.x,u.y),a.map(o=>typeof o=="string"?o:+o.toFixed(3)).join(" ")}function Va(r,t={}){const e=[];return r&&r.length&&r.forEach(n=>{Array.isArray(n)?e.push({x:n[0],y:n[1]}):e.push({x:n.x,y:n.y})}),ud(e,t.round,t.initialMove==null||t.initialMove,t.close,t.exclude)}function Gn(r,t,e,n,s=0,a=0,u=0,h,d){if(e===0||n===0)return[];h-=r,d-=t,e=Math.abs(e),n=Math.abs(n);const c=-h/2,i=-d/2,o=Math.cos(s*Math.PI/180),l=Math.sin(s*Math.PI/180),f=o*c+l*i,g=-1*l*c+o*i,p=f*f,m=g*g,y=e*e,b=n*n,v=p/y+m/b;let x;if(v>1)e=Math.sqrt(v)*e,n=Math.sqrt(v)*n,x=0;else{let st=1;a===u&&(st=-1),x=st*Math.sqrt((y*b-y*m-b*p)/(y*m+b*p))}const P=x*e*g/n,C=-1*x*n*f/e,_=o*P-l*C+h/2,A=l*P+o*C+d/2;let S=Math.atan2((g-C)/n,(f-P)/e)-Math.atan2(0,1),w=S>=0?S:2*Math.PI+S;S=Math.atan2((-g-C)/n,(-f-P)/e)-Math.atan2((g-C)/n,(f-P)/e);let O=S>=0?S:2*Math.PI+S;u===0&&O>0?O-=2*Math.PI:u!==0&&O<0&&(O+=2*Math.PI);const M=O*2/Math.PI,T=Math.ceil(M<0?-1*M:M),j=O/T,N=8/3*Math.sin(j/4)*Math.sin(j/4)/Math.sin(j/2),D=o*e,B=o*n,F=l*e,z=l*n;let W=Math.cos(w),U=Math.sin(w),Me=-N*(D*U+z*W),Ae=-N*(F*U-B*W),zt=0,J=0;const et=[];for(let st=0;st<T;st+=1){w+=j,W=Math.cos(w),U=Math.sin(w),zt=D*W-z*U+_,J=F*W+B*U+A;const Zt=-N*(D*U+z*W),pe=-N*(F*U-B*W),Tt=st*6;et[Tt]=Number(Me+r),et[Tt+1]=Number(Ae+t),et[Tt+2]=Number(zt-Zt+r),et[Tt+3]=Number(J-pe+t),et[Tt+4]=Number(zt+r),et[Tt+5]=Number(J+t),Me=zt+Zt,Ae=J+pe}return et.map(st=>+st.toFixed(2))}function hd(r,t,e,n,s=0,a=0,u=0,h,d){const c=[],i=Gn(r,t,e,n,s,a,u,h,d);if(i!=null)for(let o=0,l=i.length;o<l;o+=6)c.push("C",i[o],i[o+1],i[o+2],i[o+3],i[o+4],i[o+5]);return c.join(" ")}class Et extends se{get start(){return this.points[0]||null}get end(){return this.points[this.points.length-1]||null}constructor(t){super();if(t!=null){if(typeof t=="string")return Et.parse(t);this.points=t.map(e=>L.create(e))}else this.points=[]}scale(t,e,n=new L){return this.points.forEach(s=>s.scale(t,e,n)),this}rotate(t,e){return this.points.forEach(n=>n.rotate(t,e)),this}translate(t,e){const n=L.create(t,e);return this.points.forEach(s=>s.translate(n.x,n.y)),this}round(t=0){return this.points.forEach(e=>e.round(t)),this}bbox(){if(this.points.length===0)return new Y;let t=1/0,e=-1/0,n=1/0,s=-1/0;const a=this.points;for(let u=0,h=a.length;u<h;u+=1){const d=a[u],c=d.x,i=d.y;c<t&&(t=c),c>e&&(e=c),i<n&&(n=i),i>s&&(s=i)}return new Y(t,n,e-t,s-n)}closestPoint(t){const e=this.closestPointLength(t);return this.pointAtLength(e)}closestPointLength(t){const e=this.points,n=e.length;if(n===0||n===1)return 0;let s=0,a=0,u=1/0;for(let h=0,d=n-1;h<d;h+=1){const c=new H(e[h],e[h+1]),i=c.length(),o=c.closestPointNormalizedLength(t),f=c.pointAt(o).squaredDistance(t);f<u&&(u=f,a=s+o*i),s+=i}return a}closestPointNormalizedLength(t){const e=this.length();return e===0?0:this.closestPointLength(t)/e}closestPointTangent(t){const e=this.closestPointLength(t);return this.tangentAtLength(e)}containsPoint(t){if(this.points.length===0)return!1;const e=L.clone(t),n=e.x,s=e.y,a=this.points,u=a.length;let h=u-1,d=0;for(let c=0;c<u;c+=1){const i=a[h],o=a[c];if(e.equals(i))return!0;const l=new H(i,o);if(l.containsPoint(t))return!0;if(s<=i.y&&s>o.y||s>i.y&&s<=o.y){const f=i.x-n>o.x-n?i.x-n:o.x-n;if(f>=0){const g=new L(n+f,s),p=new H(t,g);l.intersectsWithLine(p)&&(d+=1)}}h=c}return d%2==1}intersectsWithLine(t){const e=[];for(let n=0,s=this.points.length-1;n<s;n+=1){const a=this.points[n],u=this.points[n+1],h=t.intersectsWithLine(new H(a,u));h&&e.push(h)}return e.length>0?e:null}isDifferentiable(){for(let t=0,e=this.points.length-1;t<e;t+=1){const n=this.points[t],s=this.points[t+1];if(new H(n,s).isDifferentiable())return!0}return!1}length(){let t=0;for(let e=0,n=this.points.length-1;e<n;e+=1){const s=this.points[e],a=this.points[e+1];t+=s.distance(a)}return t}pointAt(t){const e=this.points,n=e.length;if(n===0)return null;if(n===1||t<=0)return e[0].clone();if(t>=1)return e[n-1].clone();const a=this.length()*t;return this.pointAtLength(a)}pointAtLength(t){const e=this.points,n=e.length;if(n===0)return null;if(n===1)return e[0].clone();let s=!0;t<0&&(s=!1,t=-t);let a=0;for(let h=0,d=n-1;h<d;h+=1){const c=s?h:d-1-h,i=e[c],o=e[c+1],l=new H(i,o),f=i.distance(o);if(t<=a+f)return l.pointAtLength((s?1:-1)*(t-a));a+=f}return(s?e[n-1]:e[0]).clone()}tangentAt(t){const n=this.points.length;if(n===0||n===1)return null;t<0&&(t=0),t>1&&(t=1);const a=this.length()*t;return this.tangentAtLength(a)}tangentAtLength(t){const e=this.points,n=e.length;if(n===0||n===1)return null;let s=!0;t<0&&(s=!1,t=-t);let a,u=0;for(let h=0,d=n-1;h<d;h+=1){const c=s?h:d-1-h,i=e[c],o=e[c+1],l=new H(i,o),f=i.distance(o);if(l.isDifferentiable()){if(t<=u+f)return l.tangentAtLength((s?1:-1)*(t-u));a=l}u+=f}if(a){const h=s?1:0;return a.tangentAt(h)}return null}simplify(t={}){const e=this.points;if(e.length<3)return this;const n=t.threshold||0;let s=0;for(;e[s+2];){const a=s,u=s+1,h=s+2,d=e[a],c=e[u],i=e[h];new H(d,i).closestPoint(c).distance(c)<=n?e.splice(u,1):s+=1}return this}toHull(){const t=this.points,e=t.length;if(e===0)return new Et;let n=t[0];for(let l=1;l<e;l+=1)(t[l].y<n.y||t[l].y===n.y&&t[l].x>n.x)&&(n=t[l]);const s=[];for(let l=0;l<e;l+=1){let f=n.theta(t[l]);f===0&&(f=360),s.push([t[l],l,f])}if(s.sort((l,f)=>{let g=l[2]-f[2];return g===0&&(g=f[1]-l[1]),g}),s.length>2){const l=s[s.length-1];s.unshift(l)}const a={},u=[],h=l=>`${l[0].toString()}@${l[1]}`;for(;s.length!==0;){const l=s.pop(),f=l[0];if(a[h(l)])continue;let g=!1;for(;!g;)if(u.length<2)u.push(l),g=!0;else{const p=u.pop(),m=p[0],y=u.pop(),b=y[0],v=b.cross(m,f);if(v<0)u.push(y),u.push(p),u.push(l),g=!0;else if(v===0){const x=1e-10,P=m.angleBetween(b,f);Math.abs(P-180)<x||m.equals(f)||b.equals(m)?(a[h(p)]=m,u.push(y)):Math.abs((P+1)%360-1)<x&&(u.push(y),s.push(p))}else a[h(p)]=m,u.push(y)}}u.length>2&&u.pop();let d,c=-1;for(let l=0,f=u.length;l<f;l+=1){const g=u[l][1];(d===void 0||g<d)&&(d=g,c=l)}let i=[];if(c>0){const l=u.slice(c),f=u.slice(0,c);i=l.concat(f)}else i=u;const o=[];for(let l=0,f=i.length;l<f;l+=1)o.push(i[l][0]);return new Et(o)}equals(t){return t==null||t.points.length!==this.points.length?!1:t.points.every((e,n)=>e.equals(this.points[n]))}clone(){return new Et(this.points.map(t=>t.clone()))}toJSON(){return this.points.map(t=>t.toJSON())}serialize(){return this.points.map(t=>`${t.serialize()}`).join(" ")}}(function(r){function t(e){return e!=null&&e instanceof r}r.isPolyline=t})(Et||(Et={}));(function(r){function t(e){const n=e.trim();if(n==="")return new r;const s=[],a=n.split(/\s*,\s*|\s+/);for(let u=0,h=a.length;u<h;u+=2)s.push({x:+a[u],y:+a[u+1]});return new r(s)}r.parse=t})(Et||(Et={}));class it extends se{constructor(t,e,n,s){super();this.PRECISION=3,this.start=L.create(t),this.controlPoint1=L.create(e),this.controlPoint2=L.create(n),this.end=L.create(s)}bbox(){const t=this.start,e=this.controlPoint1,n=this.controlPoint2,s=this.end,a=t.x,u=t.y,h=e.x,d=e.y,c=n.x,i=n.y,o=s.x,l=s.y,f=[],g=[],p=[[],[]];let m,y,b,v,x,P,C,_;for(let B=0;B<2;B+=1){if(B===0?(y=6*a-12*h+6*c,m=-3*a+9*h-9*c+3*o,b=3*h-3*a):(y=6*u-12*d+6*i,m=-3*u+9*d-9*i+3*l,b=3*d-3*u),Math.abs(m)<1e-12){if(Math.abs(y)<1e-12)continue;v=-b/y,v>0&&v<1&&g.push(v);continue}C=y*y-4*b*m,_=Math.sqrt(C),!(C<0)&&(x=(-y+_)/(2*m),x>0&&x<1&&g.push(x),P=(-y-_)/(2*m),P>0&&P<1&&g.push(P))}let A,S,w,O=g.length;const M=O;for(;O;)O-=1,v=g[O],w=1-v,A=w*w*w*a+3*w*w*v*h+3*w*v*v*c+v*v*v*o,p[0][O]=A,S=w*w*w*u+3*w*w*v*d+3*w*v*v*i+v*v*v*l,p[1][O]=S,f[O]={X:A,Y:S};g[M]=0,g[M+1]=1,f[M]={X:a,Y:u},f[M+1]={X:o,Y:l},p[0][M]=a,p[1][M]=u,p[0][M+1]=o,p[1][M+1]=l,g.length=M+2,p[0].length=M+2,p[1].length=M+2,f.length=M+2;const T=Math.min.apply(null,p[0]),j=Math.min.apply(null,p[1]),N=Math.max.apply(null,p[0]),D=Math.max.apply(null,p[1]);return new Y(T,j,N-T,D-j)}closestPoint(t,e={}){return this.pointAtT(this.closestPointT(t,e))}closestPointLength(t,e={}){const n=this.getOptions(e);return this.lengthAtT(this.closestPointT(t,n),n)}closestPointNormalizedLength(t,e={}){const n=this.getOptions(e),s=this.closestPointLength(t,n);if(!s)return 0;const a=this.length(n);return a===0?0:s/a}closestPointT(t,e={}){const n=this.getPrecision(e),s=this.getDivisions(e),a=Math.pow(10,-n);let u=null,h=0,d=0,c=0,i=0,o=0,l=null;const f=s.length;let g=f>0?1/f:0;for(s.forEach((p,m)=>{const y=p.start.distance(t),b=p.end.distance(t),v=y+b;(l==null||v<l)&&(u=p,h=m*g,d=(m+1)*g,c=y,i=b,l=v,o=p.endpointDistance())});;){const p=c?Math.abs(c-i)/c:0,m=i!=null?Math.abs(c-i)/i:0,y=p<a||m<a,b=c?c<o*a:!0,v=i?i<o*a:!0;if(y||(b||v))return c<=i?h:d;const P=u.divide(.5);g/=2;const C=P[0].start.distance(t),_=P[0].end.distance(t),A=C+_,S=P[1].start.distance(t),w=P[1].end.distance(t),O=S+w;A<=O?(u=P[0],d-=g,c=C,i=_):(u=P[1],h+=g,c=S,i=w)}}closestPointTangent(t,e={}){return this.tangentAtT(this.closestPointT(t,e))}containsPoint(t,e={}){return this.toPolyline(e).containsPoint(t)}divideAt(t,e={}){if(t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);const n=this.tAt(t,e);return this.divideAtT(n)}divideAtLength(t,e={}){const n=this.tAtLength(t,e);return this.divideAtT(n)}divide(t){return this.divideAtT(t)}divideAtT(t){const e=this.start,n=this.controlPoint1,s=this.controlPoint2,a=this.end;if(t<=0)return[new it(e,e,e,e),new it(e,n,s,a)];if(t>=1)return[new it(e,n,s,a),new it(a,a,a,a)];const u=this.getSkeletonPoints(t),h=u.startControlPoint1,d=u.startControlPoint2,c=u.divider,i=u.dividerControlPoint1,o=u.dividerControlPoint2;return[new it(e,h,d,c),new it(c,i,o,a)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(t){const e=this.start,n=this.controlPoint1,s=this.controlPoint2,a=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:s.clone()};if(t>=1)return{startControlPoint1:n.clone(),startControlPoint2:s.clone(),divider:a.clone(),dividerControlPoint1:a.clone(),dividerControlPoint2:a.clone()};const u=new H(e,n).pointAt(t),h=new H(n,s).pointAt(t),d=new H(s,a).pointAt(t),c=new H(u,h).pointAt(t),i=new H(h,d).pointAt(t),o=new H(c,i).pointAt(t);return{startControlPoint1:u,startControlPoint2:c,divider:o,dividerControlPoint1:i,dividerControlPoint2:d}}getSubdivisions(t={}){const e=this.getPrecision(t);let n=[new it(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(e===0)return n;let s=this.endpointDistance();const a=Math.pow(10,-e);let u=0;for(;;){u+=1;const h=[];n.forEach(i=>{const o=i.divide(.5);h.push(o[0],o[1])});const d=h.reduce((i,o)=>i+o.endpointDistance(),0),c=d!==0?(d-s)/d:0;if(u>1&&c<a)return h;n=h,s=d}}length(t={}){return this.getDivisions(t).reduce((n,s)=>n+s.endpointDistance(),0)}lengthAtT(t,e={}){if(t<=0)return 0;const n=e.precision===void 0?this.PRECISION:e.precision;return this.divide(t)[0].length({precision:n})}pointAt(t,e={}){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const n=this.tAt(t,e);return this.pointAtT(n)}pointAtLength(t,e={}){const n=this.tAtLength(t,e);return this.pointAtT(n)}pointAtT(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider}isDifferentiable(){const t=this.start,e=this.controlPoint1,n=this.controlPoint2,s=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(s))}tangentAt(t,e={}){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);const n=this.tAt(t,e);return this.tangentAtT(n)}tangentAtLength(t,e={}){if(!this.isDifferentiable())return null;const n=this.tAtLength(t,e);return this.tangentAtT(n)}tangentAtT(t){if(!this.isDifferentiable())return null;t<0&&(t=0),t>1&&(t=1);const e=this.getSkeletonPoints(t),n=e.startControlPoint2,s=e.dividerControlPoint1,a=e.divider,u=new H(n,s);return u.translate(a.x-n.x,a.y-n.y),u}getPrecision(t={}){return t.precision==null?this.PRECISION:t.precision}getDivisions(t={}){if(t.subdivisions!=null)return t.subdivisions;const e=this.getPrecision(t);return this.getSubdivisions({precision:e})}getOptions(t={}){const e=this.getPrecision(t),n=this.getDivisions(t);return{precision:e,subdivisions:n}}tAt(t,e={}){if(t<=0)return 0;if(t>=1)return 1;const n=this.getOptions(e),a=this.length(n)*t;return this.tAtLength(a,n)}tAtLength(t,e={}){let n=!0;t<0&&(n=!1,t=-t);const s=this.getPrecision(e),a=this.getDivisions(e),u={precision:s,subdivisions:a};let h=null,d,c,i=0,o=0,l=0;const f=a.length;let g=f>0?1/f:0;for(let y=0;y<f;y+=1){const b=n?y:f-1-y,v=a[y],x=v.endpointDistance();if(t<=l+x){h=v,d=b*g,c=(b+1)*g,i=n?t-l:x+l-t,o=n?x+l-t:t-l;break}l+=x}if(h==null)return n?1:0;const p=this.length(u),m=Math.pow(10,-s);for(;;){let y;if(y=p!==0?i/p:0,y<m)return d;if(y=p!==0?o/p:0,y<m)return c;let b,v;const x=h.divide(.5);g/=2;const P=x[0].endpointDistance(),C=x[1].endpointDistance();i<=P?(h=x[0],c-=g,b=i,v=P-b):(h=x[1],d+=g,b=i-P,v=C-b),i=b,o=v}}toPoints(t={}){const e=this.getDivisions(t),n=[e[0].start.clone()];return e.forEach(s=>n.push(s.end.clone())),n}toPolyline(t={}){return new Et(this.toPoints(t))}scale(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.start.rotate(t,e),this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?(this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return t!=null&&this.start.equals(t.start)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)&&this.end.equals(t.end)}clone(){return new it(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}(function(r){function t(e){return e!=null&&e instanceof r}r.isCurve=t})(it||(it={}));(function(r){function t(s){const a=s.length,u=[],h=[];let d=2;u[0]=s[0]/d;for(let c=1;c<a;c+=1)h[c]=1/d,d=(c<a-1?4:3.5)-h[c],u[c]=(s[c]-u[c-1])/d;for(let c=1;c<a;c+=1)u[a-c-1]-=h[a-c]*u[a-c];return u}function e(s){const a=s.map(l=>L.clone(l)),u=[],h=[],d=a.length-1;if(d===1)return u[0]=new L((2*a[0].x+a[1].x)/3,(2*a[0].y+a[1].y)/3),h[0]=new L(2*u[0].x-a[0].x,2*u[0].y-a[0].y),[u,h];const c=[];for(let l=1;l<d-1;l+=1)c[l]=4*a[l].x+2*a[l+1].x;c[0]=a[0].x+2*a[1].x,c[d-1]=(8*a[d-1].x+a[d].x)/2;const i=t(c);for(let l=1;l<d-1;l+=1)c[l]=4*a[l].y+2*a[l+1].y;c[0]=a[0].y+2*a[1].y,c[d-1]=(8*a[d-1].y+a[d].y)/2;const o=t(c);for(let l=0;l<d;l+=1)u.push(new L(i[l],o[l])),l<d-1?h.push(new L(2*a[l+1].x-i[l+1],2*a[l+1].y-o[l+1])):h.push(new L((a[d].x+i[d-1])/2,(a[d].y+o[d-1])/2));return[u,h]}function n(s){if(s==null||Array.isArray(s)&&s.length<2)throw new Error("At least 2 points are required");const a=e(s),u=[];for(let h=0,d=a[0].length;h<d;h+=1){const c=new L(a[0][h].x,a[0][h].y),i=new L(a[1][h].x,a[1][h].y);u.push(new r(s[h],c,i,s[h+1]))}return u}r.throughPoints=n})(it||(it={}));class mn extends se{constructor(){super(...arguments);this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(this.previousSegment==null)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(t,e){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(t,e){if(t<=0)return 0;const n=this.length();return t>=1?n:n*t}divideAtT(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}class ut extends mn{constructor(t,e){super();H.isLine(t)?this.endPoint=t.end.clone().round(2):this.endPoint=L.create(t,e).round(2)}get type(){return"L"}get line(){return new H(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[new ut(e[0]),new ut(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[new ut(e[0]),new ut(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return this.previousSegment==null?!1:!this.start.equals(this.end)}clone(){return new ut(this.end)}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?this.end.translate(t,e):this.end.translate(t),this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}(function(r){function t(...e){const n=e.length,s=e[0];if(H.isLine(s))return new r(s);if(L.isPointLike(s))return n===1?new r(s):e.map(u=>new r(u));if(n===2)return new r(+e[0],+e[1]);const a=[];for(let u=0;u<n;u+=2){const h=+e[u],d=+e[u+1];a.push(new r(h,d))}return a}r.create=t})(ut||(ut={}));class ze extends mn{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new H(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[e[1].isDifferentiable()?new ut(e[0]):this.clone(),new ut(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[e[1].isDifferentiable()?new ut(e[0]):this.clone(),new ut(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)}scale(){return this}rotate(){return this}translate(){return this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}clone(){return new ze}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}(function(r){function t(){return new r}r.create=t})(ze||(ze={}));class ke extends mn{constructor(t,e){super();this.isVisible=!1,this.isSubpathStart=!0,H.isLine(t)||it.isCurve(t)?this.endPoint=t.end.clone().round(2):this.endPoint=L.create(t,e).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(t,e,n){return this.end.scale(t,e,n),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?this.end.translate(t,e):this.end.translate(t),this}clone(){return new ke(this.end)}equals(t){return this.type===t.type&&this.end.equals(t.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}(function(r){function t(...e){const n=e.length,s=e[0];if(H.isLine(s))return new r(s);if(it.isCurve(s))return new r(s);if(L.isPointLike(s)){if(n===1)return new r(s);const u=[];for(let h=0;h<n;h+=1)h===0?u.push(new r(e[h])):u.push(new ut(e[h]));return u}if(n===2)return new r(+e[0],+e[1]);const a=[];for(let u=0;u<n;u+=2){const h=+e[u],d=+e[u+1];u===0?a.push(new r(h,d)):a.push(new ut(h,d))}return a}r.create=t})(ke||(ke={}));class _t extends mn{constructor(t,e,n,s,a,u){super();it.isCurve(t)?(this.controlPoint1=t.controlPoint1.clone().round(2),this.controlPoint2=t.controlPoint2.clone().round(2),this.endPoint=t.end.clone().round(2)):typeof t=="number"?(this.controlPoint1=new L(t,e).round(2),this.controlPoint2=new L(n,s).round(2),this.endPoint=new L(a,u).round(2)):(this.controlPoint1=L.create(t).round(2),this.controlPoint2=L.create(e).round(2),this.endPoint=L.create(n).round(2))}get type(){return"C"}get curve(){return new it(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(t){return this.curve.closestPoint(t)}closestPointLength(t){return this.curve.closestPointLength(t)}closestPointNormalizedLength(t){return this.curve.closestPointNormalizedLength(t)}closestPointTangent(t){return this.curve.closestPointTangent(t)}length(){return this.curve.length()}divideAt(t,e={}){const n=this.curve.divideAt(t,e);return[new _t(n[0]),new _t(n[1])]}divideAtLength(t,e={}){const n=this.curve.divideAtLength(t,e);return[new _t(n[0]),new _t(n[1])]}divideAtT(t){const e=this.curve.divideAtT(t);return[new _t(e[0]),new _t(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.curve.pointAt(t)}pointAtLength(t){return this.curve.pointAtLength(t)}tangentAt(t){return this.curve.tangentAt(t)}tangentAtLength(t){return this.curve.tangentAtLength(t)}isDifferentiable(){if(!this.previousSegment)return!1;const t=this.start,e=this.controlPoint1,n=this.controlPoint2,s=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(s))}scale(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this}rotate(t,e){return this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?(this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return this.start.equals(t.start)&&this.end.equals(t.end)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)}clone(){return new _t(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.controlPoint1,e=this.controlPoint2,n=this.end;return[this.type,t.x,t.y,e.x,e.y,n.x,n.y].join(" ")}}(function(r){function t(...e){const n=e.length,s=e[0];if(it.isCurve(s))return new r(s);if(L.isPointLike(s)){if(n===3)return new r(e[0],e[1],e[2]);const u=[];for(let h=0;h<n;h+=3)u.push(new r(e[h],e[h+1],e[h+2]));return u}if(n===6)return new r(e[0],e[1],e[2],e[3],e[4],e[5]);const a=[];for(let u=0;u<n;u+=6)a.push(new r(e[u],e[u+1],e[u+2],e[u+3],e[u+4],e[u+5]));return a}r.create=t})(_t||(_t={}));function qn(r,t,e){return{x:r*Math.cos(e)-t*Math.sin(e),y:r*Math.sin(e)+t*Math.cos(e)}}function Fa(r,t,e,n,s,a){const u=1/3,h=2/3;return[u*r+h*e,u*t+h*n,u*s+h*e,u*a+h*n,s,a]}function za(r,t,e,n,s,a,u,h,d,c){const i=Math.PI*120/180,o=Math.PI/180*(+s||0);let l=[],f,g,p,m,y;if(c)g=c[0],p=c[1],m=c[2],y=c[3];else{f=qn(r,t,-o),r=f.x,t=f.y,f=qn(h,d,-o),h=f.x,d=f.y;const j=(r-h)/2,N=(t-d)/2;let D=j*j/(e*e)+N*N/(n*n);D>1&&(D=Math.sqrt(D),e=D*e,n=D*n);const B=e*e,F=n*n,z=(a===u?-1:1)*Math.sqrt(Math.abs((B*F-B*N*N-F*j*j)/(B*N*N+F*j*j)));m=z*e*N/n+(r+h)/2,y=z*-n*j/e+(t+d)/2,g=Math.asin((t-y)/n),p=Math.asin((d-y)/n),g=r<m?Math.PI-g:g,p=h<m?Math.PI-p:p,g<0&&(g=Math.PI*2+g),p<0&&(p=Math.PI*2+p),u&&g>p&&(g-=Math.PI*2),!u&&p>g&&(p-=Math.PI*2)}let b=p-g;if(Math.abs(b)>i){const j=p,N=h,D=d;p=g+i*(u&&p>g?1:-1),h=m+e*Math.cos(p),d=y+n*Math.sin(p),l=za(h,d,e,n,s,0,u,N,D,[p,j,m,y])}b=p-g;const v=Math.cos(g),x=Math.sin(g),P=Math.cos(p),C=Math.sin(p),_=Math.tan(b/4),A=4/3*(e*_),S=4/3*(n*_),w=[r,t],O=[r+A*x,t-S*v],M=[h+A*C,d-S*P],T=[h,d];if(O[0]=2*w[0]-O[0],O[1]=2*w[1]-O[1],c)return[O,M,T].concat(l);{l=[O,M,T].concat(l).join().split(",");const j=[],N=l.length;for(let D=0;D<N;D+=1)j[D]=D%2?qn(+l[D-1],+l[D],o).y:qn(+l[D],+l[D+1],o).x;return j}}function dd(r){if(!r)return null;const t=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,e=new RegExp(`([a-z])[${t},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${t}]*,?[${t}]*)+)`,"ig"),n=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${t}]*,?[${t}]*`,"ig"),s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},a=[];return r.replace(e,(u,h,d)=>{const c=[];let i=h.toLowerCase();d.replace(n,(l,f)=>(f&&c.push(+f),l)),i==="m"&&c.length>2&&(a.push([h,...c.splice(0,2)]),i="l",h=h==="m"?"l":"L");const o=s[i];for(;c.length>=o&&(a.push([h,...c.splice(0,o)]),!!o););return u}),a}function fd(r){const t=dd(r);if(!t||!t.length)return[["M",0,0]];let e=0,n=0,s=0,a=0;const u=[];for(let h=0,d=t.length;h<d;h+=1){const c=[];u.push(c);const i=t[h],o=i[0];if(o!==o.toUpperCase())switch(c[0]=o.toUpperCase(),c[0]){case"A":c[1]=i[1],c[2]=i[2],c[3]=i[3],c[4]=i[4],c[5]=i[5],c[6]=+i[6]+e,c[7]=+i[7]+n;break;case"V":c[1]=+i[1]+n;break;case"H":c[1]=+i[1]+e;break;case"M":s=+i[1]+e,a=+i[2]+n;for(let l=1,f=i.length;l<f;l+=1)c[l]=+i[l]+(l%2?e:n);break;default:for(let l=1,f=i.length;l<f;l+=1)c[l]=+i[l]+(l%2?e:n);break}else for(let l=0,f=i.length;l<f;l+=1)c[l]=i[l];switch(c[0]){case"Z":e=+s,n=+a;break;case"H":e=c[1];break;case"V":n=c[1];break;case"M":s=c[c.length-2],a=c[c.length-1],e=c[c.length-2],n=c[c.length-1];break;default:e=c[c.length-2],n=c[c.length-1];break}}return u}function gd(r){const t=fd(r),e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function n(d,c,i){let o,l;if(!d)return["C",c.x,c.y,c.x,c.y,c.x,c.y];switch(d[0]in{T:1,Q:1}||(c.qx=null,c.qy=null),d[0]){case"M":c.X=d[1],c.Y=d[2];break;case"A":return parseFloat(d[1])===0||parseFloat(d[2])===0?["L",d[6],d[7]]:["C"].concat(za.apply(0,[c.x,c.y].concat(d.slice(1))));case"S":return i==="C"||i==="S"?(o=c.x*2-c.bx,l=c.y*2-c.by):(o=c.x,l=c.y),["C",o,l].concat(d.slice(1));case"T":return i==="Q"||i==="T"?(c.qx=c.x*2-c.qx,c.qy=c.y*2-c.qy):(c.qx=c.x,c.qy=c.y),["C"].concat(Fa(c.x,c.y,c.qx,c.qy,d[1],d[2]));case"Q":return c.qx=d[1],c.qy=d[2],["C"].concat(Fa(c.x,c.y,d[1],d[2],d[3],d[4]));case"H":return["L"].concat(d[1],c.y);case"V":return["L"].concat(c.x,d[1])}return d}function s(d,c){if(d[c].length>7){d[c].shift();const i=d[c];for(;i.length;)a[c]="A",c+=1,d.splice(c,0,["C"].concat(i.splice(0,6)));d.splice(c,1),h=t.length}}const a=[];let u="",h=t.length;for(let d=0;d<h;d+=1){let c="";t[d]&&(c=t[d][0]),c!=="C"&&(a[d]=c,d>0&&(u=a[d-1])),t[d]=n(t[d],e,u),a[d]!=="A"&&c==="C"&&(a[d]="C"),s(t,d);const i=t[d],o=i.length;e.x=i[o-2],e.y=i[o-1],e.bx=parseFloat(i[o-4])||e.x,e.by=parseFloat(i[o-3])||e.y}return(!t[0][0]||t[0][0]!=="M")&&t.unshift(["M",0,0]),t}function ka(r){return gd(r).map(t=>t.map(e=>typeof e=="string"?e:Q.round(e,2))).join(",").split(",").join(" ")}class K extends se{constructor(t){super();if(this.PRECISION=3,this.segments=[],Array.isArray(t))if(H.isLine(t[0])||it.isCurve(t[0])){let e=null;t.forEach((s,a)=>{a===0&&this.appendSegment(K.createSegment("M",s.start)),e!=null&&!e.end.equals(s.start)&&this.appendSegment(K.createSegment("M",s.start)),H.isLine(s)?this.appendSegment(K.createSegment("L",s.end)):it.isCurve(s)&&this.appendSegment(K.createSegment("C",s.controlPoint1,s.controlPoint2,s.end)),e=s})}else t.forEach(n=>{n.isSegment&&this.appendSegment(n)});else t!=null&&(H.isLine(t)?(this.appendSegment(K.createSegment("M",t.start)),this.appendSegment(K.createSegment("L",t.end))):it.isCurve(t)?(this.appendSegment(K.createSegment("M",t.start)),this.appendSegment(K.createSegment("C",t.controlPoint1,t.controlPoint2,t.end))):Et.isPolyline(t)?t.points&&t.points.length&&t.points.forEach((e,n)=>{const s=n===0?K.createSegment("M",e):K.createSegment("L",e);this.appendSegment(s)}):t.isSegment&&this.appendSegment(t))}get start(){const t=this.segments,e=t.length;if(e===0)return null;for(let n=0;n<e;n+=1){const s=t[n];if(s.isVisible)return s.start}return t[e-1].end}get end(){const t=this.segments,e=t.length;if(e===0)return null;for(let n=e-1;n>=0;n-=1){const s=t[n];if(s.isVisible)return s.end}return t[e-1].end}moveTo(...t){return this.appendSegment(ke.create.call(null,...t))}lineTo(...t){return this.appendSegment(ut.create.call(null,...t))}curveTo(...t){return this.appendSegment(_t.create.call(null,...t))}arcTo(t,e,n,s,a,u,h){const d=this.end||new L,c=typeof u=="number"?Gn(d.x,d.y,t,e,n,s,a,u,h):Gn(d.x,d.y,t,e,n,s,a,u.x,u.y);if(c!=null)for(let i=0,o=c.length;i<o;i+=6)this.curveTo(c[i],c[i+1],c[i+2],c[i+3],c[i+4],c[i+5]);return this}quadTo(t,e,n,s){const a=this.end||new L,u=["M",a.x,a.y];if(typeof t=="number")u.push("Q",t,e,n,s);else{const d=e;u.push("Q",t.x,t.y,d.x,d.y)}const h=K.parse(u.join(" "));return this.appendSegment(h.segments.slice(1)),this}close(){return this.appendSegment(ze.create())}drawPoints(t,e={}){const n=Va(t,e),s=K.parse(n);s&&s.segments&&this.appendSegment(s.segments)}bbox(){const t=this.segments,e=t.length;if(e===0)return null;let n;for(let a=0;a<e;a+=1){const u=t[a];if(u.isVisible){const h=u.bbox();h!=null&&(n=n?n.union(h):h)}}if(n!=null)return n;const s=t[e-1];return new Y(s.end.x,s.end.y,0,0)}appendSegment(t){const e=this.segments.length;let n=e!==0?this.segments[e-1]:null,s;const a=null;if(Array.isArray(t))for(let u=0,h=t.length;u<h;u+=1){const d=t[u];s=this.prepareSegment(d,n,a),this.segments.push(s),n=s}else t!=null&&t.isSegment&&(s=this.prepareSegment(t,n,a),this.segments.push(s));return this}insertSegment(t,e){const n=this.segments.length;if(t<0&&(t=n+t+1),t>n||t<0)throw new Error("Index out of range.");let s,a=null,u=null;if(n!==0&&(t>=1?(a=this.segments[t-1],u=a.nextSegment):(a=null,u=this.segments[0])),!Array.isArray(e))s=this.prepareSegment(e,a,u),this.segments.splice(t,0,s);else for(let h=0,d=e.length;h<d;h+=1){const c=e[h];s=this.prepareSegment(c,a,u),this.segments.splice(t+h,0,s),a=s}return this}removeSegment(t){const e=this.fixIndex(t),n=this.segments.splice(e,1)[0],s=n.previousSegment,a=n.nextSegment;return s&&(s.nextSegment=a),a&&(a.previousSegment=s),n.isSubpathStart&&a&&this.updateSubpathStartSegment(a),n}replaceSegment(t,e){const n=this.fixIndex(t);let s;const a=this.segments[n];let u=a.previousSegment;const h=a.nextSegment;let d=a.isSubpathStart;if(!Array.isArray(e))s=this.prepareSegment(e,u,h),this.segments.splice(n,1,s),d&&s.isSubpathStart&&(d=!1);else{this.segments.splice(t,1);for(let c=0,i=e.length;c<i;c+=1){const o=e[c];s=this.prepareSegment(o,u,h),this.segments.splice(t+c,0,s),u=s,d&&s.isSubpathStart&&(d=!1)}}d&&h&&this.updateSubpathStartSegment(h)}getSegment(t){const e=this.fixIndex(t);return this.segments[e]}fixIndex(t){const e=this.segments.length;if(e===0)throw new Error("Path has no segments.");let n=t;for(;n<0;)n=e+n;if(n>=e||n<0)throw new Error("Index out of range.");return n}segmentAt(t,e={}){const n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null}segmentAtLength(t,e={}){const n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null}segmentIndexAt(t,e={}){if(this.segments.length===0)return null;const n=Q.clamp(t,0,1),s=this.getOptions(e),u=this.length(s)*n;return this.segmentIndexAtLength(u,s)}segmentIndexAtLength(t,e={}){const n=this.segments.length;if(n===0)return null;let s=!0;t<0&&(s=!1,t=-t);const a=this.getPrecision(e),u=this.getSubdivisions(e);let h=0,d=null;for(let c=0;c<n;c+=1){const i=s?c:n-1-c,o=this.segments[i],l=u[i],f=o.length({precision:a,subdivisions:l});if(o.isVisible){if(t<=h+f)return i;d=i}h+=f}return d}getSegmentSubdivisions(t={}){const e=this.getPrecision(t),n=[];for(let s=0,a=this.segments.length;s<a;s+=1){const h=this.segments[s].getSubdivisions({precision:e});n.push(h)}return n}updateSubpathStartSegment(t){let e=t.previousSegment,n=t;for(;n&&!n.isSubpathStart;)e!=null?n.subpathStartSegment=e.subpathStartSegment:n.subpathStartSegment=null,e=n,n=n.nextSegment}prepareSegment(t,e,n){t.previousSegment=e,t.nextSegment=n,e!=null&&(e.nextSegment=t),n!=null&&(n.previousSegment=t);let s=t;return t.isSubpathStart&&(t.subpathStartSegment=t,s=n),s!=null&&this.updateSubpathStartSegment(s),t}closestPoint(t,e={}){const n=this.closestPointT(t,e);return n?this.pointAtT(n):null}closestPointLength(t,e={}){const n=this.getOptions(e),s=this.closestPointT(t,n);return s?this.lengthAtT(s,n):0}closestPointNormalizedLength(t,e={}){const n=this.getOptions(e),s=this.closestPointLength(t,n);if(s===0)return 0;const a=this.length(n);return a===0?0:s/a}closestPointT(t,e={}){if(this.segments.length===0)return null;const n=this.getPrecision(e),s=this.getSubdivisions(e);let a,u=1/0;for(let h=0,d=this.segments.length;h<d;h+=1){const c=this.segments[h],i=s[h];if(c.isVisible){const o=c.closestPointT(t,{precision:n,subdivisions:i}),l=c.pointAtT(o),f=Q.squaredLength(l,t);f<u&&(a={segmentIndex:h,value:o},u=f)}}return a||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(t,e={}){if(this.segments.length===0)return null;const n=this.getPrecision(e),s=this.getSubdivisions(e);let a,u=1/0;for(let h=0,d=this.segments.length;h<d;h+=1){const c=this.segments[h],i=s[h];if(c.isDifferentiable()){const o=c.closestPointT(t,{precision:n,subdivisions:i}),l=c.pointAtT(o),f=Q.squaredLength(l,t);f<u&&(a=c.tangentAtT(o),u=f)}}return a||null}containsPoint(t,e={}){const n=this.toPolylines(e);if(!n)return!1;let s=0;for(let a=0,u=n.length;a<u;a+=1)n[a].containsPoint(t)&&(s+=1);return s%2==1}pointAt(t,e={}){if(this.segments.length===0)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const n=this.getOptions(e),a=this.length(n)*t;return this.pointAtLength(a,n)}pointAtLength(t,e={}){if(this.segments.length===0)return null;if(t===0)return this.start.clone();let n=!0;t<0&&(n=!1,t=-t);const s=this.getPrecision(e),a=this.getSubdivisions(e);let u,h=0;for(let c=0,i=this.segments.length;c<i;c+=1){const o=n?c:i-1-c,l=this.segments[o],f=a[o],g=l.length({precision:s,subdivisions:f});if(l.isVisible){if(t<=h+g)return l.pointAtLength((n?1:-1)*(t-h),{precision:s,subdivisions:f});u=l}h+=g}return u?n?u.end:u.start:this.segments[this.segments.length-1].end.clone()}pointAtT(t){const e=this.segments,n=e.length;if(n===0)return null;const s=t.segmentIndex;if(s<0)return e[0].pointAtT(0);if(s>=n)return e[n-1].pointAtT(1);const a=Q.clamp(t.value,0,1);return e[s].pointAtT(a)}divideAt(t,e={}){if(this.segments.length===0)return null;const n=Q.clamp(t,0,1),s=this.getOptions(e),u=this.length(s)*n;return this.divideAtLength(u,s)}divideAtLength(t,e={}){if(this.segments.length===0)return null;let n=!0;t<0&&(n=!1,t=-t);const s=this.getPrecision(e),a=this.getSubdivisions(e);let u=0,h,d,c,i,o;for(let P=0,C=this.segments.length;P<C;P+=1){const _=n?P:C-1-P,A=this.getSegment(_),S=a[_],w={precision:s,subdivisions:S},O=A.length(w);if(A.isDifferentiable()&&(c=A,i=_,t<=u+O)){d=_,h=A.divideAtLength((n?1:-1)*(t-u),w);break}u+=O}if(!c)return null;h||(d=i,o=n?1:0,h=c.divideAtT(o));const l=this.clone(),f=d;l.replaceSegment(f,h);const g=f;let p=f+1,m=f+2;h[0].isDifferentiable()||(l.removeSegment(g),p-=1,m-=1);const y=l.getSegment(p).start;l.insertSegment(p,K.createSegment("M",y)),m+=1,h[1].isDifferentiable()||(l.removeSegment(m-1),m-=1);const b=m-g-1;for(let P=m,C=l.segments.length;P<C;P+=1){const _=this.getSegment(P-b),A=l.getSegment(P);if(A.type==="Z"&&!_.subpathStartSegment.end.equals(A.subpathStartSegment.end)){const S=K.createSegment("L",_.end);l.replaceSegment(P,S)}}const v=new K(l.segments.slice(0,p)),x=new K(l.segments.slice(p));return[v,x]}intersectsWithLine(t,e={}){const n=this.toPolylines(e);if(n==null)return null;let s=null;for(let a=0,u=n.length;a<u;a+=1){const h=n[a],d=t.intersect(h);d&&(s==null&&(s=[]),Array.isArray(d)?s.push(...d):s.push(d))}return s}isDifferentiable(){for(let t=0,e=this.segments.length;t<e;t+=1)if(this.segments[t].isDifferentiable())return!0;return!1}isValid(){const t=this.segments;return t.length===0||t[0].type==="M"}length(t={}){if(this.segments.length===0)return 0;const e=this.getSubdivisions(t);let n=0;for(let s=0,a=this.segments.length;s<a;s+=1){const u=this.segments[s],h=e[s];n+=u.length({subdivisions:h})}return n}lengthAtT(t,e={}){const n=this.segments.length;if(n===0)return 0;let s=t.segmentIndex;if(s<0)return 0;let a=Q.clamp(t.value,0,1);s>=n&&(s=n-1,a=1);const u=this.getPrecision(e),h=this.getSubdivisions(e);let d=0;for(let o=0;o<s;o+=1){const l=this.segments[o],f=h[o];d+=l.length({precision:u,subdivisions:f})}const c=this.segments[s],i=h[s];return d+=c.lengthAtT(a,{precision:u,subdivisions:i}),d}tangentAt(t,e={}){if(this.segments.length===0)return null;const n=Q.clamp(t,0,1),s=this.getOptions(e),u=this.length(s)*n;return this.tangentAtLength(u,s)}tangentAtLength(t,e={}){if(this.segments.length===0)return null;let n=!0;t<0&&(n=!1,t=-t);const s=this.getPrecision(e),a=this.getSubdivisions(e);let u,h=0;for(let d=0,c=this.segments.length;d<c;d+=1){const i=n?d:c-1-d,o=this.segments[i],l=a[i],f=o.length({precision:s,subdivisions:l});if(o.isDifferentiable()){if(t<=h+f)return o.tangentAtLength((n?1:-1)*(t-h),{precision:s,subdivisions:l});u=o}h+=f}if(u){const d=n?1:0;return u.tangentAtT(d)}return null}tangentAtT(t){const e=this.segments.length;if(e===0)return null;const n=t.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=e)return this.segments[e-1].tangentAtT(1);const s=Q.clamp(t.value,0,1);return this.segments[n].tangentAtT(s)}getPrecision(t={}){return t.precision==null?this.PRECISION:t.precision}getSubdivisions(t={}){if(t.segmentSubdivisions==null){const e=this.getPrecision(t);return this.getSegmentSubdivisions({precision:e})}return t.segmentSubdivisions}getOptions(t={}){const e=this.getPrecision(t),n=this.getSubdivisions(t);return{precision:e,segmentSubdivisions:n}}toPoints(t={}){const e=this.segments,n=e.length;if(n===0)return null;const s=this.getSubdivisions(t),a=[];let u=[];for(let h=0;h<n;h+=1){const d=e[h];if(d.isVisible){const c=s[h];c.length>0?c.forEach(i=>u.push(i.start)):u.push(d.start)}else u.length>0&&(u.push(e[h-1].end),a.push(u),u=[])}return u.length>0&&(u.push(this.end),a.push(u)),a}toPolylines(t={}){const e=this.toPoints(t);return e?e.map(n=>new Et(n)):null}scale(t,e,n){return this.segments.forEach(s=>s.scale(t,e,n)),this}rotate(t,e){return this.segments.forEach(n=>n.rotate(t,e)),this}translate(t,e){return typeof t=="number"?this.segments.forEach(n=>n.translate(t,e)):this.segments.forEach(n=>n.translate(t)),this}clone(){const t=new K;return this.segments.forEach(e=>t.appendSegment(e.clone())),t}equals(t){if(t==null)return!1;const e=this.segments,n=t.segments,s=e.length;if(n.length!==s)return!1;for(let a=0;a<s;a+=1){const u=e[a],h=n[a];if(u.type!==h.type||!u.equals(h))return!1}return!0}toJSON(){return this.segments.map(t=>t.toJSON())}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map(t=>t.serialize()).join(" ")}toString(){return this.serialize()}}(function(r){function t(e){return e!=null&&e instanceof r}r.isPath=t})(K||(K={}));(function(r){function t(n){if(!n)return new r;const s=new r,a=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,u=r.normalize(n).match(a);if(u!=null)for(let h=0,d=u.length;h<d;h+=1){const c=u[h],i=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,o=c.match(i);if(o!=null){const l=o[0],f=o.slice(1).map(p=>+p),g=e.call(null,l,...f);s.appendSegment(g)}}return s}r.parse=t;function e(n,...s){if(n==="M")return ke.create.call(null,...s);if(n==="L")return ut.create.call(null,...s);if(n==="C")return _t.create.call(null,...s);if(n==="z"||n==="Z")return ze.create();throw new Error(`Invalid path segment type "${n}"`)}r.createSegment=e})(K||(K={}));(function(r){r.normalize=ka,r.isValid=cd,r.drawArc=hd,r.drawPoints=Va,r.arcToCurves=Gn})(K||(K={}));var pd=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get Angle(){return pt},get Point(){return L},get Line(){return H},get Ellipse(){return oe},get Rectangle(){return Y},get Path(){return K},Segment:mn,normalizePathData:ka,get Curve(){return it},get Polyline(){return Et},get GeometryUtil(){return Q}}),I=bo(pd),Dt={},Ha={},ot={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Registry=void 0;const t=$;class e{constructor(s){this.options=Object.assign({},s),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(s,a,u=!1){if(typeof s=="object"){Object.entries(s).forEach(([c,i])=>{this.register(c,i,a)});return}this.exist(s)&&!u&&!t.Platform.isApplyingHMR()&&this.onDuplicated(s);const h=this.options.process,d=h?t.FunctionExt.call(h,this,s,a):a;return this.data[s]=d,d}unregister(s){const a=s?this.data[s]:null;return delete this.data[s],a}get(s){return s?this.data[s]:null}exist(s){return s?this.data[s]!=null:!1}onDuplicated(s){try{throw this.options.onConflict&&t.FunctionExt.call(this.options.onConflict,this,s),new Error(`${t.StringExt.upperFirst(this.options.type)} with name '${s}' already registered.`)}catch(a){throw a}}onNotFound(s,a){throw new Error(this.getSpellingSuggestion(s,a))}getSpellingSuggestion(s,a){const u=this.getSpellingSuggestionForName(s),h=a?`${a} ${t.StringExt.lowerFirst(this.options.type)}`:this.options.type;return`${t.StringExt.upperFirst(h)} with name '${s}' does not exist.${u?` Did you mean '${u}'?`:""}`}getSpellingSuggestionForName(s){return t.StringExt.getSpellingSuggestion(s,Object.keys(this.data),a=>a)}}r.Registry=e,function(n){function s(a){return new n(a)}n.create=s}(e=r.Registry||(r.Registry={}))})(ot);var Ga={},Wn={};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.dot=void 0;const md=$;Wn.dot={color:"#aaaaaa",thickness:1,markup:"rect",update(r,t){const e=t.thickness*t.sx,n=t.thickness*t.sy;md.Dom.attr(r,{width:e,height:n,rx:e,ry:n,fill:t.color})}};var Un={};Object.defineProperty(Un,"__esModule",{value:!0});Un.fixedDot=void 0;const yd=$;Un.fixedDot={color:"#aaaaaa",thickness:1,markup:"rect",update(r,t){const e=t.sx<=1?t.thickness*t.sx:t.thickness;yd.Dom.attr(r,{width:e,height:e,rx:e,ry:e,fill:t.color})}};var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.mesh=void 0;const bd=$;Jn.mesh={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(r,t){let e;const n=t.width,s=t.height,a=t.thickness;n-a>=0&&s-a>=0?e=["M",n,0,"H0 M0 0 V0",s].join(" "):e="M 0 0 0 0",bd.Dom.attr(r,{d:e,stroke:t.color,"stroke-width":t.thickness})}};var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0});Xn.doubleMesh=void 0;const qa=$;Xn.doubleMesh=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(r,t){let e;const n=t.width,s=t.height,a=t.thickness;n-a>=0&&s-a>=0?e=["M",n,0,"H0 M0 0 V0",s].join(" "):e="M 0 0 0 0",qa.Dom.attr(r,{d:e,stroke:t.color,"stroke-width":t.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(r,t){let e;const n=t.factor||1,s=t.width*n,a=t.height*n,u=t.thickness;s-u>=0&&a-u>=0?e=["M",s,0,"H0 M0 0 V0",a].join(" "):e="M 0 0 0 0",t.width=s,t.height=a,qa.Dom.attr(r,{d:e,stroke:t.color,"stroke-width":t.thickness})}}];(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Wn,r),e(Un,r),e(Jn,r),e(Xn,r)})(Ga);(function(r){var t=E&&E.__createBinding||(Object.create?function(d,c,i,o){o===void 0&&(o=i);var l=Object.getOwnPropertyDescriptor(c,i);(!l||("get"in l?!c.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return c[i]}}),Object.defineProperty(d,o,l)}:function(d,c,i,o){o===void 0&&(o=i),d[o]=c[i]}),e=E&&E.__setModuleDefault||(Object.create?function(d,c){Object.defineProperty(d,"default",{enumerable:!0,value:c})}:function(d,c){d.default=c}),n=E&&E.__importStar||function(d){if(d&&d.__esModule)return d;var c={};if(d!=null)for(var i in d)i!=="default"&&Object.prototype.hasOwnProperty.call(d,i)&&t(c,d,i);return e(c,d),c};Object.defineProperty(r,"__esModule",{value:!0}),r.Grid=void 0;const s=$,a=ot,u=n(Ga);class h{constructor(){this.patterns={},this.root=s.Vector.create(s.Dom.createSvgDocument(),{width:"100%",height:"100%"},[s.Dom.createSvgElement("defs")]).node}add(c,i){const o=this.root.childNodes[0];o&&o.appendChild(i),this.patterns[c]=i,s.Vector.create("rect",{width:"100%",height:"100%",fill:`url(#${c})`}).appendTo(this.root)}get(c){return this.patterns[c]}has(c){return this.patterns[c]!=null}}r.Grid=h,function(d){d.presets=u,d.registry=a.Registry.create({type:"grid"}),d.registry.register(d.presets,!0)}(h=r.Grid||(r.Grid={}))})(Ha);var Wa={},Ua={},Yn={};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.flipX=void 0;const vd=function(r){const t=document.createElement("canvas"),e=r.width,n=r.height;t.width=e*2,t.height=n;const s=t.getContext("2d");return s.drawImage(r,0,0,e,n),s.translate(2*e,0),s.scale(-1,1),s.drawImage(r,0,0,e,n),t};Yn.flipX=vd;var Kn={};Object.defineProperty(Kn,"__esModule",{value:!0});Kn.flipY=void 0;const wd=function(r){const t=document.createElement("canvas"),e=r.width,n=r.height;t.width=e,t.height=n*2;const s=t.getContext("2d");return s.drawImage(r,0,0,e,n),s.translate(0,2*n),s.scale(1,-1),s.drawImage(r,0,0,e,n),t};Kn.flipY=wd;var Zn={};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.flipXY=void 0;const xd=function(r){const t=document.createElement("canvas"),e=r.width,n=r.height;t.width=2*e,t.height=2*n;const s=t.getContext("2d");return s.drawImage(r,0,0,e,n),s.setTransform(-1,0,0,-1,t.width,t.height),s.drawImage(r,0,0,e,n),s.setTransform(-1,0,0,1,t.width,0),s.drawImage(r,0,0,e,n),s.setTransform(1,0,0,-1,0,t.height),s.drawImage(r,0,0,e,n),t};Zn.flipXY=xd;var Qn={};Object.defineProperty(Qn,"__esModule",{value:!0});Qn.watermark=void 0;const Pd=I,Od=function(r,t){const e=r.width,n=r.height,s=document.createElement("canvas");s.width=e*3,s.height=n*3;const a=s.getContext("2d"),u=t.angle!=null?-t.angle:-20,h=Pd.Angle.toRad(u),d=s.width/4,c=s.height/4;for(let i=0;i<4;i+=1)for(let o=0;o<4;o+=1)(i+o)%2>0&&(a.setTransform(1,0,0,1,(2*i-1)*d,(2*o-1)*c),a.rotate(h),a.drawImage(r,-e/2,-n/2,e,n));return s};Qn.watermark=Od;(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Yn,r),e(Kn,r),e(Zn,r),e(Qn,r)})(Ua);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.Background=void 0;const s=ot,a=n(Ua);(function(u){u.presets=Object.assign({},a),u.presets["flip-x"]=a.flipX,u.presets["flip-y"]=a.flipY,u.presets["flip-xy"]=a.flipXY,u.registry=s.Registry.create({type:"background pattern"}),u.registry.register(u.presets,!0)})(r.Background||(r.Background={}))})(Wa);var Ja={},Xa={},ti={},ht={};Object.defineProperty(ht,"__esModule",{value:!0});ht.getNumber=ht.getString=void 0;function Ed(r,t){return r!=null?r:t}ht.getString=Ed;function Cd(r,t){return r!=null&&Number.isFinite(r)?r:t}ht.getNumber=Cd;Object.defineProperty(ti,"__esModule",{value:!0});ti.outline=void 0;const ei=ht;function _d(r={}){const t=(0,ei.getString)(r.color,"blue"),e=(0,ei.getNumber)(r.width,1),n=(0,ei.getNumber)(r.margin,2),s=(0,ei.getNumber)(r.opacity,1),a=n,u=n+e;return`
    <filter>
      <feFlood flood-color="${t}" flood-opacity="${s}" result="colored"/>
      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${u}" />
      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${a}" />
      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>
      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>
      <feMerge>
        <feMergeNode in="outline"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  `.trim()}ti.outline=_d;var ni={};Object.defineProperty(ni,"__esModule",{value:!0});ni.highlight=void 0;const ii=ht;function Sd(r={}){const t=(0,ii.getString)(r.color,"red"),e=(0,ii.getNumber)(r.blur,0),n=(0,ii.getNumber)(r.width,1),s=(0,ii.getNumber)(r.opacity,1);return`
      <filter>
        <feFlood flood-color="${t}" flood-opacity="${s}" result="colored"/>
        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${n}"/>
        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>
        <feGaussianBlur result="blured" in="composed" stdDeviation="${e}"/>
        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>
      </filter>
    `.trim()}ni.highlight=Sd;var ri={};Object.defineProperty(ri,"__esModule",{value:!0});ri.blur=void 0;const Md=ht;function Ad(r={}){const t=(0,Md.getNumber)(r.x,2);return`
    <filter>
      <feGaussianBlur stdDeviation="${r.y!=null&&Number.isFinite(r.y)?[t,r.y]:t}"/>
    </filter>
  `.trim()}ri.blur=Ad;var si={};Object.defineProperty(si,"__esModule",{value:!0});si.dropShadow=void 0;const yn=ht;function Nd(r={}){const t=(0,yn.getNumber)(r.dx,0),e=(0,yn.getNumber)(r.dy,0),n=(0,yn.getString)(r.color,"black"),s=(0,yn.getNumber)(r.blur,4),a=(0,yn.getNumber)(r.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>
         <feDropShadow stdDeviation="${s}" dx="${t}" dy="${e}" flood-color="${n}" flood-opacity="${a}" />
       </filter>`.trim():`<filter>
         <feGaussianBlur in="SourceAlpha" stdDeviation="${s}" />
         <feOffset dx="${t}" dy="${e}" result="offsetblur" />
         <feFlood flood-color="${n}" />
         <feComposite in2="offsetblur" operator="in" />
         <feComponentTransfer>
           <feFuncA type="linear" slope="${a}" />
         </feComponentTransfer>
         <feMerge>
           <feMergeNode/>
           <feMergeNode in="SourceGraphic"/>
         </feMerge>
       </filter>`.trim()}si.dropShadow=Nd;var oi={};Object.defineProperty(oi,"__esModule",{value:!0});oi.grayScale=void 0;const Td=ht;function jd(r={}){const t=(0,Td.getNumber)(r.amount,1),e=.2126+.7874*(1-t),n=.7152-.7152*(1-t),s=.0722-.0722*(1-t),a=.2126-.2126*(1-t),u=.7152+.2848*(1-t),h=.0722-.0722*(1-t),d=.2126-.2126*(1-t),c=.0722+.9278*(1-t);return`
    <filter>
      <feColorMatrix type="matrix" values="${e} ${n} ${s} 0 0 ${a} ${u} ${h} 0 0 ${d} ${n} ${c} 0 0 0 0 0 1 0"/>
    </filter>
  `.trim()}oi.grayScale=jd;var ai={};Object.defineProperty(ai,"__esModule",{value:!0});ai.sepia=void 0;const Dd=ht;function Ld(r={}){const t=(0,Dd.getNumber)(r.amount,1),e=.393+.607*(1-t),n=.769-.769*(1-t),s=.189-.189*(1-t),a=.349-.349*(1-t),u=.686+.314*(1-t),h=.168-.168*(1-t),d=.272-.272*(1-t),c=.534-.534*(1-t),i=.131+.869*(1-t);return`
      <filter>
        <feColorMatrix type="matrix" values="${e} ${n} ${s} 0 0 ${a} ${u} ${h} 0 0 ${d} ${c} ${i} 0 0 0 0 0 1 0"/>
      </filter>
    `.trim()}ai.sepia=Ld;var li={};Object.defineProperty(li,"__esModule",{value:!0});li.saturate=void 0;const $d=ht;function Bd(r={}){const t=(0,$d.getNumber)(r.amount,1);return`
      <filter>
        <feColorMatrix type="saturate" values="${1-t}"/>
      </filter>
    `.trim()}li.saturate=Bd;var ci={};Object.defineProperty(ci,"__esModule",{value:!0});ci.hueRotate=void 0;const Rd=ht;function Id(r={}){return`
      <filter>
        <feColorMatrix type="hueRotate" values="${(0,Rd.getNumber)(r.angle,0)}"/>
      </filter>
    `.trim()}ci.hueRotate=Id;var ui={};Object.defineProperty(ui,"__esModule",{value:!0});ui.invert=void 0;const Vd=ht;function Fd(r={}){const t=(0,Vd.getNumber)(r.amount,1),e=1-t;return`
      <filter>
        <feComponentTransfer>
          <feFuncR type="table" tableValues="${t} ${e}"/>
          <feFuncG type="table" tableValues="${t} ${e}"/>
          <feFuncB type="table" tableValues="${t} ${e}"/>
        </feComponentTransfer>
      </filter>
    `.trim()}ui.invert=Fd;var hi={};Object.defineProperty(hi,"__esModule",{value:!0});hi.brightness=void 0;const zd=ht;function kd(r={}){const t=(0,zd.getNumber)(r.amount,1);return`
    <filter>
      <feComponentTransfer>
        <feFuncR type="linear" slope="${t}"/>
        <feFuncG type="linear" slope="${t}"/>
        <feFuncB type="linear" slope="${t}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}hi.brightness=kd;var di={};Object.defineProperty(di,"__esModule",{value:!0});di.contrast=void 0;const Hd=ht;function Gd(r={}){const t=(0,Hd.getNumber)(r.amount,1),e=.5-t/2;return`
    <filter>
     <feComponentTransfer>
        <feFuncR type="linear" slope="${t}" intercept="${e}"/>
        <feFuncG type="linear" slope="${t}" intercept="${e}"/>
        <feFuncB type="linear" slope="${t}" intercept="${e}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}di.contrast=Gd;(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(ti,r),e(ni,r),e(ri,r),e(si,r),e(oi,r),e(ai,r),e(li,r),e(ci,r),e(ui,r),e(hi,r),e(di,r)})(Xa);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.Filter=void 0;const s=ot,a=n(Xa);(function(u){u.presets=a,u.registry=s.Registry.create({type:"filter"}),u.registry.register(u.presets,!0)})(r.Filter||(r.Filter={}))})(Ja);var Bs={},fi={};Object.defineProperty(fi,"__esModule",{value:!0});fi.raw=void 0;fi.raw={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"};var Ya={},Ka={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.refHeight2=r.refWidth2=r.refY2=r.refX2=r.refPoints=r.refD=r.refR=r.refPointsKeepOffset=r.refPointsResetOffset=r.refDKeepOffset=r.refDResetOffset=r.refCy=r.refCx=r.refRCircumscribed=r.refRInscribed=r.refRy=r.refRx=r.refHeight=r.refWidth=r.refDy=r.refDx=r.refY=r.refX=r.ref=void 0;const t=I,e=$;r.ref={},r.refX={position:n("x","width","origin")},r.refY={position:n("y","height","origin")},r.refDx={position:n("x","width","corner")},r.refDy={position:n("y","height","corner")},r.refWidth={set:s("width","width")},r.refHeight={set:s("height","height")},r.refRx={set:s("rx","width")},r.refRy={set:s("ry","height")},r.refRInscribed={set:(d=>{const c=s(d,"width"),i=s(d,"height");return function(o,l){const f=l.refBBox,g=f.height>f.width?c:i;return e.FunctionExt.call(g,this,o,l)}})("r")},r.refRCircumscribed={set(d,{refBBox:c}){let i=parseFloat(d);const o=e.NumberExt.isPercentage(d);o&&(i/=100);const l=Math.sqrt(c.height*c.height+c.width*c.width);let f;return Number.isFinite(i)&&(o||i>=0&&i<=1?f=i*l:f=Math.max(i+l,0)),{r:f}}},r.refCx={set:s("cx","width")},r.refCy={set:s("cy","height")},r.refDResetOffset={set:u({resetOffset:!0})},r.refDKeepOffset={set:u({resetOffset:!1})},r.refPointsResetOffset={set:h({resetOffset:!0})},r.refPointsKeepOffset={set:h({resetOffset:!1})},r.refR=r.refRInscribed,r.refD=r.refDResetOffset,r.refPoints=r.refPointsResetOffset,r.refX2=r.refX,r.refY2=r.refY,r.refWidth2=r.refWidth,r.refHeight2=r.refHeight;function n(d,c,i){return(o,{refBBox:l})=>{if(o==null)return null;let f=parseFloat(o);const g=e.NumberExt.isPercentage(o);g&&(f/=100);let p;if(Number.isFinite(f)){const y=l[i];g||f>0&&f<1?p=y[d]+l[c]*f:p=y[d]+f}const m=new t.Point;return m[d]=p||0,m}}function s(d,c){return function(i,{refBBox:o}){let l=parseFloat(i);const f=e.NumberExt.isPercentage(i);f&&(l/=100);const g={};if(Number.isFinite(l)){const p=f||l>=0&&l<=1?l*o[c]:Math.max(l+o[c],0);g[d]=p}return g}}function a(d,c){const i="x6-shape",o=c&&c.resetOffset;return function(l,{elem:f,refBBox:g}){let p=e.Dom.data(f,i);if(!p||p.value!==l){const _=d(l);p={value:l,shape:_,shapeBBox:_.bbox()},e.Dom.data(f,i,p)}const m=p.shape.clone(),y=p.shapeBBox.clone(),b=y.getOrigin(),v=g.getOrigin();y.x=v.x,y.y=v.y;const x=g.getMaxScaleToFit(y,v),P=y.width===0||g.width===0?1:x.sx,C=y.height===0||g.height===0?1:x.sy;return m.scale(P,C,b),o&&m.translate(-b.x,-b.y),m}}function u(d){function c(o){return t.Path.parse(o)}const i=a(c,d);return(o,l)=>({d:i(o,l).serialize()})}function h(d){const c=a(i=>new t.Polyline(i),d);return(i,o)=>({points:c(i,o).serialize()})}})(Ka);var gi={};Object.defineProperty(gi,"__esModule",{value:!0});gi.fill=void 0;const qd=$;gi.fill={qualify:qd.ObjectExt.isPlainObject,set(r,{view:t}){return`url(#${t.graph.defineGradient(r)})`}};var pi={};Object.defineProperty(pi,"__esModule",{value:!0});pi.stroke=void 0;const Wd=$;pi.stroke={qualify:Wd.ObjectExt.isPlainObject,set(r,{view:t}){const e=t.cell,n=Object.assign({},r);if(e.isEdge()&&n.type==="linearGradient"){const s=t,a=s.sourcePoint,u=s.targetPoint;n.id=`gradient-${n.type}-${e.id}`,n.attrs=Object.assign(Object.assign({},n.attrs),{x1:a.x,y1:a.y,x2:u.x,y2:u.y,gradientUnits:"userSpaceOnUse"}),t.graph.defs.remove(n.id)}return`url(#${t.graph.defineGradient(n)})`}};var Za={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.displayEmpty=r.eol=r.annotations=r.textPath=r.textVerticalAnchor=r.lineHeight=r.textWrap=r.text=void 0;const t=$;r.text={qualify(n,{attrs:s}){return s.textWrap==null||!t.ObjectExt.isPlainObject(s.textWrap)},set(n,{view:s,elem:a,attrs:u}){const h="x6-text",d=t.Dom.data(a,h),c=f=>{try{return JSON.parse(f)}catch{return f}},i={x:u.x,eol:u.eol,annotations:c(u.annotations),textPath:c(u["text-path"]||u.textPath),textVerticalAnchor:u["text-vertical-anchor"]||u.textVerticalAnchor,displayEmpty:(u["display-empty"]||u.displayEmpty)==="true",lineHeight:u["line-height"]||u.lineHeight},o=u["font-size"]||u.fontSize,l=JSON.stringify([n,i]);if(o&&a.setAttribute("font-size",o),d==null||d!==l){const f=i.textPath;if(f!=null&&typeof f=="object"){const g=f.selector;if(typeof g=="string"){const p=s.find(g)[0];p instanceof SVGPathElement&&(t.Dom.ensureId(p),i.textPath=Object.assign({"xlink:href":`#${p.id}`},f))}}t.Dom.text(a,`${n}`,i),t.Dom.data(a,h,l)}}},r.textWrap={qualify:t.ObjectExt.isPlainObject,set(n,{view:s,elem:a,attrs:u,refBBox:h}){const d=n,c=d.width||0;t.NumberExt.isPercentage(c)?h.width*=parseFloat(c)/100:c<=0?h.width+=c:h.width=c;const i=d.height||0;t.NumberExt.isPercentage(i)?h.height*=parseFloat(i)/100:i<=0?h.height+=i:h.height=i;let o,l=d.text;l==null&&(l=u.text||(a==null?void 0:a.textContent)),l!=null?o=t.Dom.breakText(`${l}`,h,{"font-weight":u["font-weight"]||u.fontWeight,"font-size":u["font-size"]||u.fontSize,"font-family":u["font-family"]||u.fontFamily,lineHeight:u.lineHeight},{ellipsis:d.ellipsis}):o="",t.FunctionExt.call(r.text.set,this,o,{view:s,elem:a,attrs:u,refBBox:h,cell:s.cell})}};const e=(n,{attrs:s})=>s.text!==void 0;r.lineHeight={qualify:e},r.textVerticalAnchor={qualify:e},r.textPath={qualify:e},r.annotations={qualify:e},r.eol={qualify:e},r.displayEmpty={qualify:e}})(Za);var mi={};Object.defineProperty(mi,"__esModule",{value:!0});mi.title=void 0;const Qa=$;mi.title={qualify(r,{elem:t}){return t instanceof SVGElement},set(r,{elem:t}){const e="x6-title",n=`${r}`,s=Qa.Dom.data(t,e);if(s==null||s!==n){Qa.Dom.data(t,e,n);const a=t.firstChild;if(a&&a.tagName.toUpperCase()==="TITLE"){const u=a;u.textContent=n}else{const u=document.createElementNS(t.namespaceURI,"title");u.textContent=n,t.insertBefore(u,a)}}}};var ae={};Object.defineProperty(ae,"__esModule",{value:!0});ae.resetOffset=ae.yAlign=ae.xAlign=void 0;const Ud=$,Jd=I;ae.xAlign={offset:tl("x","width","right")};ae.yAlign={offset:tl("y","height","bottom")};ae.resetOffset={offset(r,{refBBox:t}){return r?{x:-t.x,y:-t.y}:{x:0,y:0}}};function tl(r,t,e){return(n,{refBBox:s})=>{const a=new Jd.Point;let u;return n==="middle"?u=s[t]/2:n===e?u=s[t]:typeof n=="number"&&Number.isFinite(n)?u=n>-1&&n<1?-s[t]*n:-n:Ud.NumberExt.isPercentage(n)?u=s[t]*parseFloat(n)/100:u=0,a[r]=-(s[r]+u),a}}var yi={};Object.defineProperty(yi,"__esModule",{value:!0});yi.style=void 0;const el=$;yi.style={qualify:el.ObjectExt.isPlainObject,set(r,{elem:t}){el.Dom.css(t,r)}};var bi={};Object.defineProperty(bi,"__esModule",{value:!0});bi.html=void 0;bi.html={set(r,{elem:t}){t.innerHTML=`${r}`}};var vi={};Object.defineProperty(vi,"__esModule",{value:!0});vi.filter=void 0;const Xd=$;vi.filter={qualify:Xd.ObjectExt.isPlainObject,set(r,{view:t}){return`url(#${t.graph.defineFilter(r)})`}};var wi={};Object.defineProperty(wi,"__esModule",{value:!0});wi.port=void 0;wi.port={set(r){return r!=null&&typeof r=="object"&&r.id?r.id:r}};var le={},Rs={},nl={},He={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.normalize=void 0;const Yd=I;function Kd(r,t,e){let n,s;typeof t=="object"?(n=t.x,s=t.y):(n=t,s=e);const a=Yd.Path.parse(r),u=a.bbox();if(u){let h=-u.height/2-u.y,d=-u.width/2-u.x;typeof n=="number"&&(d-=n),typeof s=="number"&&(h-=s),a.translate(d,h)}return a.serialize()}Lt.normalize=Kd;var il=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(He,"__esModule",{value:!0});He.classic=He.block=void 0;const Zd=I,Qd=$,tf=Lt,ef=r=>{var{size:t,width:e,height:n,offset:s,open:a}=r,u=il(r,["size","width","height","offset","open"]);return rl({size:t,width:e,height:n,offset:s},a===!0,!0,void 0,u)};He.block=ef;const nf=r=>{var{size:t,width:e,height:n,offset:s,factor:a}=r,u=il(r,["size","width","height","offset","factor"]);return rl({size:t,width:e,height:n,offset:s},!1,!1,a,u)};He.classic=nf;function rl(r,t,e,n=3/4,s={}){const a=r.size||10,u=r.width||a,h=r.height||a,d=new Zd.Path,c={};if(t)d.moveTo(u,0).lineTo(0,h/2).lineTo(u,h),c.fill="none";else{if(d.moveTo(0,h/2),d.lineTo(u,0),!e){const i=Qd.NumberExt.clamp(n,0,1);d.lineTo(u*i,h/2)}d.lineTo(u,h),d.close()}return Object.assign(Object.assign(Object.assign({},c),s),{tagName:"path",d:(0,tf.normalize)(d.serialize(),{x:r.offset!=null?r.offset:-u/2})})}var xi={},rf=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(xi,"__esModule",{value:!0});xi.diamond=void 0;const sf=I,of=Lt,af=r=>{var{size:t,width:e,height:n,offset:s}=r,a=rf(r,["size","width","height","offset"]);const u=t||10,h=e||u,d=n||u,c=new sf.Path;return c.moveTo(0,d/2).lineTo(h/2,0).lineTo(h,d/2).lineTo(h/2,d).close(),Object.assign(Object.assign({},a),{tagName:"path",d:(0,of.normalize)(c.serialize(),s==null?-h/2:s)})};xi.diamond=af;var Pi={},lf=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Pi,"__esModule",{value:!0});Pi.path=void 0;const cf=Lt,uf=r=>{var{d:t,offsetX:e,offsetY:n}=r,s=lf(r,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},s),{tagName:"path",d:(0,cf.normalize)(t,e,n)})};Pi.path=uf;var Oi={},hf=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.cross=void 0;const df=I,ff=Lt,gf=r=>{var{size:t,width:e,height:n,offset:s}=r,a=hf(r,["size","width","height","offset"]);const u=t||10,h=e||u,d=n||u,c=new df.Path;return c.moveTo(0,0).lineTo(h,d).moveTo(0,d).lineTo(h,0),Object.assign(Object.assign({},a),{tagName:"path",fill:"none",d:(0,ff.normalize)(c.serialize(),s||-h/2)})};Oi.cross=gf;var Ei={},pf=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.async=void 0;const mf=I,yf=Lt,bf=r=>{var{width:t,height:e,offset:n,open:s,flip:a}=r,u=pf(r,["width","height","offset","open","flip"]);let h=e||6;const d=t||10,c=s===!0,i=a===!0,o=Object.assign(Object.assign({},u),{tagName:"path"});i&&(h=-h);const l=new mf.Path;return l.moveTo(0,h).lineTo(d,0),c?o.fill="none":(l.lineTo(d,h),l.close()),o.d=(0,yf.normalize)(l.serialize(),{x:n||-d/2,y:h/2}),o};Ei.async=bf;var sl={};(function(r){var t=E&&E.__rest||function(u,h){var d={};for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&h.indexOf(c)<0&&(d[c]=u[c]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,c=Object.getOwnPropertySymbols(u);i<c.length;i++)h.indexOf(c[i])<0&&Object.prototype.propertyIsEnumerable.call(u,c[i])&&(d[c[i]]=u[c[i]]);return d};Object.defineProperty(r,"__esModule",{value:!0}),r.circlePlus=r.circle=void 0;const e=I,n=Lt,s=u=>{var{r:h}=u,d=t(u,["r"]);const c=h||5;return Object.assign(Object.assign({cx:c},d),{tagName:"circle",r:c})};r.circle=s;const a=u=>{var{r:h}=u,d=t(u,["r"]);const c=h||5,i=new e.Path;return i.moveTo(c,0).lineTo(c,c*2),i.moveTo(0,c).lineTo(c*2,c),{children:[Object.assign(Object.assign({},(0,r.circle)({r:c})),{fill:"none"}),Object.assign(Object.assign({},d),{tagName:"path",d:(0,n.normalize)(i.serialize(),-c)})]}};r.circlePlus=a})(sl);var Ci={},vf=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Ci,"__esModule",{value:!0});Ci.ellipse=void 0;const wf=r=>{var{rx:t,ry:e}=r,n=vf(r,["rx","ry"]);const s=t||5,a=e||5;return Object.assign(Object.assign({cx:s},n),{tagName:"ellipse",rx:s,ry:a})};Ci.ellipse=wf;(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(He,r),e(xi,r),e(Pi,r),e(Oi,r),e(Ei,r),e(sl,r),e(Ci,r)})(nl);(function(r){var t=E&&E.__createBinding||(Object.create?function(h,d,c,i){i===void 0&&(i=c);var o=Object.getOwnPropertyDescriptor(d,c);(!o||("get"in o?!d.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return d[c]}}),Object.defineProperty(h,i,o)}:function(h,d,c,i){i===void 0&&(i=c),h[i]=d[c]}),e=E&&E.__setModuleDefault||(Object.create?function(h,d){Object.defineProperty(h,"default",{enumerable:!0,value:d})}:function(h,d){h.default=d}),n=E&&E.__importStar||function(h){if(h&&h.__esModule)return h;var d={};if(h!=null)for(var c in h)c!=="default"&&Object.prototype.hasOwnProperty.call(h,c)&&t(d,h,c);return e(d,h),d};Object.defineProperty(r,"__esModule",{value:!0}),r.Marker=void 0;const s=ot,a=n(nl),u=Lt;(function(h){h.presets=a,h.registry=s.Registry.create({type:"marker"}),h.registry.register(h.presets,!0)})(r.Marker||(r.Marker={})),function(h){h.normalize=u.normalize}(r.Marker||(r.Marker={}))})(Rs);var xf=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(le,"__esModule",{value:!0});le.vertexMarker=le.targetMarker=le.sourceMarker=void 0;const Pf=$,ol=Rs;function Is(r){return typeof r=="string"||Pf.ObjectExt.isPlainObject(r)}le.sourceMarker={qualify:Is,set(r,{view:t,attrs:e}){return Vs("marker-start",r,t,e)}};le.targetMarker={qualify:Is,set(r,{view:t,attrs:e}){return Vs("marker-end",r,t,e,{transform:"rotate(180)"})}};le.vertexMarker={qualify:Is,set(r,{view:t,attrs:e}){return Vs("marker-mid",r,t,e)}};function Vs(r,t,e,n,s={}){const a=typeof t=="string"?{name:t}:t,{name:u,args:h}=a,d=xf(a,["name","args"]);let c=d;if(u&&typeof u=="string"){const o=ol.Marker.registry.get(u);if(o)c=o(Object.assign(Object.assign({},d),h));else return ol.Marker.registry.onNotFound(u)}const i=Object.assign(Object.assign(Object.assign({},Of(n,r)),s),c);return{[r]:`url(#${e.graph.defineMarker(i)})`}}function Of(r,t){const e={},n=r.stroke;typeof n=="string"&&(e.stroke=n,e.fill=n);let s=r.strokeOpacity;if(s==null&&(s=r["stroke-opacity"]),s==null&&(s=r.opacity),s!=null&&(e["stroke-opacity"]=s,e["fill-opacity"]=s),t!=="marker-mid"){const a=parseFloat(r.strokeWidth||r["stroke-width"]);if(Number.isFinite(a)&&a>1){const u=Math.ceil(a/2);e.refX=t==="marker-start"?u:-u}}return e}var al={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.atConnectionRatio=r.atConnectionLength=r.atConnectionRatioIgnoreGradient=r.atConnectionRatioKeepGradient=r.atConnectionLengthIgnoreGradient=r.atConnectionLengthKeepGradient=r.connection=void 0;const t=(n,{view:s})=>s.cell.isEdge();r.connection={qualify:t,set(n,s){var a,u,h,d;const c=s.view,i=n.reverse||!1,o=n.stubs||0;let l;if(Number.isFinite(o)&&o!==0)if(i){let f,g;const p=c.getConnectionLength()||0;o<0?(f=(p+o)/2,g=-o):(f=o,g=p-o*2);const m=c.getConnection();l=(d=(h=(u=(a=m==null?void 0:m.divideAtLength(f))===null||a===void 0?void 0:a[1])===null||u===void 0?void 0:u.divideAtLength(g))===null||h===void 0?void 0:h[0])===null||d===void 0?void 0:d.serialize()}else{let f;o<0?f=((c.getConnectionLength()||0)+o)/2:f=o;const g=c.getConnection();if(g){const p=g.divideAtLength(f),m=g.divideAtLength(-f);p&&m&&(l=`${p[0].serialize()} ${m[1].serialize()}`)}}return{d:l||c.getConnectionPathData()}}},r.atConnectionLengthKeepGradient={qualify:t,set:e("getTangentAtLength",{rotate:!0})},r.atConnectionLengthIgnoreGradient={qualify:t,set:e("getTangentAtLength",{rotate:!1})},r.atConnectionRatioKeepGradient={qualify:t,set:e("getTangentAtRatio",{rotate:!0})},r.atConnectionRatioIgnoreGradient={qualify:t,set:e("getTangentAtRatio",{rotate:!1})},r.atConnectionLength=r.atConnectionLengthKeepGradient,r.atConnectionRatio=r.atConnectionRatioKeepGradient;function e(n,s){const a={x:1,y:0};return(u,h)=>{let d,c;const i=h.view,o=i[n](Number(u));return o?(c=s.rotate?o.vector().vectorAngle(a):0,d=o.start):(d=i.path.start,c=0),c===0?{transform:`translate(${d.x},${d.y}')`}:{transform:`translate(${d.x},${d.y}') rotate(${c})`}}}})(al);(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Ka,r),e(gi,r),e(pi,r),e(Za,r),e(mi,r),e(ae,r),e(yi,r),e(bi,r),e(vi,r),e(wi,r),e(le,r),e(al,r)})(Ya);(function(r){var t=E&&E.__createBinding||(Object.create?function(d,c,i,o){o===void 0&&(o=i);var l=Object.getOwnPropertyDescriptor(c,i);(!l||("get"in l?!c.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return c[i]}}),Object.defineProperty(d,o,l)}:function(d,c,i,o){o===void 0&&(o=i),d[o]=c[i]}),e=E&&E.__setModuleDefault||(Object.create?function(d,c){Object.defineProperty(d,"default",{enumerable:!0,value:c})}:function(d,c){d.default=c}),n=E&&E.__importStar||function(d){if(d&&d.__esModule)return d;var c={};if(d!=null)for(var i in d)i!=="default"&&Object.prototype.hasOwnProperty.call(d,i)&&t(c,d,i);return e(c,d),c};Object.defineProperty(r,"__esModule",{value:!0}),r.Attr=void 0;const s=$,a=ot,u=fi,h=n(Ya);(function(d){function c(i,o,l){return!!(i!=null&&(typeof i=="string"||typeof i.qualify!="function"||s.FunctionExt.call(i.qualify,this,o,l)))}d.isValidDefinition=c})(r.Attr||(r.Attr={})),function(d){d.presets=Object.assign(Object.assign({},u.raw),h),d.registry=a.Registry.create({type:"attribute definition"}),d.registry.register(d.presets,!0)}(r.Attr||(r.Attr={}))})(Bs);var ll={},cl={},_i={},$t={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Config=void 0,r.Config={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix(t){return`${r.Config.prefixCls}-${t}`}}})($t);Object.defineProperty(_i,"__esModule",{value:!0});_i.className=void 0;const ul=$,Ef=$t,hl=Ef.Config.prefix("highlighted");_i.className={highlight(r,t,e){const n=e&&e.className||hl;ul.Dom.addClass(t,n)},unhighlight(r,t,e){const n=e&&e.className||hl;ul.Dom.removeClass(t,n)}};var Si={};Object.defineProperty(Si,"__esModule",{value:!0});Si.opacity=void 0;const dl=$,Cf=$t,fl=Cf.Config.prefix("highlight-opacity");Si.opacity={highlight(r,t){dl.Dom.addClass(t,fl)},unhighlight(r,t){dl.Dom.removeClass(t,fl)}};var Mi={},Bt={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=void 0;const t=I,e=$,n=Lt;(function(s){s.normalizeMarker=n.normalize;function a(m,y){const b=e.Dom.createSVGPoint(m.x,m.y).matrixTransform(y);return new t.Point(b.x,b.y)}s.transformPoint=a;function u(m,y){return new t.Line(a(m.start,y),a(m.end,y))}s.transformLine=u;function h(m,y){let b=m instanceof t.Polyline?m.points:m;return Array.isArray(b)||(b=[]),new t.Polyline(b.map(v=>a(v,y)))}s.transformPolyline=h;function d(m,y){const v=e.Dom.createSvgElement("svg").createSVGPoint();v.x=m.x,v.y=m.y;const x=v.matrixTransform(y);v.x=m.x+m.width,v.y=m.y;const P=v.matrixTransform(y);v.x=m.x+m.width,v.y=m.y+m.height;const C=v.matrixTransform(y);v.x=m.x,v.y=m.y+m.height;const _=v.matrixTransform(y),A=Math.min(x.x,P.x,C.x,_.x),S=Math.max(x.x,P.x,C.x,_.x),w=Math.min(x.y,P.y,C.y,_.y),O=Math.max(x.y,P.y,C.y,_.y);return new t.Rectangle(A,w,S-A,O-w)}s.transformRectangle=d;function c(m,y,b){let v;const x=m.ownerSVGElement;if(!x)return new t.Rectangle(0,0,0,0);try{v=m.getBBox()}catch{v={x:m.clientLeft,y:m.clientTop,width:m.clientWidth,height:m.clientHeight}}if(y)return t.Rectangle.create(v);const P=e.Dom.getTransformToElement(m,b||x);return d(v,P)}s.bbox=c;function i(m,y={}){let b;if(!m.ownerSVGElement||!e.Dom.isSVGGraphicsElement(m)){if(e.Dom.isHTMLElement(m)){const{left:C,top:_,width:A,height:S}=o(m);return new t.Rectangle(C,_,A,S)}return new t.Rectangle(0,0,0,0)}let x=y.target;if(!y.recursive){try{b=m.getBBox()}catch{b={x:m.clientLeft,y:m.clientTop,width:m.clientWidth,height:m.clientHeight}}if(!x)return t.Rectangle.create(b);const C=e.Dom.getTransformToElement(m,x);return d(b,C)}{const C=m.childNodes,_=C.length;if(_===0)return i(m,{target:x});x||(x=m);for(let A=0;A<_;A+=1){const S=C[A];let w;S.childNodes.length===0?w=i(S,{target:x}):w=i(S,{target:x,recursive:!0}),b?b=b.union(w):b=w}return b}}s.getBBox=i;function o(m){let y=0,b=0,v=0,x=0;if(m){let P=m;for(;P;)y+=P.offsetLeft,b+=P.offsetTop,P=P.offsetParent,P&&(y+=parseInt(e.Dom.getComputedStyle(P,"borderLeft"),10),b+=parseInt(e.Dom.getComputedStyle(P,"borderTop"),10));v=m.offsetWidth,x=m.offsetHeight}return{left:y,top:b,width:v,height:x}}s.getBoundingOffsetRect=o;function l(m){const y=b=>{const v=m.getAttribute(b),x=v?parseFloat(v):0;return Number.isNaN(x)?0:x};switch(m instanceof SVGElement&&m.nodeName.toLowerCase()){case"rect":return new t.Rectangle(y("x"),y("y"),y("width"),y("height"));case"circle":return new t.Ellipse(y("cx"),y("cy"),y("r"),y("r"));case"ellipse":return new t.Ellipse(y("cx"),y("cy"),y("rx"),y("ry"));case"polyline":{const b=e.Dom.getPointsFromSvgElement(m);return new t.Polyline(b)}case"polygon":{const b=e.Dom.getPointsFromSvgElement(m);return b.length>1&&b.push(b[0]),new t.Polyline(b)}case"path":{let b=m.getAttribute("d");return t.Path.isValid(b)||(b=t.Path.normalize(b)),t.Path.parse(b)}case"line":return new t.Line(y("x1"),y("y1"),y("x2"),y("y2"))}return i(m)}s.toGeometryShape=l;function f(m,y,b,v){const x=t.Point.create(y),P=t.Point.create(b);v||(v=m instanceof SVGSVGElement?m:m.ownerSVGElement);const C=e.Dom.scale(m);m.setAttribute("transform","");const _=i(m,{target:v}).scale(C.sx,C.sy),A=e.Dom.createSVGTransform();A.setTranslate(-_.x-_.width/2,-_.y-_.height/2);const S=e.Dom.createSVGTransform(),w=x.angleBetween(P,x.clone().translate(1,0));w&&S.setRotate(w,0,0);const O=e.Dom.createSVGTransform(),M=x.clone().move(P,_.width/2);O.setTranslate(2*x.x-M.x,2*x.y-M.y);const T=e.Dom.getTransformToElement(m,v),j=e.Dom.createSVGTransform();j.setMatrix(O.matrix.multiply(S.matrix.multiply(A.matrix.multiply(T.scale(C.sx,C.sy))))),m.setAttribute("transform",e.Dom.matrixToTransformString(j.matrix))}s.translateAndAutoOrient=f;function g(m){if(m==null)return null;let y=m;do{let b=y.tagName;if(typeof b!="string")return null;if(b=b.toUpperCase(),e.Dom.hasClass(y,"x6-port"))y=y.nextElementSibling;else if(b==="G")y=y.firstElementChild;else if(b==="TITLE")y=y.nextElementSibling;else break}while(y);return y}s.findShapeNode=g;function p(m){const y=g(m);if(!e.Dom.isSVGGraphicsElement(y)){if(e.Dom.isHTMLElement(m)){const{left:x,top:P,width:C,height:_}=o(m);return new t.Rectangle(x,P,C,_)}return new t.Rectangle(0,0,0,0)}return l(y).bbox()||t.Rectangle.create()}s.getBBoxV2=p})(r.Util||(r.Util={}))})(Bt);Object.defineProperty(Mi,"__esModule",{value:!0});Mi.stroke=void 0;const St=$,_f=$t,Fs=Bt,Sf={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}};Mi.stroke={highlight(r,t,e){const n=ce.getHighlighterId(t,e);if(ce.hasCache(n))return;e=St.ObjectExt.defaultsDeep({},e,Sf);const s=St.Vector.create(t);let a,u;try{a=s.toPathData()}catch{u=Fs.Util.bbox(s.node,!0),a=St.Dom.rectToPathData(Object.assign(Object.assign({},e),u))}const h=St.Dom.createSvgElement("path");if(St.Dom.attr(h,Object.assign({d:a,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},e.attrs?St.Dom.kebablizeAttrs(e.attrs):null)),r.isEdgeElement(t))St.Dom.attr(h,"d",r.getConnectionPathData());else{let i=s.getTransformToElement(r.container);const o=e.padding;if(o){u==null&&(u=Fs.Util.bbox(s.node,!0));const l=u.x+u.width/2,f=u.y+u.height/2;u=Fs.Util.transformRectangle(u,i);const g=Math.max(u.width,1),p=Math.max(u.height,1),m=(g+o)/g,y=(p+o)/p,b=St.Dom.createSVGMatrix({a:m,b:0,c:0,d:y,e:l-m*l,f:f-y*f});i=i.multiply(b)}St.Dom.transform(h,i)}St.Dom.addClass(h,_f.Config.prefix("highlight-stroke"));const d=r.cell,c=()=>ce.removeHighlighter(n);d.on("removed",c),d.model&&d.model.on("reseted",c),r.container.appendChild(h),ce.setCache(n,h)},unhighlight(r,t,e){ce.removeHighlighter(ce.getHighlighterId(t,e))}};var ce;(function(r){function t(u,h){return St.Dom.ensureId(u),u.id+JSON.stringify(h)}r.getHighlighterId=t;const e={};function n(u,h){e[u]=h}r.setCache=n;function s(u){return e[u]!=null}r.hasCache=s;function a(u){const h=e[u];h&&(St.Dom.remove(h),delete e[u])}r.removeHighlighter=a})(ce||(ce={}));(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(_i,r),e(Si,r),e(Mi,r)})(cl);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.Highlighter=void 0;const s=ot,a=n(cl);(function(u){function h(d,c){if(typeof c.highlight!="function")throw new Error(`Highlighter '${d}' is missing required \`highlight()\` method`);if(typeof c.unhighlight!="function")throw new Error(`Highlighter '${d}' is missing required \`unhighlight()\` method`)}u.check=h})(r.Highlighter||(r.Highlighter={})),function(u){u.presets=a,u.registry=s.Registry.create({type:"highlighter"}),u.registry.register(u.presets,!0)}(r.Highlighter||(r.Highlighter={}))})(ll);var gl={},pl={},Ai={},ue={};Object.defineProperty(ue,"__esModule",{value:!0});ue.toResult=ue.normalizePoint=void 0;const ml=$,Mf=I;function Af(r,t={}){return new Mf.Point(ml.NumberExt.normalizePercentage(t.x,r.width),ml.NumberExt.normalizePercentage(t.y,r.height))}ue.normalizePoint=Af;function Nf(r,t,e){return Object.assign({angle:t,position:r.toJSON()},e)}ue.toResult=Nf;Object.defineProperty(Ai,"__esModule",{value:!0});Ai.absolute=void 0;const yl=ue,Tf=(r,t)=>r.map(({x:e,y:n,angle:s})=>(0,yl.toResult)((0,yl.normalizePoint)(t,{x:e,y:n}),s||0));Ai.absolute=Tf;var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.ellipseSpread=Ge.ellipse=void 0;const jf=I,Df=ue,Lf=(r,t,e)=>{const n=e.start||0,s=e.step||20;return bl(r,t,n,(a,u)=>(a+.5-u/2)*s)};Ge.ellipse=Lf;const $f=(r,t,e)=>{const n=e.start||0,s=e.step||360/r.length;return bl(r,t,n,a=>a*s)};Ge.ellipseSpread=$f;function bl(r,t,e,n){const s=t.getCenter(),a=t.getTopCenter(),u=t.width/t.height,h=jf.Ellipse.fromRect(t),d=r.length;return r.map((c,i)=>{const o=e+n(i,d),l=a.clone().rotate(-o,s).scale(u,1,s),f=c.compensateRotate?-h.tangentTheta(l):0;return(c.dx||c.dy)&&l.translate(c.dx||0,c.dy||0),c.dr&&l.move(s,c.dr),(0,Df.toResult)(l.round(),f,c)})}var Mt={},Bf=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.bottom=Mt.top=Mt.right=Mt.left=Mt.line=void 0;const Rf=I,zs=ue,If=(r,t,e)=>{const n=(0,zs.normalizePoint)(t,e.start||t.getOrigin()),s=(0,zs.normalizePoint)(t,e.end||t.getCorner());return bn(r,n,s,e)};Mt.line=If;const Vf=(r,t,e)=>bn(r,t.getTopLeft(),t.getBottomLeft(),e);Mt.left=Vf;const Ff=(r,t,e)=>bn(r,t.getTopRight(),t.getBottomRight(),e);Mt.right=Ff;const zf=(r,t,e)=>bn(r,t.getTopLeft(),t.getTopRight(),e);Mt.top=zf;const kf=(r,t,e)=>bn(r,t.getBottomLeft(),t.getBottomRight(),e);Mt.bottom=kf;function bn(r,t,e,n){const s=new Rf.Line(t,e),a=r.length;return r.map((u,h)=>{var{strict:d}=u,c=Bf(u,["strict"]);const i=d||n.strict?(h+1)/(a+1):(h+.5)/a,o=s.pointAt(i);return(c.dx||c.dy)&&o.translate(c.dx||0,c.dy||0),(0,zs.toResult)(o.round(),0,c)})}(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Ai,r),e(Ge,r),e(Mt,r)})(pl);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.PortLayout=void 0;const s=ot,a=n(pl);(function(u){u.presets=a,u.registry=s.Registry.create({type:"port layout"}),u.registry.register(u.presets,!0)})(r.PortLayout||(r.PortLayout={}))})(gl);var vl={},wl={},At={},qe={};Object.defineProperty(qe,"__esModule",{value:!0});qe.toResult=void 0;const Hf=$,Gf={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function qf(r,t){const{x:e,y:n,angle:s,attrs:a}=t||{};return Hf.ObjectExt.defaultsDeep({},{angle:s,attrs:a,position:{x:e,y:n}},r,Gf)}qe.toResult=qf;Object.defineProperty(At,"__esModule",{value:!0});At.bottom=At.top=At.right=At.left=At.manual=void 0;const vn=qe,Wf=(r,t,e)=>(0,vn.toResult)({position:t.getTopLeft()},e);At.manual=Wf;const Uf=(r,t,e)=>(0,vn.toResult)({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},e);At.left=Uf;const Jf=(r,t,e)=>(0,vn.toResult)({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},e);At.right=Jf;const Xf=(r,t,e)=>(0,vn.toResult)({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},e);At.top=Xf;const Yf=(r,t,e)=>(0,vn.toResult)({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},e);At.bottom=Yf;var qt={};Object.defineProperty(qt,"__esModule",{value:!0});qt.insideOriented=qt.inside=qt.outsideOriented=qt.outside=void 0;const xl=qe,Kf=(r,t,e)=>Pl(r,t,!1,e);qt.outside=Kf;const Zf=(r,t,e)=>Pl(r,t,!0,e);qt.outsideOriented=Zf;const Qf=(r,t,e)=>Ol(r,t,!1,e);qt.inside=Qf;const tg=(r,t,e)=>Ol(r,t,!0,e);qt.insideOriented=tg;function Pl(r,t,e,n){const s=n.offset!=null?n.offset:15,a=t.getCenter().theta(r),u=El(t);let h,d,c,i,o=0;return a<u[1]||a>u[2]?(h=".3em",d=s,c=0,i="start"):a<u[0]?(h="0",d=0,c=-s,e?(o=-90,i="start"):i="middle"):a<u[3]?(h=".3em",d=-s,c=0,i="end"):(h=".6em",d=0,c=s,e?(o=90,i="start"):i="middle"),(0,xl.toResult)({position:{x:Math.round(d),y:Math.round(c)},angle:o,attrs:{".":{y:h,"text-anchor":i}}},n)}function Ol(r,t,e,n){const s=n.offset!=null?n.offset:15,a=t.getCenter().theta(r),u=El(t);let h,d,c,i,o=0;return a<u[1]||a>u[2]?(h=".3em",d=-s,c=0,i="end"):a<u[0]?(h=".6em",d=0,c=s,e?(o=90,i="start"):i="middle"):a<u[3]?(h=".3em",d=s,c=0,i="start"):(h="0em",d=0,c=-s,e?(o=-90,i="start"):i="middle"),(0,xl.toResult)({position:{x:Math.round(d),y:Math.round(c)},angle:o,attrs:{".":{y:h,"text-anchor":i}}},n)}function El(r){const t=r.getCenter(),e=t.theta(r.getTopLeft()),n=t.theta(r.getBottomLeft()),s=t.theta(r.getBottomRight()),a=t.theta(r.getTopRight());return[e,a,s,n]}var We={};Object.defineProperty(We,"__esModule",{value:!0});We.radialOriented=We.radial=void 0;const eg=I,ng=qe,ig=(r,t,e)=>Cl(r.diff(t.getCenter()),!1,e);We.radial=ig;const rg=(r,t,e)=>Cl(r.diff(t.getCenter()),!0,e);We.radialOriented=rg;function Cl(r,t,e){const n=e.offset!=null?e.offset:20,s=new eg.Point(0,0),a=-r.theta(s),u=r.clone().move(s,n).diff(r).round();let h=".3em",d,c=a;return(a+90)%180==0?(d=t?"end":"middle",!t&&a===-270&&(h="0em")):a>-270&&a<-90?(d="start",c=a-180):d="end",(0,ng.toResult)({position:u.round().toJSON(),angle:t?c:0,attrs:{".":{y:h,"text-anchor":d}}},e)}(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(At,r),e(qt,r),e(We,r)})(wl);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.PortLabelLayout=void 0;const s=ot,a=n(wl);(function(u){u.presets=a,u.registry=s.Registry.create({type:"port label layout"}),u.registry.register(u.presets,!0)})(r.PortLabelLayout||(r.PortLabelLayout={}))})(vl);var ks={},Rt={},Pe={};(function(r){var t=E&&E.__decorate||function(u,h,d,c){var i=arguments.length,o=i<3?h:c===null?c=Object.getOwnPropertyDescriptor(h,d):c,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(u,h,d,c);else for(var f=u.length-1;f>=0;f--)(l=u[f])&&(o=(i<3?l(o):i>3?l(h,d,o):l(h,d))||o);return i>3&&o&&Object.defineProperty(h,d,o),o};Object.defineProperty(r,"__esModule",{value:!0}),r.View=void 0;const e=$,n=$t;class s extends e.Basecoat{get priority(){return 2}get disposeContainer(){return!0}constructor(){super();this.cid=a.uniqueId(),s.views[this.cid]=this}confirmUpdate(h,d){return 0}empty(h=this.container){return e.Dom.empty(h),this}unmount(h=this.container){return e.Dom.remove(h),this}remove(h=this.container){return h===this.container?(this.removeEventListeners(document),this.onRemove(),delete s.views[this.cid],this.disposeContainer&&this.unmount(h)):this.unmount(h),this}onRemove(){}setClass(h,d=this.container){d.classList.value=Array.isArray(h)?h.join(" "):h}addClass(h,d=this.container){return e.Dom.addClass(d,Array.isArray(h)?h.join(" "):h),this}removeClass(h,d=this.container){return e.Dom.removeClass(d,Array.isArray(h)?h.join(" "):h),this}setStyle(h,d=this.container){return e.Dom.css(d,h),this}setAttrs(h,d=this.container){return h!=null&&d!=null&&e.Dom.attr(d,h),this}findAttr(h,d=this.container){let c=d;for(;c&&c.nodeType===1;){const i=c.getAttribute(h);if(i!=null)return i;if(c===this.container)return null;c=c.parentNode}return null}find(h,d=this.container,c=this.selectors){return s.find(h,d,c).elems}findOne(h,d=this.container,c=this.selectors){const i=this.find(h,d,c);return i.length>0?i[0]:null}findByAttr(h,d=this.container){let c=d;for(;c&&c.getAttribute;){const i=c.getAttribute(h);if((i!=null||c===this.container)&&i!=="false")return c;c=c.parentNode}return null}getSelector(h,d){let c;if(h===this.container)return typeof d=="string"&&(c=`> ${d}`),c;if(h){const i=e.Dom.index(h)+1;c=`${h.tagName.toLowerCase()}:nth-child(${i})`,d&&(c+=` > ${d}`),c=this.getSelector(h.parentNode,c)}return c}prefixClassName(h){return n.Config.prefix(h)}delegateEvents(h,d){if(h==null)return this;d||this.undelegateEvents();const c=/^(\S+)\s*(.*)$/;return Object.keys(h).forEach(i=>{const o=i.match(c);if(o==null)return;const l=this.getEventHandler(h[i]);typeof l=="function"&&this.delegateEvent(o[1],o[2],l)}),this}undelegateEvents(){return e.Dom.Event.off(this.container,this.getEventNamespace()),this}delegateDocumentEvents(h,d){return this.addEventListeners(document,h,d),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(h,d,c){return e.Dom.Event.on(this.container,h+this.getEventNamespace(),d,c),this}undelegateEvent(h,d,c){const i=h+this.getEventNamespace();return d==null?e.Dom.Event.off(this.container,i):typeof d=="string"?e.Dom.Event.off(this.container,i,d,c):e.Dom.Event.off(this.container,i,d),this}addEventListeners(h,d,c){if(d==null)return this;const i=this.getEventNamespace();return Object.keys(d).forEach(o=>{const l=this.getEventHandler(d[o]);typeof l=="function"&&e.Dom.Event.on(h,o+i,c,l)}),this}removeEventListeners(h){return h!=null&&e.Dom.Event.off(h,this.getEventNamespace()),this}getEventNamespace(){return`.${n.Config.prefixCls}-event-${this.cid}`}getEventHandler(h){let d;if(typeof h=="string"){const c=this[h];typeof c=="function"&&(d=(...i)=>c.call(this,...i))}else d=(...c)=>h.call(this,...c);return d}getEventTarget(h,d={}){const{target:c,type:i,clientX:o=0,clientY:l=0}=h;return d.fromPoint||i==="touchmove"||i==="touchend"?document.elementFromPoint(o,l):c}stopPropagation(h){return this.setEventData(h,{propagationStopped:!0}),this}isPropagationStopped(h){return this.getEventData(h).propagationStopped===!0}getEventData(h){return this.eventData(h)}setEventData(h,d){return this.eventData(h,d)}eventData(h,d){if(h==null)throw new TypeError("Event object required");let c=h.data;const i=`__${this.cid}__`;return d==null?c==null?{}:c[i]||{}:(c==null&&(c=h.data={}),c[i]==null?c[i]=Object.assign({},d):c[i]=Object.assign(Object.assign({},c[i]),d),c[i])}normalizeEvent(h){return s.normalizeEvent(h)}dispose(){this.remove()}}t([s.dispose()],s.prototype,"dispose",null),r.View=s,function(u){function h(i,o){return o?e.Dom.createSvgElement(i||"g"):e.Dom.createElementNS(i||"div")}u.createElement=h;function d(i,o,l){if(!i||i===".")return{elems:[o]};if(l){const f=l[i];if(f)return{elems:Array.isArray(f)?f:[f]}}if(n.Config.useCSSSelector){const f=i.includes(">")?`:scope ${i}`:i;return{isCSSSelector:!0,elems:Array.prototype.slice.call(o.querySelectorAll(f))}}return{elems:[]}}u.find=d;function c(i){let o=i;const l=i.originalEvent,f=l&&l.changedTouches&&l.changedTouches[0];if(f){for(const g in i)f[g]===void 0&&(f[g]=i[g]);o=f}return o}u.normalizeEvent=c}(s=r.View||(r.View={})),function(u){u.views={};function h(d){return u.views[d]||null}u.getView=h}(s=r.View||(r.View={}));var a;(function(u){let h=0;function d(){const c=`v${h}`;return h+=1,c}u.uniqueId=d})(a||(a={}))})(Pe);var wn={},Ni={};Object.defineProperty(Ni,"__esModule",{value:!0});Ni.Cache=void 0;const Hs=$,_l=Bt;class sg{constructor(t){this.view=t,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new Hs.Dictionary,this.pathCache={}}get(t){return this.elemCache.has(t)||this.elemCache.set(t,{}),this.elemCache.get(t)}getData(t){const e=this.get(t);return e.data||(e.data={}),e.data}getMatrix(t){const e=this.get(t);if(e.matrix==null){const n=this.view.container;e.matrix=Hs.Dom.getTransformToParentElement(t,n)}return Hs.Dom.createSVGMatrix(e.matrix)}getShape(t){const e=this.get(t);return e.shape==null&&(e.shape=_l.Util.toGeometryShape(t)),e.shape.clone()}getBoundingRect(t){const e=this.get(t);return e.boundingRect==null&&(e.boundingRect=_l.Util.getBBoxV2(t)),e.boundingRect.clone()}}Ni.Cache=sg;var Oe={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Markup=void 0;const t=$;(function(e){function n(o){return o!=null&&!s(o)}e.isJSONMarkup=n;function s(o){return o!=null&&typeof o=="string"}e.isStringMarkup=s;function a(o){return o==null||s(o)?o:t.ObjectExt.cloneDeep(o)}e.clone=a;function u(o){return`${o}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}e.sanitize=u;function h(o,l={ns:t.Dom.ns.svg}){const f=document.createDocumentFragment(),g={},p={},m=[{markup:Array.isArray(o)?o:[o],parent:f,ns:l.ns}];for(;m.length>0;){const y=m.pop();let b=y.ns||t.Dom.ns.svg;const v=y.markup,x=y.parent;v.forEach(P=>{const C=P.tagName;if(!C)throw new TypeError("Invalid tagName");P.ns&&(b=P.ns);const _=b?t.Dom.createElementNS(C,b):t.Dom.createElement(C),A=P.attrs;A&&t.Dom.attr(_,t.Dom.kebablizeAttrs(A));const S=P.style;S&&t.Dom.css(_,S);const w=P.className;w!=null&&_.setAttribute("class",Array.isArray(w)?w.join(" "):w),P.textContent&&(_.textContent=P.textContent);const O=P.selector;if(O!=null){if(p[O])throw new TypeError("Selector must be unique");p[O]=_}if(P.groupSelector){let T=P.groupSelector;Array.isArray(T)||(T=[T]),T.forEach(j=>{g[j]||(g[j]=[]),g[j].push(_)})}x.appendChild(_);const M=P.children;Array.isArray(M)&&m.push({ns:b,markup:M,parent:_})})}return Object.keys(g).forEach(y=>{if(p[y])throw new Error("Ambiguous group selector");p[y]=g[y]}),{fragment:f,selectors:p,groups:g}}e.parseJSONMarkup=h;function d(o){return o instanceof SVGElement?t.Dom.createSvgElement("g"):t.Dom.createElement("div")}function c(o){if(s(o)){const p=t.Vector.createVectors(o),m=p.length;if(m===1)return{elem:p[0].node};if(m>1){const y=d(p[0].node);return p.forEach(b=>{y.appendChild(b.node)}),{elem:y}}return{}}const l=h(o),f=l.fragment;let g=null;return f.childNodes.length>1?(g=d(f.firstChild),g.appendChild(f)):g=f.firstChild,{elem:g,selectors:l.selectors}}e.renderMarkup=c;function i(o){const l=t.Vector.createVectors(o),f=document.createDocumentFragment();for(let g=0,p=l.length;g<p;g+=1){const m=l[g].node;f.appendChild(m)}return{fragment:f,selectors:{}}}e.parseLabelStringMarkup=i})(r.Markup||(r.Markup={})),function(e){function n(s,a,u){if(s!=null){let h;const d=s.tagName.toLowerCase();if(s===a)return typeof u=="string"?h=`> ${d} > ${u}`:h=`> ${d}`,h;const c=s.parentNode;if(c&&c.childNodes.length>1){const i=t.Dom.index(s)+1;h=`${d}:nth-child(${i})`}else h=d;return u&&(h+=` > ${u}`),n(s.parentNode,a,h)}return u}e.getSelector=n}(r.Markup||(r.Markup={})),function(e){function n(){return"g"}e.getPortContainerMarkup=n;function s(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}}e.getPortMarkup=s;function a(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}e.getPortLabelMarkup=a}(r.Markup||(r.Markup={})),function(e){function n(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}e.getEdgeMarkup=n}(r.Markup||(r.Markup={})),function(e){function n(s=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:t.Dom.ns.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:t.Dom.ns.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:s?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}e.getForeignObjectMarkup=n}(r.Markup||(r.Markup={}))})(Oe);var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.AttrManager=void 0;const dt=$,Gs=I,og=Bs,ag=Pe,qs=Bt;class lg{constructor(t){this.view=t}get cell(){return this.view.cell}getDefinition(t){return this.cell.getAttrDefinition(t)}processAttrs(t,e){let n,s,a,u;const h=[];return Object.keys(e).forEach(d=>{const c=e[d],i=this.getDefinition(d),o=dt.FunctionExt.call(og.Attr.isValidDefinition,this.view,i,c,{elem:t,attrs:e,cell:this.cell,view:this.view});if(i&&o)typeof i=="string"?(n==null&&(n={}),n[i]=c):c!==null&&h.push({name:d,definition:i});else{n==null&&(n={});const l=dt.Dom.CASE_SENSITIVE_ATTR.includes(d)?d:dt.StringExt.kebabCase(d);n[l]=c}}),h.forEach(({name:d,definition:c})=>{const i=e[d];typeof c.set=="function"&&(s==null&&(s={}),s[d]=i),typeof c.offset=="function"&&(a==null&&(a={}),a[d]=i),typeof c.position=="function"&&(u==null&&(u={}),u[d]=i)}),{raw:e,normal:n,set:s,offset:a,position:u}}mergeProcessedAttrs(t,e){t.set=Object.assign(Object.assign({},t.set),e.set),t.position=Object.assign(Object.assign({},t.position),e.position),t.offset=Object.assign(Object.assign({},t.offset),e.offset);const n=t.normal&&t.normal.transform;n!=null&&e.normal&&(e.normal.transform=n),t.normal=e.normal}findAttrs(t,e,n,s){const a=[],u=new dt.Dictionary;return Object.keys(t).forEach(h=>{const d=t[h];if(!dt.ObjectExt.isPlainObject(d))return;const{isCSSSelector:c,elems:i}=ag.View.find(h,e,s);n[h]=i;for(let o=0,l=i.length;o<l;o+=1){const f=i[o],g=s&&s[h]===f,p=u.get(f);if(p){p.array||(a.push(f),p.array=!0,p.attrs=[p.attrs],p.priority=[p.priority]);const m=p.attrs,y=p.priority;if(g)m.unshift(d),y.unshift(-1);else{const b=dt.ArrayExt.sortedIndex(y,c?-1:l);m.splice(b,0,d),y.splice(b,0,l)}}else u.set(f,{elem:f,attrs:d,priority:g?-1:l,array:!1})}}),a.forEach(h=>{const d=u.get(h),c=d.attrs;d.attrs=c.reduceRight((i,o)=>dt.ObjectExt.merge(i,o),{})}),u}updateRelativeAttrs(t,e,n){const s=e.raw||{};let a=e.normal||{};const u=e.set,h=e.position,d=e.offset,c=()=>({elem:t,cell:this.cell,view:this.view,attrs:s,refBBox:n.clone()});if(u!=null&&Object.keys(u).forEach(m=>{const y=u[m],b=this.getDefinition(m);if(b!=null){const v=dt.FunctionExt.call(b.set,this.view,y,c());typeof v=="object"?a=Object.assign(Object.assign({},a),v):v!=null&&(a[m]=v)}}),t instanceof HTMLElement){this.view.setAttrs(a,t);return}const i=a.transform,o=i?`${i}`:null,l=dt.Dom.transformStringToMatrix(o),f=new Gs.Point(l.e,l.f);i&&(delete a.transform,l.e=0,l.f=0);let g=!1;h!=null&&Object.keys(h).forEach(m=>{const y=h[m],b=this.getDefinition(m);if(b!=null){const v=dt.FunctionExt.call(b.position,this.view,y,c());v!=null&&(g=!0,f.translate(Gs.Point.create(v)))}}),this.view.setAttrs(a,t);let p=!1;if(d!=null){const m=this.view.getBoundingRectOfElement(t);if(m.width>0&&m.height>0){const y=qs.Util.transformRectangle(m,l);Object.keys(d).forEach(b=>{const v=d[b],x=this.getDefinition(b);if(x!=null){const P=dt.FunctionExt.call(x.offset,this.view,v,{elem:t,cell:this.cell,view:this.view,attrs:s,refBBox:y});P!=null&&(p=!0,f.translate(Gs.Point.create(P)))}})}}(i!=null||g||p)&&(f.round(1),l.e=f.x,l.f=f.y,t.setAttribute("transform",dt.Dom.matrixToTransformString(l)))}update(t,e,n){const s={},a=this.findAttrs(n.attrs||e,t,s,n.selectors),u=n.attrs?this.findAttrs(e,t,s,n.selectors):a,h=[];a.each(i=>{const o=i.elem,l=i.attrs,f=this.processAttrs(o,l);if(f.set==null&&f.position==null&&f.offset==null)this.view.setAttrs(f.normal,o);else{const g=u.get(o),p=g?g.attrs:null,m=p&&l.ref==null?p.ref:l.ref;let y;if(m){if(y=(s[m]||this.view.find(m,t,n.selectors))[0],!y)throw new Error(`"${m}" reference does not exist.`)}else y=null;const b={node:o,refNode:y,attributes:p,processedAttributes:f},v=h.findIndex(x=>x.refNode===o);v>-1?h.splice(v,0,b):h.push(b)}});const d=new dt.Dictionary;let c;h.forEach(i=>{const o=i.node,l=i.refNode;let f;const g=l!=null&&n.rotatableNode!=null&&dt.Dom.contains(n.rotatableNode,l);if(l&&(f=d.get(l)),!f){const y=g?n.rotatableNode:t;f=l?qs.Util.getBBox(l,{target:y}):n.rootBBox,l&&d.set(l,f)}let p;n.attrs&&i.attributes?(p=this.processAttrs(o,i.attributes),this.mergeProcessedAttrs(p,i.processedAttributes)):p=i.processedAttributes;let m=f;g&&n.rotatableNode!=null&&!n.rotatableNode.contains(o)&&(c||(c=dt.Dom.transformStringToMatrix(dt.Dom.attr(n.rotatableNode,"transform"))),m=qs.Util.transformRectangle(f,c)),this.updateRelativeAttrs(o,p,m)})}}Ti.AttrManager=lg;var ji={};Object.defineProperty(ji,"__esModule",{value:!0});ji.FlagManager=void 0;class cg{get cell(){return this.view.cell}constructor(t,e,n=[]){this.view=t;const s={},a={};let u=0;Object.keys(e).forEach(d=>{let c=e[d];Array.isArray(c)||(c=[c]),c.forEach(i=>{let o=s[i];o||(u+=1,o=s[i]=1<<u),a[d]|=o})});let h=n;if(Array.isArray(h)||(h=[h]),h.forEach(d=>{s[d]||(u+=1,s[d]=1<<u)}),u>25)throw new Error("Maximum number of flags exceeded.");this.flags=s,this.attrs=a,this.bootstrap=n}getFlag(t){const e=this.flags;return e==null?0:Array.isArray(t)?t.reduce((n,s)=>n|e[s],0):e[t]|0}hasAction(t,e){return t&this.getFlag(e)}removeAction(t,e){return t^t&this.getFlag(e)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let t=0;return this.attrs&&Object.keys(this.attrs).forEach(e=>{this.cell.hasChanged(e)&&(t|=this.attrs[e])}),t}}ji.FlagManager=cg;(function(r){var t=E&&E.__decorate||function(g,p,m,y){var b=arguments.length,v=b<3?p:y===null?y=Object.getOwnPropertyDescriptor(p,m):y,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(g,p,m,y);else for(var P=g.length-1;P>=0;P--)(x=g[P])&&(v=(b<3?x(v):b>3?x(p,m,v):x(p,m))||v);return b>3&&v&&Object.defineProperty(p,m,v),v},e=E&&E.__rest||function(g,p){var m={};for(var y in g)Object.prototype.hasOwnProperty.call(g,y)&&p.indexOf(y)<0&&(m[y]=g[y]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,y=Object.getOwnPropertySymbols(g);b<y.length;b++)p.indexOf(y[b])<0&&Object.prototype.propertyIsEnumerable.call(g,y[b])&&(m[y[b]]=g[y[b]]);return m};Object.defineProperty(r,"__esModule",{value:!0}),r.CellView=void 0;const n=I,s=$,a=ot,u=Pe,h=Ni,d=Oe,c=Rt,i=Ti,o=ji,l=Bt;class f extends u.View{static getDefaults(){return this.defaults}static config(p){this.defaults=this.getOptions(p)}static getOptions(p){const m=(_,A)=>A!=null?s.ArrayExt.uniq([...Array.isArray(_)?_:[_],...Array.isArray(A)?A:[A]]):Array.isArray(_)?[..._]:[_],y=s.ObjectExt.cloneDeep(this.getDefaults()),{bootstrap:b,actions:v,events:x,documentEvents:P}=p,C=e(p,["bootstrap","actions","events","documentEvents"]);return b&&(y.bootstrap=m(y.bootstrap,b)),v&&Object.entries(v).forEach(([_,A])=>{const S=y.actions[_];A&&S?y.actions[_]=m(S,A):A&&(y.actions[_]=m(A))}),x&&(y.events=Object.assign(Object.assign({},y.events),x)),p.documentEvents&&(y.documentEvents=Object.assign(Object.assign({},y.documentEvents),P)),s.ObjectExt.merge(y,C)}get[Symbol.toStringTag](){return f.toStringTag}constructor(p,m={}){super();this.cell=p,this.options=this.ensureOptions(m),this.graph=this.options.graph,this.attr=new i.AttrManager(this),this.flag=new o.FlagManager(this,this.options.actions,this.options.bootstrap),this.cache=new h.Cache(this),this.setContainer(this.ensureContainer()),this.setup(),this.init()}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(p){return this.getConstructor().getOptions(p)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return u.View.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(p){if(this.container!==p){this.undelegateEvents(),this.container=p,this.options.events!=null&&this.delegateEvents(this.options.events);const m=this.getContainerAttrs();m!=null&&this.setAttrs(m,p);const y=this.getContainerStyle();y!=null&&this.setStyle(y,p);const b=this.getContainerClassName();b!=null&&this.addClass(b,p)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(p,m={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(p){return this.flag.getFlag(p)}hasAction(p,m){return this.flag.hasAction(p,m)}removeAction(p,m){return this.flag.removeAction(p,m)}handleAction(p,m,y,b){if(this.hasAction(p,m)){y();const v=[m];return b&&(typeof b=="string"?v.push(b):v.push(...b)),this.removeAction(p,v)}return p}setup(){this.cell.on("changed",this.onCellChanged,this)}onCellChanged({options:p}){this.onAttrsChange(p)}onAttrsChange(p){let m=this.flag.getChangedFlag();p.updated||!m||(p.dirty&&this.hasAction(m,"update")&&(m|=this.getFlag("render")),p.toolId&&(p.async=!1),this.graph!=null&&this.graph.renderer.requestViewUpdate(this,m,p))}parseJSONMarkup(p,m){const y=d.Markup.parseJSONMarkup(p),b=y.selectors,v=this.rootSelector;if(m&&v){if(b[v])throw new Error("Invalid root selector");b[v]=m}return y}can(p){let m=this.graph.options.interacting;if(typeof m=="function"&&(m=s.FunctionExt.call(m,this.graph,this)),typeof m=="object"){let y=m[p];return typeof y=="function"&&(y=s.FunctionExt.call(y,this.graph,this)),y!==!1}return typeof m=="boolean"?m:!1}cleanCache(){return this.cache.clean(),this}getCache(p){return this.cache.get(p)}getDataOfElement(p){return this.cache.getData(p)}getMatrixOfElement(p){return this.cache.getMatrix(p)}getShapeOfElement(p){return this.cache.getShape(p)}getBoundingRectOfElement(p){return this.cache.getBoundingRect(p)}getBBoxOfElement(p){const m=this.getBoundingRectOfElement(p),y=this.getMatrixOfElement(p),b=this.getRootRotatedMatrix(),v=this.getRootTranslatedMatrix();return l.Util.transformRectangle(m,v.multiply(b).multiply(y))}getUnrotatedBBoxOfElement(p){const m=this.getBoundingRectOfElement(p),y=this.getMatrixOfElement(p),b=this.getRootTranslatedMatrix();return l.Util.transformRectangle(m,b.multiply(y))}getBBox(p={}){let m;if(p.useCellGeometry){const y=this.cell,b=y.isNode()?y.getAngle():0;m=y.getBBox().bbox(b)}else m=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(m)}getRootTranslatedMatrix(){const p=this.cell,m=p.isNode()?p.getPosition():{x:0,y:0};return s.Dom.createSVGMatrix().translate(m.x,m.y)}getRootRotatedMatrix(){let p=s.Dom.createSVGMatrix();const m=this.cell,y=m.isNode()?m.getAngle():0;if(y){const b=m.getBBox(),v=b.width/2,x=b.height/2;p=p.translate(v,x).rotate(y).translate(-v,-x)}return p}findMagnet(p=this.container){return this.findByAttr("magnet",p)}updateAttrs(p,m,y={}){y.rootBBox==null&&(y.rootBBox=new n.Rectangle),y.selectors==null&&(y.selectors=this.selectors),this.attr.update(p,m,y)}isEdgeElement(p){return this.cell.isEdge()&&(p==null||p===this.container)}prepareHighlight(p,m={}){const y=p||this.container;return m.partial=y===this.container,y}highlight(p,m={}){const y=this.prepareHighlight(p,m);return this.notify("cell:highlight",{magnet:y,options:m,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:y,options:m,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:y,options:m,view:this,node:this.cell,cell:this.cell}),this}unhighlight(p,m={}){const y=this.prepareHighlight(p,m);return this.notify("cell:unhighlight",{magnet:y,options:m,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:y,options:m,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:y,options:m,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(p,m){}getEdgeTerminal(p,m,y,b,v){const x=this.cell,P=this.findAttr("port",p),C=p.getAttribute("data-selector"),_={cell:x.id};return C!=null&&(_.magnet=C),P!=null?(_.port=P,x.isNode()&&!x.hasPort(P)&&C==null&&(_.selector=this.getSelector(p))):C==null&&this.container!==p&&(_.selector=this.getSelector(p)),_}getMagnetFromEdgeTerminal(p){const m=this.cell,y=this.container,b=p.port;let v=p.magnet,x;return b!=null&&m.isNode()&&m.hasPort(b)?x=this.findPortElem(b,v)||y:(v||(v=p.selector),!v&&b!=null&&(v=`[port="${b}"]`),x=this.findOne(v,y,this.selectors)),x}hasTools(p){const m=this.tools;return m==null?!1:p==null?!0:m.name===p}addTools(p){if(this.removeTools(),p){if(!this.can("toolsAddable"))return this;const m=c.ToolsView.isToolsView(p)?p:new c.ToolsView(p);this.tools=m,m.config({view:this}),m.mount()}return this}updateTools(p={}){return this.tools&&this.tools.update(p),this}removeTools(){return this.tools&&(this.tools.remove(),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const p=this.cell.getTools();return this.addTools(p),this}notify(p,m){return this.trigger(p,m),this.graph.trigger(p,m),this}getEventArgs(p,m,y){const b=this,v=b.cell;return m==null||y==null?{e:p,view:b,cell:v}:{e:p,x:m,y,view:b,cell:v}}onClick(p,m,y){this.notify("cell:click",this.getEventArgs(p,m,y))}onDblClick(p,m,y){this.notify("cell:dblclick",this.getEventArgs(p,m,y))}onContextMenu(p,m,y){this.notify("cell:contextmenu",this.getEventArgs(p,m,y))}onMouseDown(p,m,y){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(p,m,y))}onMouseUp(p,m,y){this.notify("cell:mouseup",this.getEventArgs(p,m,y)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(p,m,y){this.notify("cell:mousemove",this.getEventArgs(p,m,y))}onMouseOver(p){this.notify("cell:mouseover",this.getEventArgs(p))}onMouseOut(p){this.notify("cell:mouseout",this.getEventArgs(p))}onMouseEnter(p){this.notify("cell:mouseenter",this.getEventArgs(p))}onMouseLeave(p){this.notify("cell:mouseleave",this.getEventArgs(p))}onMouseWheel(p,m,y,b){this.notify("cell:mousewheel",Object.assign({delta:b},this.getEventArgs(p,m,y)))}onCustomEvent(p,m,y,b){this.notify("cell:customevent",Object.assign({name:m},this.getEventArgs(p,y,b))),this.notify(m,Object.assign({},this.getEventArgs(p,y,b)))}onMagnetMouseDown(p,m,y,b){}onMagnetDblClick(p,m,y,b){}onMagnetContextMenu(p,m,y,b){}onLabelMouseDown(p,m,y){}checkMouseleave(p){const m=this.getEventTarget(p,{fromPoint:!0}),y=this.graph.findViewByElem(m);y!==this&&(this.onMouseLeave(p),!!y&&y.onMouseEnter(p))}dispose(){this.cell.off("changed",this.onCellChanged,this)}}f.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},t([f.dispose()],f.prototype,"dispose",null),r.CellView=f,function(g){g.Flag=o.FlagManager,g.Attr=i.AttrManager}(f=r.CellView||(r.CellView={})),function(g){g.toStringTag=`X6.${g.name}`;function p(m){if(m==null)return!1;if(m instanceof g)return!0;const y=m[Symbol.toStringTag],b=m;return(y==null||y===g.toStringTag)&&typeof b.isNodeView=="function"&&typeof b.isEdgeView=="function"&&typeof b.confirmUpdate=="function"}g.isCellView=p}(f=r.CellView||(r.CellView={})),function(g){function p(y){return function(b){b.config({priority:y})}}g.priority=p;function m(y){return function(b){b.config({bootstrap:y})}}g.bootstrap=m}(f=r.CellView||(r.CellView={})),function(g){g.registry=a.Registry.create({type:"view"})}(f=r.CellView||(r.CellView={}))})(wn);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ToolsView=void 0;const t=$,e=ks,n=Pe,s=wn,a=Oe;class u extends n.View{get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return u.toStringTag}constructor(d={}){super();this.svgContainer=this.createContainer(!0,d),this.htmlContainer=this.createContainer(!1,d),this.config(d)}createContainer(d,c){const i=d?n.View.createElement("g",!0):n.View.createElement("div",!1);return t.Dom.addClass(i,this.prefixClassName("cell-tools")),c.className&&t.Dom.addClass(i,c.className),i}config(d){if(this.options=Object.assign(Object.assign({},this.options),d),!s.CellView.isCellView(d.view)||d.view===this.cellView)return this;this.cellView=d.view,this.cell.isEdge()?(t.Dom.addClass(this.svgContainer,this.prefixClassName("edge-tools")),t.Dom.addClass(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(t.Dom.addClass(this.svgContainer,this.prefixClassName("node-tools")),t.Dom.addClass(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const c=this.options.items;if(!Array.isArray(c))return this;this.tools=[];const i=[];c.forEach(o=>{u.ToolItem.isToolItem(o)?o.name==="vertices"?i.unshift(o):i.push(o):(typeof o=="object"?o.name:o)==="vertices"?i.unshift(o):i.push(o)});for(let o=0;o<i.length;o+=1){const l=i[o];let f;if(u.ToolItem.isToolItem(l))f=l;else{const g=typeof l=="object"?l.name:l,p=typeof l=="object"?l.args||{}:{};if(g){if(this.cell.isNode()){const m=e.NodeTool.registry.get(g);if(m)f=new m(p);else return e.NodeTool.registry.onNotFound(g)}else if(this.cell.isEdge()){const m=e.EdgeTool.registry.get(g);if(m)f=new m(p);else return e.EdgeTool.registry.onNotFound(g)}}}f&&(f.config(this.cellView,this),f.render(),(f.options.isSVGElement!==!1?this.svgContainer:this.htmlContainer).appendChild(f.container),this.tools.push(f))}return this}update(d={}){const c=this.tools;return c&&c.forEach(i=>{d.toolId!==i.cid&&i.isVisible()&&i.update()}),this}focus(d){const c=this.tools;return c&&c.forEach(i=>{d===i?i.show():i.hide()}),this}blur(d){const c=this.tools;return c&&c.forEach(i=>{i!==d&&!i.isVisible()&&(i.show(),i.update())}),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const d=this.tools;return d&&(d.forEach(c=>c.remove()),this.tools=null),t.Dom.remove(this.svgContainer),t.Dom.remove(this.htmlContainer),super.remove()}mount(){const d=this.tools,c=this.cellView;if(c&&d){const i=d.some(l=>l.options.isSVGElement!==!1),o=d.some(l=>l.options.isSVGElement===!1);i&&(this.options.local?c.container:c.graph.view.decorator).appendChild(this.svgContainer),o&&this.graph.container.appendChild(this.htmlContainer)}return this}}r.ToolsView=u,function(h){h.toStringTag=`X6.${h.name}`;function d(c){if(c==null)return!1;if(c instanceof h)return!0;const i=c[Symbol.toStringTag],o=c;return(i==null||i===h.toStringTag)&&o.graph!=null&&o.cell!=null&&typeof o.config=="function"&&typeof o.update=="function"&&typeof o.focus=="function"&&typeof o.blur=="function"&&typeof o.show=="function"&&typeof o.hide=="function"}h.isToolsView=d}(u=r.ToolsView||(r.ToolsView={})),function(h){class d extends n.View{static getDefaults(){return this.defaults}static config(i){this.defaults=this.getOptions(i)}static getOptions(i){return t.ObjectExt.merge(t.ObjectExt.cloneDeep(this.getDefaults()),i)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return d.toStringTag}constructor(i={}){super();this.visible=!0,this.options=this.getOptions(i),this.container=n.View.createElement(this.options.tagName||"g",this.options.isSVGElement!==!1),t.Dom.addClass(this.container,this.prefixClassName("cell-tool")),typeof this.options.className=="string"&&t.Dom.addClass(this.container,this.options.className),this.init()}init(){}getOptions(i){return this.constructor.getOptions(i)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(i,o){return this.cellView=i,this.parent=o,this.stamp(this.container),this.cell.isEdge()?t.Dom.addClass(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&t.Dom.addClass(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const i=this.options.markup;if(i){const o=a.Markup.parseJSONMarkup(i);this.container.appendChild(o.fragment),this.childNodes=o.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(i){i&&i.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return this.visible}focus(){const i=this.options.focusOpacity;return i!=null&&Number.isFinite(i)&&(this.container.style.opacity=`${i}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(i){return this.graph==null||this.cellView==null?!0:this.graph.view.guard(i,this.cellView)}}d.defaults={isSVGElement:!0,tagName:"g"},h.ToolItem=d,function(c){let i=0;function o(f){return f?t.StringExt.pascalCase(f):(i+=1,`CustomTool${i}`)}function l(f){const g=t.ObjectExt.createClass(o(f.name),this);return g.config(f),g}c.define=l}(d=h.ToolItem||(h.ToolItem={})),function(c){c.toStringTag=`X6.${c.name}`;function i(o){if(o==null)return!1;if(o instanceof c)return!0;const l=o[Symbol.toStringTag],f=o;return(l==null||l===c.toStringTag)&&f.graph!=null&&f.cell!=null&&typeof f.config=="function"&&typeof f.update=="function"&&typeof f.focus=="function"&&typeof f.blur=="function"&&typeof f.show=="function"&&typeof f.hide=="function"&&typeof f.isVisible=="function"}c.isToolItem=i}(d=h.ToolItem||(h.ToolItem={}))}(u=r.ToolsView||(r.ToolsView={}))})(Rt);var Sl={},ee={},Ml={},Al={},Di={};Object.defineProperty(Di,"__esModule",{value:!0});Di.noop=void 0;const ug=r=>r;Di.noop=ug;var Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.pinAbsolute=Ue.pinRelative=void 0;const hg=I;function Nl(r,t){return t===0?"0%":`${Math.round(r/t*100)}%`}function Tl(r){return(e,n,s,a)=>n.isEdgeElement(s)?fg(r,e,n,s,a):dg(r,e,n,s,a)}function dg(r,t,e,n,s){const a=e.cell,u=a.getAngle(),h=e.getUnrotatedBBoxOfElement(n),d=a.getBBox().getCenter(),c=hg.Point.create(s).rotate(u,d);let i=c.x-h.x,o=c.y-h.y;return r&&(i=Nl(i,h.width),o=Nl(o,h.height)),t.anchor={name:"topLeft",args:{dx:i,dy:o,rotate:!0}},t}function fg(r,t,e,n,s){const a=e.getConnection();if(!a)return t;const u=a.closestPointLength(s);if(r){const h=a.length();t.anchor={name:"ratio",args:{ratio:u/h}}}else t.anchor={name:"length",args:{length:u}};return t}Ue.pinRelative=Tl(!0);Ue.pinAbsolute=Tl(!1);(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Di,r),e(Ue,r)})(Al);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectionStrategy=void 0;const s=ot,a=n(Al);(function(u){u.presets=a,u.registry=s.Registry.create({type:"connection strategy"}),u.registry.register(u.presets,!0)})(r.ConnectionStrategy||(r.ConnectionStrategy={}))})(Ml);Object.defineProperty(ee,"__esModule",{value:!0});ee.getViewBBox=ee.getAnchor=void 0;const gg=$,pg=Ml;function mg(r,t,e,n){return gg.FunctionExt.call(pg.ConnectionStrategy.presets.pinRelative,this.graph,{},t,e,r,this.cell,n,{}).anchor}ee.getAnchor=mg;function yg(r,t){return t?r.cell.getBBox():r.cell.isEdge()?r.getConnection().bbox():r.getUnrotatedBBoxOfElement(r.container)}ee.getViewBBox=yg;(function(r){var t=E&&E.__createBinding||(Object.create?function(c,i,o,l){l===void 0&&(l=o);var f=Object.getOwnPropertyDescriptor(i,o);(!f||("get"in f?!i.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(c,l,f)}:function(c,i,o,l){l===void 0&&(l=o),c[l]=i[o]}),e=E&&E.__setModuleDefault||(Object.create?function(c,i){Object.defineProperty(c,"default",{enumerable:!0,value:i})}:function(c,i){c.default=i}),n=E&&E.__importStar||function(c){if(c&&c.__esModule)return c;var i={};if(c!=null)for(var o in c)o!=="default"&&Object.prototype.hasOwnProperty.call(c,o)&&t(i,c,o);return e(i,c),i};Object.defineProperty(r,"__esModule",{value:!0}),r.Button=void 0;const s=I,a=$,u=Rt,h=n(ee);class d extends u.ToolsView.ToolItem{onRender(){a.Dom.addClass(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const o=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();a.Dom.transform(this.container,o,{absolute:!0})}getNodeMatrix(){const i=this.cellView,o=this.options;let{x:l=0,y:f=0}=o;const{offset:g,useCellGeometry:p,rotate:m}=o;let y=h.getViewBBox(i,p);const b=i.cell.getAngle();m||(y=y.bbox(b));let v=0,x=0;typeof g=="number"?(v=g,x=g):typeof g=="object"&&(v=g.x,x=g.y),l=a.NumberExt.normalizePercentage(l,y.width),f=a.NumberExt.normalizePercentage(f,y.height);let P=a.Dom.createSVGMatrix().translate(y.x+y.width/2,y.y+y.height/2);return m&&(P=P.rotate(b)),P=P.translate(l+v-y.width/2,f+x-y.height/2),P}getEdgeMatrix(){const i=this.cellView,o=this.options,{offset:l=0,distance:f=0,rotate:g}=o;let p,m,y;const b=a.NumberExt.normalizePercentage(f,1);b>=0&&b<=1?p=i.getTangentAtRatio(b):p=i.getTangentAtLength(b),p?(m=p.start,y=p.vector().vectorAngle(new s.Point(1,0))||0):(m=i.getConnection().start,y=0);let v=a.Dom.createSVGMatrix().translate(m.x,m.y).rotate(y);return typeof l=="object"?v=v.translate(l.x||0,l.y||0):v=v.translate(0,l),g||(v=v.rotate(-y)),v}onMouseDown(i){if(this.guard(i))return;i.stopPropagation(),i.preventDefault();const o=this.options.onClick;typeof o=="function"&&a.FunctionExt.call(o,this.cellView,{e:i,view:this.cellView,cell:this.cellView.cell,btn:this})}}r.Button=d,function(c){c.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})}(d=r.Button||(r.Button={})),function(c){c.Remove=c.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick({view:i,btn:o}){o.parent.remove(),i.cell.remove({ui:!0,toolId:o.cid})}})}(d=r.Button||(r.Button={}))})(Sl);var jl={};(function(r){var t=E&&E.__createBinding||(Object.create?function(c,i,o,l){l===void 0&&(l=o);var f=Object.getOwnPropertyDescriptor(i,o);(!f||("get"in f?!i.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(c,l,f)}:function(c,i,o,l){l===void 0&&(l=o),c[l]=i[o]}),e=E&&E.__setModuleDefault||(Object.create?function(c,i){Object.defineProperty(c,"default",{enumerable:!0,value:i})}:function(c,i){c.default=i}),n=E&&E.__importStar||function(c){if(c&&c.__esModule)return c;var i={};if(c!=null)for(var o in c)o!=="default"&&Object.prototype.hasOwnProperty.call(c,o)&&t(i,c,o);return e(i,c),i},s=E&&E.__rest||function(c,i){var o={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&i.indexOf(l)<0&&(o[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(c);f<l.length;f++)i.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(c,l[f])&&(o[l[f]]=c[l[f]]);return o};Object.defineProperty(r,"__esModule",{value:!0}),r.Boundary=void 0;const a=$,u=Rt,h=n(ee);class d extends u.ToolsView.ToolItem{onRender(){if(a.Dom.addClass(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const i=this.options.attrs,{class:o}=i,l=s(i,["class"]);a.Dom.attr(this.container,a.Dom.kebablizeAttrs(l)),o&&a.Dom.addClass(this.container,o)}this.update()}update(){const i=this.cellView,o=this.options,{useCellGeometry:l,rotate:f}=o,g=a.NumberExt.normalizeSides(o.padding);let p=h.getViewBBox(i,l).moveAndExpand({x:-g.left,y:-g.top,width:g.left+g.right,height:g.top+g.bottom});const m=i.cell;if(m.isNode()){const y=m.getAngle();if(y)if(f){const b=m.getBBox().getCenter();a.Dom.rotate(this.container,y,b.x,b.y,{absolute:!0})}else p=p.bbox(y)}return a.Dom.attr(this.container,p.toJSON()),this}}r.Boundary=d,function(c){c.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})}(d=r.Boundary||(r.Boundary={}))})(jl);var Dl={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Vertices=void 0;const t=I,e=$,n=$t,s=Pe,a=Rt;class u extends a.ToolsView.ToolItem{constructor(){super(...arguments);this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const d=this.handles;this.handles=[],d&&d.forEach(c=>{this.stopHandleListening(c),c.remove()})}renderHandles(){const d=this.vertices;for(let c=0,i=d.length;c<i;c+=1){const o=d[c],l=this.options.createHandle,f=this.options.processHandle,g=l({index:c,graph:this.graph,guard:p=>this.guard(p),attrs:this.options.attrs||{}});f&&f(g),g.updatePosition(o.x,o.y),this.stamp(g.container),this.container.appendChild(g.container),this.handles.push(g),this.startHandleListening(g)}}updateHandles(){const d=this.vertices;for(let c=0,i=d.length;c<i;c+=1){const o=d[c],l=this.handles[c];l&&l.updatePosition(o.x,o.y)}}updatePath(){const d=this.childNodes.connection;d&&d.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(d){const c=this.cellView;c.can("vertexMovable")&&(d.on("change",this.onHandleChange,this),d.on("changing",this.onHandleChanging,this),d.on("changed",this.onHandleChanged,this)),c.can("vertexDeletable")&&d.on("remove",this.onHandleRemove,this)}stopHandleListening(d){const c=this.cellView;c.can("vertexMovable")&&(d.off("change",this.onHandleChange,this),d.off("changing",this.onHandleChanging,this),d.off("changed",this.onHandleChanged,this)),c.can("vertexDeletable")&&d.off("remove",this.onHandleRemove,this)}getNeighborPoints(d){const c=this.cellView,i=this.vertices,o=d>0?i[d-1]:c.sourceAnchor,l=d<i.length-1?i[d+1]:c.targetAnchor;return{prev:t.Point.create(o),next:t.Point.create(l)}}getMouseEventArgs(d){const c=this.normalizeEvent(d),{x:i,y:o}=this.graph.snapToGrid(c.clientX,c.clientY);return{e:c,x:i,y:o}}onHandleChange({e:d}){this.focus();const c=this.cellView;if(c.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:i,x:o,y:l}=this.getMouseEventArgs(d);this.eventData(i,{start:{x:o,y:l}}),c.notifyMouseDown(i,o,l)}}onHandleChanging({handle:d,e:c}){const i=this.cellView,o=d.options.index,{e:l,x:f,y:g}=this.getMouseEventArgs(c),p={x:f,y:g};this.snapVertex(p,o),i.cell.setVertexAt(o,p,{ui:!0,toolId:this.cid}),d.updatePosition(p.x,p.y),this.options.stopPropagation||i.notifyMouseMove(l,f,g)}stopBatch(d){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),d&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}onHandleChanged({e:d}){const c=this.options,i=this.cellView;if(c.addable&&this.updatePath(),!c.removeRedundancies){this.stopBatch(this.eventData(d).vertexAdded);return}i.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(d).vertexAdded);const{e:l,x:f,y:g}=this.getMouseEventArgs(d);if(!this.options.stopPropagation){i.notifyMouseUp(l,f,g);const{start:p}=this.eventData(l);if(p){const{x:m,y}=p;m===f&&y===g&&i.onClick(l,f,g)}}i.checkMouseleave(l),c.onChanged&&c.onChanged({edge:i.cell,edgeView:i})}snapVertex(d,c){const i=this.options.snapRadius||0;if(i>0){const o=this.getNeighborPoints(c),l=o.prev,f=o.next;Math.abs(d.x-l.x)<i?d.x=l.x:Math.abs(d.x-f.x)<i&&(d.x=f.x),Math.abs(d.y-l.y)<i?d.y=o.prev.y:Math.abs(d.y-f.y)<i&&(d.y=f.y)}}onHandleRemove({handle:d,e:c}){if(this.options.removable){const i=d.options.index,o=this.cellView;o.cell.removeVertexAt(i,{ui:!0}),this.options.addable&&this.updatePath(),o.checkMouseleave(this.normalizeEvent(c))}}allowAddVertex(d){const c=this.guard(d),i=this.options.addable&&this.cellView.can("vertexAddable"),o=this.options.modifiers?e.ModifierKey.isMatch(d,this.options.modifiers):!0;return!c&&i&&o}onPathMouseDown(d){const c=this.cellView;if(!this.allowAddVertex(d))return;d.stopPropagation(),d.preventDefault();const i=this.normalizeEvent(d),o=this.graph.snapToGrid(i.clientX,i.clientY).toJSON();c.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const l=c.getVertexIndex(o.x,o.y);this.snapVertex(o,l),c.cell.insertVertex(o,l,{ui:!0,toolId:this.cid}),this.render();const f=this.handles[l];this.eventData(i,{vertexAdded:!0}),f.onMouseDown(i)}onRemove(){this.resetHandles()}}r.Vertices=u,function(h){class d extends s.View{get graph(){return this.options.graph}constructor(i){super();this.options=i,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}render(){this.container=s.View.createElement("circle",!0);const i=this.options.attrs;if(typeof i=="function"){const o=h.getDefaults();this.setAttrs(Object.assign(Object.assign({},o.attrs),i(this)))}else this.setAttrs(i);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(i,o){this.setAttrs({cx:i,cy:o})}onMouseDown(i){this.options.guard(i)||(i.stopPropagation(),i.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},i.data),this.emit("change",{e:i,handle:this}))}onMouseMove(i){this.emit("changing",{e:i,handle:this})}onMouseUp(i){this.emit("changed",{e:i,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(i){this.emit("remove",{e:i,handle:this})}}h.Handle=d}(u=r.Vertices||(r.Vertices={})),function(h){const d=n.Config.prefix("edge-tool-vertex-path");h.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:c=>new h.Handle(c),markup:[{tagName:"path",selector:"connection",className:d,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${d}`]:"onPathMouseDown",[`touchstart .${d}`]:"onPathMouseDown"}})}(u=r.Vertices||(r.Vertices={}))})(Dl);var Ll={};(function(r){var t=E&&E.__createBinding||(Object.create?function(i,o,l,f){f===void 0&&(f=l);var g=Object.getOwnPropertyDescriptor(o,l);(!g||("get"in g?!o.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return o[l]}}),Object.defineProperty(i,f,g)}:function(i,o,l,f){f===void 0&&(f=l),i[f]=o[l]}),e=E&&E.__setModuleDefault||(Object.create?function(i,o){Object.defineProperty(i,"default",{enumerable:!0,value:o})}:function(i,o){i.default=o}),n=E&&E.__importStar||function(i){if(i&&i.__esModule)return i;var o={};if(i!=null)for(var l in i)l!=="default"&&Object.prototype.hasOwnProperty.call(i,l)&&t(o,i,l);return e(o,i),o};Object.defineProperty(r,"__esModule",{value:!0}),r.Segments=void 0;const s=$,a=I,u=Pe,h=Rt,d=n(ee);class c extends h.ToolsView.ToolItem{constructor(){super(...arguments);this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){s.Dom.addClass(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const o=this.cellView,l=[...this.vertices];l.unshift(o.sourcePoint),l.push(o.targetPoint);for(let f=0,g=l.length;f<g-1;f+=1){const p=l[f],m=l[f+1],y=this.renderHandle(p,m,f);this.stamp(y.container),this.handles.push(y)}return this}renderHandle(o,l,f){const g=this.options.createHandle({index:f,graph:this.graph,guard:p=>this.guard(p),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(g),this.updateHandle(g,o,l),this.container.appendChild(g.container),this.startHandleListening(g),g}startHandleListening(o){o.on("change",this.onHandleChange,this),o.on("changing",this.onHandleChanging,this),o.on("changed",this.onHandleChanged,this)}stopHandleListening(o){o.off("change",this.onHandleChange,this),o.off("changing",this.onHandleChanging,this),o.off("changed",this.onHandleChanged,this)}resetHandles(){const o=this.handles;this.handles=[],o&&o.forEach(l=>{this.stopHandleListening(l),l.remove()})}shiftHandleIndexes(o){const l=this.handles;for(let f=0,g=l.length;f<g;f+=1)l[f].options.index+=o}resetAnchor(o,l){const f=this.cellView.cell,g={ui:!0,toolId:this.cid};l?f.prop([o,"anchor"],l,g):f.removeProp([o,"anchor"],g)}snapHandle(o,l,f){const g=o.options.axis,p=o.options.index,b=this.cellView.cell.getVertices(),v=b[p-2]||f.sourceAnchor,x=b[p+1]||f.targetAnchor,P=this.options.snapRadius;return Math.abs(l[g]-v[g])<P?l[g]=v[g]:Math.abs(l[g]-x[g])<P&&(l[g]=x[g]),l}onHandleChanging({handle:o,e:l}){const f=this.graph,g=this.options,p=this.cellView,m=g.anchor,y=o.options.axis,b=o.options.index-1,v=this.getEventData(l),x=this.normalizeEvent(l),P=f.snapToGrid(x.clientX,x.clientY),C=this.snapHandle(o,P.clone(),v),_=s.ObjectExt.cloneDeep(this.vertices);let A=_[b],S=_[b+1];const w=p.sourceView,O=p.sourceBBox;let M=!1,T=!1;if(A?b===0?O.containsPoint(A)?(_.shift(),this.shiftHandleIndexes(-1),M=!0):(A[y]=C[y],T=!0):A[y]=C[y]:(A=p.sourceAnchor.toJSON(),A[y]=C[y],O.containsPoint(A)?M=!0:(_.unshift(A),this.shiftHandleIndexes(1),T=!0)),typeof m=="function"&&w){if(M){const F=v.sourceAnchor.clone();F[y]=C[y];const z=s.FunctionExt.call(m,p,F,w,p.sourceMagnet||w.container,"source",p,this);this.resetAnchor("source",z)}T&&this.resetAnchor("source",v.sourceAnchorDef)}const j=p.targetView,N=p.targetBBox;let D=!1,B=!1;if(S?b===_.length-2?N.containsPoint(S)?(_.pop(),D=!0):(S[y]=C[y],B=!0):S[y]=C[y]:(S=p.targetAnchor.toJSON(),S[y]=C[y],N.containsPoint(S)?D=!0:(_.push(S),B=!0)),typeof m=="function"&&j){if(D){const F=v.targetAnchor.clone();F[y]=C[y];const z=s.FunctionExt.call(m,p,F,j,p.targetMagnet||j.container,"target",p,this);this.resetAnchor("target",z)}B&&this.resetAnchor("target",v.targetAnchorDef)}a.Point.equalPoints(_,this.vertices)||this.cellView.cell.setVertices(_,{ui:!0,toolId:this.cid}),this.updateHandle(o,A,S,0),g.stopPropagation||p.notifyMouseMove(x,P.x,P.y)}onHandleChange({handle:o,e:l}){const f=this.options,g=this.handles,p=this.cellView,m=o.options.index;if(!!Array.isArray(g)){for(let y=0,b=g.length;y<b;y+=1)y!==m&&g[y].hide();if(this.focus(),this.setEventData(l,{sourceAnchor:p.sourceAnchor.clone(),targetAnchor:p.targetAnchor.clone(),sourceAnchorDef:s.ObjectExt.cloneDeep(this.cell.prop(["source","anchor"])),targetAnchorDef:s.ObjectExt.cloneDeep(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!f.stopPropagation){const y=this.normalizeEvent(l),b=this.graph.snapToGrid(y.clientX,y.clientY);p.notifyMouseDown(y,b.x,b.y)}}}onHandleChanged({e:o}){const l=this.options,f=this.cellView;l.removeRedundancies&&f.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const g=this.normalizeEvent(o),p=this.graph.snapToGrid(g.clientX,g.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),l.stopPropagation||f.notifyMouseUp(g,p.x,p.y),f.checkMouseleave(g),l.onChanged&&l.onChanged({edge:f.cell,edgeView:f})}updateHandle(o,l,f,g=0){const p=this.options.precision||0,m=Math.abs(l.x-f.x)<p,y=Math.abs(l.y-f.y)<p;if(m||y){const b=new a.Line(l,f);if(b.length()<this.options.threshold)o.hide();else{const x=b.getCenter(),P=m?"x":"y";x[P]+=g||0;const C=b.vector().vectorAngle(new a.Point(1,0));o.updatePosition(x.x,x.y,C,this.cellView),o.show(),o.options.axis=P}}else o.hide()}onRemove(){this.resetHandles()}}r.Segments=c,function(i){class o extends u.View{constructor(f){super();this.options=f,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=u.View.createElement("rect",!0);const f=this.options.attrs;if(typeof f=="function"){const g=i.getDefaults();this.setAttrs(Object.assign(Object.assign({},g.attrs),f(this)))}else this.setAttrs(f);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(f,g,p,m){const y=m.getClosestPoint(new a.Point(f,g))||new a.Point(f,g);let b=s.Dom.createSVGMatrix().translate(y.x,y.y);if(y.equals({x:f,y:g}))b=b.rotate(p);else{let x=new a.Line(f,g,y.x,y.y).vector().vectorAngle(new a.Point(1,0));x!==0&&(x+=90),b=b.rotate(x)}this.setAttrs({transform:s.Dom.matrixToTransformString(b),cursor:p%180==0?"row-resize":"col-resize"})}onMouseDown(f){this.options.guard(f)||(this.trigger("change",{e:f,handle:this}),f.stopPropagation(),f.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},f.data))}onMouseMove(f){this.emit("changing",{e:f,handle:this})}onMouseUp(f){this.emit("changed",{e:f,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}i.Handle=o}(c=r.Segments||(r.Segments={})),function(i){i.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:o=>new i.Handle(o),anchor:d.getAnchor})}(c=r.Segments||(r.Segments={}))})(Ll);var Je={},bg=E&&E.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e);var s=Object.getOwnPropertyDescriptor(t,e);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,n,s)}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),vg=E&&E.__setModuleDefault||(Object.create?function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}:function(r,t){r.default=t}),wg=E&&E.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var e in r)e!=="default"&&Object.prototype.hasOwnProperty.call(r,e)&&bg(t,r,e);return vg(t,r),t};Object.defineProperty(Je,"__esModule",{value:!0});Je.TargetAnchor=Je.SourceAnchor=void 0;const Li=$,xg=I,Pg=Rt,Og=wg(ee);class $i extends Pg.ToolsView.ToolItem{get type(){return this.options.type}onRender(){Li.Dom.addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const t=this.type;return this.cellView.getTerminalView(t)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const t=this.childNodes;if(!t)return;const e=t.anchor;if(!e)return;const n=this.type,s=this.cellView,a=this.options,u=s.getTerminalAnchor(n),h=s.cell.prop([n,"anchor"]);e.setAttribute("transform",`translate(${u.x}, ${u.y})`);const d=h?a.customAnchorAttrs:a.defaultAnchorAttrs;d&&Object.keys(d).forEach(c=>{e.setAttribute(c,d[c])})}updateArea(){const t=this.childNodes;if(!t)return;const e=t.area;if(!e)return;const n=this.type,s=this.cellView,a=s.getTerminalView(n);if(a){const u=a.cell,h=s.getTerminalMagnet(n);let d=this.options.areaPadding||0;Number.isFinite(d)||(d=0);let c,i,o;a.isEdgeElement(h)?(c=a.getBBox(),i=0,o=c.getCenter()):(c=a.getUnrotatedBBoxOfElement(h),i=u.getAngle(),o=c.getCenter(),i&&o.rotate(-i,u.getBBox().getCenter())),c.inflate(d),Li.Dom.attr(e,{x:-c.width/2,y:-c.height/2,width:c.width,height:c.height,transform:`translate(${o.x}, ${o.y}) rotate(${i})`})}}toggleArea(t){if(this.childNodes){const e=this.childNodes.area;e&&(e.style.display=t?"":"none")}}onMouseDown(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(t){const e=this.type,n=this.cell;t?n.prop([e,"anchor"],t,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([e,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(t){const e=this.type,n=this.cellView,s=n.getTerminalView(e);if(s==null)return;const a=this.normalizeEvent(t),u=s.cell,h=n.getTerminalMagnet(e);let d=this.graph.coord.clientToLocalPoint(a.clientX,a.clientY);const c=this.options.snap;if(typeof c=="function"){const l=Li.FunctionExt.call(c,n,d,s,h,e,n,this);d=xg.Point.create(l)}if(this.options.restrictArea)if(s.isEdgeElement(h)){const l=s.getClosestPoint(d);l&&(d=l)}else{const l=s.getUnrotatedBBoxOfElement(h),f=u.getAngle(),g=u.getBBox().getCenter(),p=d.clone().rotate(f,g);l.containsPoint(p)||(d=l.getNearestPointToPoint(p).rotate(-f,g))}let i;const o=this.options.anchor;typeof o=="function"&&(i=Li.FunctionExt.call(o,n,d,s,h,e,n,this)),this.resetAnchor(i),this.update()}onMouseUp(t){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const e=this.cellView;this.options.removeRedundancies&&e.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const t=this.options.resetAnchor;t&&this.resetAnchor(t===!0?void 0:t),this.update()}}(function(r){r.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:Og.getAnchor,snap(t,e,n,s,a,u){const h=u.options.snapRadius||0,d=s==="source",c=d?0:-1,i=this.cell.getVertexAt(c)||this.getTerminalAnchor(d?"target":"source");return i&&(Math.abs(i.x-t.x)<h&&(t.x=i.x),Math.abs(i.y-t.y)<h&&(t.y=i.y)),t}})})($i||($i={}));Je.SourceAnchor=$i.define({name:"source-anchor",type:"source"});Je.TargetAnchor=$i.define({name:"target-anchor",type:"target"});var Xe={},Eg=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.TargetArrowhead=Xe.SourceArrowhead=void 0;const Bi=$,Cg=I,_g=Rt;class Ri extends _g.ToolsView.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const t=this.options.attrs,{class:e}=t,n=Eg(t,["class"]);this.setAttrs(n,this.container),e&&Bi.Dom.addClass(this.container,e)}}onRender(){Bi.Dom.addClass(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const t=this.ratio,e=this.cellView,n=e.getTangentAtRatio(t),s=n?n.start:e.getPointAtRatio(t),a=n&&n.vector().vectorAngle(new Cg.Point(1,0))||0;if(!s)return this;const u=Bi.Dom.createSVGMatrix().translate(s.x,s.y).rotate(a);return Bi.Dom.transform(this.container,u,{absolute:!0}),this}onMouseDown(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const e=this.cellView;if(e.can("arrowheadMovable")){e.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const n=this.graph.snapToGrid(t.clientX,t.clientY),s=e.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(t,s),this.delegateDocumentEvents(this.options.documentEvents,t.data),e.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(t){const e=this.normalizeEvent(t),n=this.graph.snapToGrid(e.clientX,e.clientY);this.cellView.onMouseMove(e,n.x,n.y),this.update()}onMouseUp(t){this.undelegateDocumentEvents();const e=this.normalizeEvent(t),n=this.cellView,s=this.graph.snapToGrid(e.clientX,e.clientY);n.onMouseUp(e,s.x,s.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}(function(r){r.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})})(Ri||(Ri={}));Xe.SourceArrowhead=Ri.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});Xe.TargetArrowhead=Ri.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});var $l={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.CellEditor=void 0;const t=I,e=$,n=Rt,s=Bt;class a extends n.ToolsView.ToolItem{constructor(){super(...arguments);this.labelIndex=-1,this.distance=.5,this.dblClick=this.onCellDblClick.bind(this)}onRender(){const h=this.cellView;h&&h.on("cell:dblclick",this.dblClick)}createElement(){const h=[this.prefixClassName(`${this.cell.isEdge()?"edge":"node"}-tool-editor`),this.prefixClassName("cell-tool-editor")];this.editor=n.ToolsView.createElement("div",!1),this.addClass(h,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}removeElement(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}updateEditor(){const{cell:h,editor:d}=this;if(!d)return;const{style:c}=d;h.isNode()?this.updateNodeEditorTransform():h.isEdge()&&this.updateEdgeEditorTransform();const{attrs:i}=this.options;c.fontSize=`${i.fontSize}px`,c.fontFamily=i.fontFamily,c.color=i.color,c.backgroundColor=i.backgroundColor;const o=this.getCellText()||"";return d.innerText=o,this.setCellText(""),this}updateNodeEditorTransform(){const{graph:h,cell:d,editor:c}=this;if(!c)return;let i=t.Point.create(),o=20,l="",{x:f,y:g}=this.options;const{width:p,height:m}=this.options;if(typeof f!="undefined"&&typeof g!="undefined"){const v=d.getBBox();f=e.NumberExt.normalizePercentage(f,v.width),g=e.NumberExt.normalizePercentage(g,v.height),i=v.topLeft.translate(f,g),o=v.width-f*2}else{const v=d.getBBox();i=v.center,o=v.width-4,l="translate(-50%, -50%)"}const y=h.scale(),{style:b}=c;i=h.localToGraph(i),b.left=`${i.x}px`,b.top=`${i.y}px`,b.transform=`scale(${y.sx}, ${y.sy}) ${l}`,b.minWidth=`${o}px`,typeof p=="number"&&(b.width=`${p}px`),typeof m=="number"&&(b.height=`${m}px`)}updateEdgeEditorTransform(){if(!this.event)return;const{graph:h,editor:d}=this;if(!d)return;let c=t.Point.create(),i=20;const{style:o}=d,l=this.event.target,f=l.parentElement;if(f&&e.Dom.hasClass(f,this.prefixClassName("edge-label"))){const m=f.getAttribute("data-index")||"0";this.labelIndex=parseInt(m,10);const y=f.getAttribute("transform"),{translation:b}=e.Dom.parseTransformString(y);c=new t.Point(b.tx,b.ty),i=s.Util.getBBox(l).width}else{if(!this.options.labelAddable)return this;c=h.clientToLocal(t.Point.create(this.event.clientX,this.event.clientY));const y=this.cellView.path.closestPointLength(c);this.distance=y,this.labelIndex=-1}c=h.localToGraph(c);const p=h.scale();o.left=`${c.x}px`,o.top=`${c.y}px`,o.minWidth=`${i}px`,o.transform=`scale(${p.sx}, ${p.sy}) translate(-50%, -50%)`}onDocumentMouseUp(h){if(this.editor&&h.target!==this.editor){const d=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(d!==""?d:null),this.removeElement()}}onCellDblClick({e:h}){this.editor||(h.stopPropagation(),this.removeElement(),this.event=h,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}onMouseDown(h){h.stopPropagation()}autoFocus(){setTimeout(()=>{this.editor&&(this.editor.focus(),this.selectText())})}selectText(){if(window.getSelection&&this.editor){const h=document.createRange(),d=window.getSelection();h.selectNodeContents(this.editor),d.removeAllRanges(),d.addRange(h)}}getCellText(){const{getText:h}=this.options;if(typeof h=="function")return e.FunctionExt.call(h,this.cellView,{cell:this.cell,index:this.labelIndex});if(typeof h=="string"){if(this.cell.isNode())return this.cell.attr(h);if(this.cell.isEdge()&&this.labelIndex!==-1)return this.cell.prop(`labels/${this.labelIndex}/attrs/${h}`)}}setCellText(h){const d=this.options.setText;if(typeof d=="function"){e.FunctionExt.call(d,this.cellView,{cell:this.cell,value:h,index:this.labelIndex,distance:this.distance});return}if(typeof d=="string"){if(this.cell.isNode()){h!==null&&this.cell.attr(d,h);return}if(this.cell.isEdge()){const c=this.cell;if(this.labelIndex===-1){if(h){const i={position:{distance:this.distance},attrs:{}};e.ObjectExt.setByPath(i,`attrs/${d}`,h),c.appendLabel(i)}}else h!==null?c.prop(`labels/${this.labelIndex}/attrs/${d}`,h):typeof this.labelIndex=="number"&&c.removeLabelAt(this.labelIndex)}}}onRemove(){const h=this.cellView;h&&h.off("cell:dblclick",this.dblClick),this.removeElement()}}r.CellEditor=a,function(u){u.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})}(a=r.CellEditor||(r.CellEditor={})),function(u){u.NodeEditor=u.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),u.EdgeEditor=u.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})}(a=r.CellEditor||(r.CellEditor={}))})($l);(function(r){var t=E&&E.__rest||function(o,l){var f={};for(var g in o)Object.prototype.hasOwnProperty.call(o,g)&&l.indexOf(g)<0&&(f[g]=o[g]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,g=Object.getOwnPropertySymbols(o);p<g.length;p++)l.indexOf(g[p])<0&&Object.prototype.propertyIsEnumerable.call(o,g[p])&&(f[g[p]]=o[g[p]]);return f};Object.defineProperty(r,"__esModule",{value:!0}),r.EdgeTool=r.NodeTool=void 0;const e=ot,n=Rt,s=Sl,a=jl,u=Dl,h=Ll,d=Je,c=Xe,i=$l;(function(o){o.presets={boundary:a.Boundary,button:s.Button,"button-remove":s.Button.Remove,"node-editor":i.CellEditor.NodeEditor},o.registry=e.Registry.create({type:"node tool",process(l,f){if(typeof f=="function")return f;let g=n.ToolsView.ToolItem;const{inherit:p}=f,m=t(f,["inherit"]);if(p){const y=this.get(p);y==null?this.onNotFound(p,"inherited"):g=y}return m.name==null&&(m.name=l),g.define.call(g,m)}}),o.registry.register(o.presets,!0)})(r.NodeTool||(r.NodeTool={})),function(o){o.presets={boundary:a.Boundary,vertices:u.Vertices,segments:h.Segments,button:s.Button,"button-remove":s.Button.Remove,"source-anchor":d.SourceAnchor,"target-anchor":d.TargetAnchor,"source-arrowhead":c.SourceArrowhead,"target-arrowhead":c.TargetArrowhead,"edge-editor":i.CellEditor.EdgeEditor},o.registry=e.Registry.create({type:"edge tool",process(l,f){if(typeof f=="function")return f;let g=n.ToolsView.ToolItem;const{inherit:p}=f,m=t(f,["inherit"]);if(p){const y=this.get(p);y==null?this.onNotFound(p,"inherited"):g=y}return m.name==null&&(m.name=l),g.define.call(g,m)}}),o.registry.register(o.presets,!0)}(r.EdgeTool||(r.EdgeTool={}))})(ks);var Bl={},Rl={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.bottomRight=at.bottomLeft=at.topRight=at.topLeft=at.right=at.left=at.bottom=at.top=at.center=void 0;const Il=$;at.center=ne("center");at.top=ne("topCenter");at.bottom=ne("bottomCenter");at.left=ne("leftMiddle");at.right=ne("rightMiddle");at.topLeft=ne("topLeft");at.topRight=ne("topRight");at.bottomLeft=ne("bottomLeft");at.bottomRight=ne("bottomRight");function ne(r){return function(t,e,n,s={}){const a=s.rotate?t.getUnrotatedBBoxOfElement(e):t.getBBoxOfElement(e),u=a[r];u.x+=Il.NumberExt.normalizePercentage(s.dx,a.width),u.y+=Il.NumberExt.normalizePercentage(s.dy,a.height);const h=t.cell;return s.rotate?u.rotate(-h.getAngle(),h.getBBox().getCenter()):u}}var Ii={},ie={};Object.defineProperty(ie,"__esModule",{value:!0});ie.getPointAtEdge=ie.resolve=void 0;const Sg=$,Mg=I;function Ag(r){return function(t,e,n,s){if(n instanceof Element){const a=this.graph.findViewByElem(n);let u;if(a)if(a.isEdgeElement(n)){const h=s.fixedAt!=null?s.fixedAt:"50%";u=Vl(a,h)}else u=a.getBBoxOfElement(n).getCenter();else u=new Mg.Point;return r.call(this,t,e,u,s)}return r.apply(this,arguments)}}ie.resolve=Ag;function Vl(r,t){const e=Sg.NumberExt.isPercentage(t),n=typeof t=="string"?parseFloat(t):t;return e?r.getPointAtRatio(n/100):r.getPointAtLength(n)}ie.getPointAtEdge=Vl;Object.defineProperty(Ii,"__esModule",{value:!0});Ii.orth=void 0;const Ws=I,Ng=ie,Tg=function(r,t,e,n){const s=Ws.Angle.normalize(r.cell.getAngle()),a=r.getBBoxOfElement(t),u=a.getCenter(),h=a.getTopLeft(),d=a.getBottomRight();let c=n.padding;if(Number.isFinite(c)||(c=0),h.y+c<=e.y&&e.y<=d.y-c){const i=e.y-u.y;u.x+=s===0||s===180?0:i*1/Math.tan(Ws.Angle.toRad(s)),u.y+=i}else if(h.x+c<=e.x&&e.x<=d.x-c){const i=e.x-u.x;u.y+=s===90||s===270?0:i*Math.tan(Ws.Angle.toRad(s)),u.x+=i}return u};Ii.orth=(0,Ng.resolve)(Tg);var Vi={};Object.defineProperty(Vi,"__esModule",{value:!0});Vi.nodeCenter=void 0;const jg=function(r,t,e,n,s){const a=r.cell.getConnectionPoint(this.cell,s);return(n.dx||n.dy)&&a.translate(n.dx||0,n.dy||0),a};Vi.nodeCenter=jg;var Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});Fi.midSide=void 0;const Dg=ie,Lg=function(r,t,e,n){let s,a=0,u;const h=r.cell;n.rotate?(s=r.getUnrotatedBBoxOfElement(t),u=h.getBBox().getCenter(),a=h.getAngle()):s=r.getBBoxOfElement(t);const d=n.padding;d!=null&&Number.isFinite(d)&&s.inflate(d),n.rotate&&e.rotate(a,u);const c=s.getNearestSideToPoint(e);let i;switch(c){case"left":i=s.getLeftMiddle();break;case"right":i=s.getRightMiddle();break;case"top":i=s.getTopCenter();break;case"bottom":i=s.getBottomCenter();break}const o=n.direction;return o==="H"?(c==="top"||c==="bottom")&&(e.x<=s.x+s.width?i=s.getLeftMiddle():i=s.getRightMiddle()):o==="V"&&(e.y<=s.y+s.height?i=s.getTopCenter():i=s.getBottomCenter()),n.rotate?i.rotate(-a,u):i};Fi.midSide=(0,Dg.resolve)(Lg);(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(at,r),e(Ii,r),e(Vi,r),e(Fi,r)})(Rl);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.NodeAnchor=void 0;const s=ot,a=n(Rl);(function(u){u.presets=a,u.registry=s.Registry.create({type:"node endpoint"}),u.registry.register(u.presets,!0)})(r.NodeAnchor||(r.NodeAnchor={}))})(Bl);var Fl={},zl={},zi={};Object.defineProperty(zi,"__esModule",{value:!0});zi.ratio=void 0;const $g=function(r,t,e,n){let s=n.ratio!=null?n.ratio:.5;return s>1&&(s/=100),r.getPointAtRatio(s)};zi.ratio=$g;var ki={};Object.defineProperty(ki,"__esModule",{value:!0});ki.length=void 0;const Bg=function(r,t,e,n){const s=n.length!=null?n.length:20;return r.getPointAtLength(s)};ki.length=Bg;var Hi={},Us={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.closest=r.getClosestPoint=void 0;const t=I,e=ie,n=function(s,a,u,h){const d=s.getClosestPoint(u);return d!=null?d:new t.Point};r.getClosestPoint=n,r.closest=(0,e.resolve)(r.getClosestPoint)})(Us);Object.defineProperty(Hi,"__esModule",{value:!0});Hi.orth=void 0;const kl=I,Rg=$,Hl=ie,Ig=Us,Vg=function(r,t,e,n){const s=1e6,a=r.getConnection(),u=r.getConnectionSubdivisions(),h=new kl.Line(e.clone().translate(0,s),e.clone().translate(0,-s)),d=new kl.Line(e.clone().translate(s,0),e.clone().translate(-s,0)),c=h.intersect(a,{segmentSubdivisions:u}),i=d.intersect(a,{segmentSubdivisions:u}),o=[];return c&&o.push(...c),i&&o.push(...i),o.length>0?e.closest(o):n.fallbackAt!=null?(0,Hl.getPointAtEdge)(r,n.fallbackAt):Rg.FunctionExt.call(Ig.getClosestPoint,this,r,t,e,n)};Hi.orth=(0,Hl.resolve)(Vg);(function(r){var t=E&&E.__createBinding||(Object.create?function(s,a,u,h){h===void 0&&(h=u);var d=Object.getOwnPropertyDescriptor(a,u);(!d||("get"in d?!a.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return a[u]}}),Object.defineProperty(s,h,d)}:function(s,a,u,h){h===void 0&&(h=u),s[h]=a[u]}),e=E&&E.__exportStar||function(s,a){for(var u in s)u!=="default"&&!Object.prototype.hasOwnProperty.call(a,u)&&t(a,s,u)};Object.defineProperty(r,"__esModule",{value:!0}),r.closest=void 0,e(zi,r),e(ki,r),e(Hi,r);var n=Us;Object.defineProperty(r,"closest",{enumerable:!0,get:function(){return n.closest}})})(zl);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.EdgeAnchor=void 0;const s=ot,a=n(zl);(function(u){u.presets=a,u.registry=s.Registry.create({type:"edge endpoint"}),u.registry.register(u.presets,!0)})(r.EdgeAnchor||(r.EdgeAnchor={}))})(Fl);var Gl={},ql={},xn={},It={};Object.defineProperty(It,"__esModule",{value:!0});It.findShapeNode=It.getStrokeWidth=It.offset=void 0;const Fg=I;function zg(r,t,e){let n;if(typeof e=="object"){if(Number.isFinite(e.y)){const a=new Fg.Line(t,r),{start:u,end:h}=a.parallel(e.y);t=u,r=h}n=e.x}else n=e;if(n==null||!Number.isFinite(n))return r;const s=r.distance(t);return n===0&&s>0?r:r.move(t,-Math.min(n,s-1))}It.offset=zg;function kg(r){const t=r.getAttribute("stroke-width");return t===null?0:parseFloat(t)||0}It.getStrokeWidth=kg;function Hg(r){if(r==null)return null;let t=r;do{let e=t.tagName;if(typeof e!="string")return null;if(e=e.toUpperCase(),e==="G")t=t.firstElementChild;else if(e==="TITLE")t=t.nextElementSibling;else break}while(t);return t}It.findShapeNode=Hg;Object.defineProperty(xn,"__esModule",{value:!0});xn.bbox=void 0;const Wl=It,Gg=function(r,t,e,n){const s=t.getBBoxOfElement(e);n.stroked&&s.inflate((0,Wl.getStrokeWidth)(e)/2);const a=r.intersect(s),u=a&&a.length?r.start.closest(a):r.end;return(0,Wl.offset)(u,r.start,n.offset)};xn.bbox=Gg;var Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});Gi.rect=void 0;const qg=$,Wg=xn,Ul=It,Ug=function(r,t,e,n,s){const a=t.cell,u=a.isNode()?a.getAngle():0;if(u===0)return qg.FunctionExt.call(Wg.bbox,this,r,t,e,n,s);const h=t.getUnrotatedBBoxOfElement(e);n.stroked&&h.inflate((0,Ul.getStrokeWidth)(e)/2);const d=h.getCenter(),c=r.clone().rotate(u,d),i=c.setLength(1e6).intersect(h),o=i&&i.length?c.start.closest(i).rotate(-u,d):r.end;return(0,Ul.offset)(o,r.start,n.offset)};Gi.rect=Ug;var qi={};Object.defineProperty(qi,"__esModule",{value:!0});qi.boundary=void 0;const Js=$,Xs=I,Wi=It,Jl=Bt,Jg=function(r,t,e,n){let s,a;const u=r.end,h=n.selector;if(typeof h=="string"?s=t.findOne(h):Array.isArray(h)?s=Js.ObjectExt.getByPath(e,h):s=(0,Wi.findShapeNode)(e),!Js.Dom.isSVGGraphicsElement(s)){if(s===e||!Js.Dom.isSVGGraphicsElement(e))return u;s=e}const d=t.getShapeOfElement(s),c=t.getMatrixOfElement(s),i=t.getRootTranslatedMatrix(),o=t.getRootRotatedMatrix(),l=i.multiply(o).multiply(c),f=l.inverse(),g=Jl.Util.transformLine(r,f),p=g.start.clone(),m=t.getDataOfElement(s);if(n.insideout===!1){m.shapeBBox==null&&(m.shapeBBox=d.bbox());const x=m.shapeBBox;if(x!=null&&x.containsPoint(p))return u}n.extrapolate===!0&&g.setLength(1e6);let y;if(Xs.Path.isPath(d)){const x=n.precision||2;m.segmentSubdivisions==null&&(m.segmentSubdivisions=d.getSegmentSubdivisions({precision:x})),y={precision:x,segmentSubdivisions:m.segmentSubdivisions},a=g.intersect(d,y)}else a=g.intersect(d);a?Array.isArray(a)&&(a=p.closest(a)):n.sticky===!0&&(Xs.Rectangle.isRectangle(d)?a=d.getNearestPointToPoint(p):Xs.Ellipse.isEllipse(d)?a=d.intersectsWithLineFromCenterToPoint(p):a=d.closestPoint(p,y));const b=a?Jl.Util.transformPoint(a,l):u;let v=n.offset||0;return n.stroked!==!1&&(typeof v=="object"?(v=Object.assign({},v),v.x==null&&(v.x=0),v.x+=(0,Wi.getStrokeWidth)(s)/2):v+=(0,Wi.getStrokeWidth)(s)/2),(0,Wi.offset)(b,r.start,v)};qi.boundary=Jg;var Ui={};Object.defineProperty(Ui,"__esModule",{value:!0});Ui.anchor=void 0;const Xg=It;function Yg(r,t,e=0){const{start:n,end:s}=r;let a,u,h,d;switch(t){case"left":d="x",a=s,u=n,h=-1;break;case"right":d="x",a=n,u=s,h=1;break;case"top":d="y",a=s,u=n,h=-1;break;case"bottom":d="y",a=n,u=s,h=1;break;default:return}n[d]<s[d]?a[d]=u[d]:u[d]=a[d],Number.isFinite(e)&&(a[d]+=h*e,u[d]+=h*e)}const Kg=function(r,t,e,n){const{alignOffset:s,align:a}=n;return a&&Yg(r,a,s),(0,Xg.offset)(r.end,r.start,n.offset)};Ui.anchor=Kg;(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(xn,r),e(Gi,r),e(qi,r),e(Ui,r)})(ql);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectionPoint=void 0;const s=ot,a=n(ql);(function(u){u.presets=a,u.registry=s.Registry.create({type:"connection point"}),u.registry.register(u.presets,!0)})(r.ConnectionPoint||(r.ConnectionPoint={}))})(Gl);var Xl={},Yl={},Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});Ji.normal=void 0;const Zg=function(r){return[...r]};Ji.normal=Zg;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.oneSide=void 0;const Qg=$,tp=function(r,t,e){const n=t.side||"bottom",s=Qg.NumberExt.normalizeSides(t.padding||40),a=e.sourceBBox,u=e.targetBBox,h=a.getCenter(),d=u.getCenter();let c,i,o;switch(n){case"top":o=-1,c="y",i="height";break;case"left":o=-1,c="x",i="width";break;case"right":o=1,c="x",i="width";break;case"bottom":default:o=1,c="y",i="height";break}return h[c]+=o*(a[i]/2+s[n]),d[c]+=o*(u[i]/2+s[n]),o*(h[c]-d[c])>0?d[c]=h[c]:h[c]=d[c],[h.toJSON(),...r,d.toJSON()]};Xi.oneSide=tp;var Pn={},wt={};Object.defineProperty(wt,"__esModule",{value:!0});wt.getTargetAnchor=wt.getSourceAnchor=wt.getTargetBBox=wt.getSourceBBox=wt.getPaddingBox=wt.getPointBBox=void 0;const ep=$,np=I;function ip(r){return new np.Rectangle(r.x,r.y,0,0)}wt.getPointBBox=ip;function Ys(r={}){const t=ep.NumberExt.normalizeSides(r.padding||20);return{x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}wt.getPaddingBox=Ys;function Kl(r,t={}){return r.sourceBBox.clone().moveAndExpand(Ys(t))}wt.getSourceBBox=Kl;function Zl(r,t={}){return r.targetBBox.clone().moveAndExpand(Ys(t))}wt.getTargetBBox=Zl;function rp(r,t={}){return r.sourceAnchor?r.sourceAnchor:Kl(r,t).getCenter()}wt.getSourceAnchor=rp;function sp(r,t={}){return r.targetAnchor?r.targetAnchor:Zl(r,t).getCenter()}wt.getTargetAnchor=sp;var op=E&&E.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e);var s=Object.getOwnPropertyDescriptor(t,e);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,n,s)}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),ap=E&&E.__setModuleDefault||(Object.create?function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}:function(r,t){r.default=t}),lp=E&&E.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var e in r)e!=="default"&&Object.prototype.hasOwnProperty.call(r,e)&&op(t,r,e);return ap(t,r),t};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.orth=void 0;const cp=$,xt=I,Wt=lp(wt),up=function(r,t,e){let n=Wt.getSourceBBox(e,t),s=Wt.getTargetBBox(e,t);const a=Wt.getSourceAnchor(e,t),u=Wt.getTargetAnchor(e,t);n=n.union(Wt.getPointBBox(a)),s=s.union(Wt.getPointBBox(u));const h=r.map(i=>xt.Point.create(i));h.unshift(a),h.push(u);let d=null;const c=[];for(let i=0,o=h.length-1;i<o;i+=1){let l=null;const f=h[i],g=h[i+1],p=Nt.getBearing(f,g)!=null;if(i===0)i+1===o?n.intersectsWithRect(s.clone().inflate(1))?l=Nt.insideNode(f,g,n,s):p||(l=Nt.nodeToNode(f,g,n,s)):n.containsPoint(g)?l=Nt.insideNode(f,g,n,Wt.getPointBBox(g).moveAndExpand(Wt.getPaddingBox(t))):p||(l=Nt.nodeToVertex(f,g,n));else if(i+1===o){const m=p&&Nt.getBearing(g,f)===d;s.containsPoint(f)||m?l=Nt.insideNode(f,g,Wt.getPointBBox(f).moveAndExpand(Wt.getPaddingBox(t)),s,d):p||(l=Nt.vertexToNode(f,g,s,d))}else p||(l=Nt.vertexToVertex(f,g,d));l?(c.push(...l.points),d=l.direction):d=Nt.getBearing(f,g),i+1<o&&c.push(g)}return c};Pn.orth=up;var Nt;(function(r){const t={N:"S",S:"N",E:"W",W:"E"},e={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function n(o,l,f){let g=new xt.Point(o.x,l.y);return f.containsPoint(g)&&(g=new xt.Point(l.x,o.y)),g}function s(o,l){return o[l==="W"||l==="E"?"width":"height"]}r.getBBoxSize=s;function a(o,l){return o.x===l.x?o.y>l.y?"N":"S":o.y===l.y?o.x>l.x?"W":"E":null}r.getBearing=a;function u(o,l,f){const g=new xt.Point(o.x,l.y),p=new xt.Point(l.x,o.y),m=a(o,g),y=a(o,p),b=f?t[f]:null,v=m===f||m!==b&&(y===b||y!==f)?g:p;return{points:[v],direction:a(v,l)}}r.vertexToVertex=u;function h(o,l,f){const g=n(o,l,f);return{points:[g],direction:a(g,l)}}r.nodeToVertex=h;function d(o,l,f,g){const p=[new xt.Point(o.x,l.y),new xt.Point(l.x,o.y)],m=p.filter(v=>!f.containsPoint(v)),y=m.filter(v=>a(v,o)!==g);let b;if(y.length>0)return b=y.filter(v=>a(o,v)===g).pop(),b=b||y[0],{points:[b],direction:a(b,l)};{b=cp.ArrayExt.difference(p,m)[0];const v=xt.Point.create(l).move(b,-s(f,g)/2);return{points:[n(v,o,f),v],direction:a(v,l)}}}r.vertexToNode=d;function c(o,l,f,g){let p=h(l,o,g);const m=p.points[0];if(f.containsPoint(m)){p=h(o,l,f);const y=p.points[0];if(g.containsPoint(y)){const b=xt.Point.create(o).move(y,-s(f,a(o,y))/2),v=xt.Point.create(l).move(m,-s(g,a(l,m))/2),x=new xt.Line(b,v).getCenter(),P=h(o,x,f),C=u(x,l,P.direction);p.points=[P.points[0],C.points[0]],p.direction=C.direction}}return p}r.nodeToNode=c;function i(o,l,f,g,p){const m=f.union(g).inflate(1),y=m.getCenter(),b=y.distance(l)>y.distance(o),v=b?l:o,x=b?o:l;let P,C,_;p?(P=xt.Point.fromPolar(m.width+m.height,e[p],v),P=m.getNearestPointToPoint(P).move(P,-1)):P=m.getNearestPointToPoint(v).move(v,1),C=n(P,x,m);let A;P.round().equals(C.round())?(C=xt.Point.fromPolar(m.width+m.height,xt.Angle.toRad(P.theta(v))+Math.PI/2,x),C=m.getNearestPointToPoint(C).move(x,1).round(),_=n(P,C,m),A=b?[C,_,P]:[P,_,C]):A=b?[C,P]:[P,C];const S=a(b?P:C,l);return{points:A,direction:S}}r.insideNode=i})(Nt||(Nt={}));var Yi={},Ut={};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.resolveOptions=Ut.resolve=Ut.defaults=void 0;const hp=$,Ks=I,dp=Pn;Ut.defaults={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return Ee(this.step,this)},directions(){const r=Ee(this.step,this),t=Ee(this.cost,this);return[{cost:t,offsetX:r,offsetY:0},{cost:t,offsetX:-r,offsetY:0},{cost:t,offsetX:0,offsetY:r},{cost:t,offsetX:0,offsetY:-r}]},penalties(){const r=Ee(this.step,this);return{0:0,45:r/2,90:r/2}},paddingBox(){const r=Ee(this.step,this);return{x:-r,y:-r,width:2*r,height:2*r}},fallbackRouter:dp.orth,draggingRouter:null,snapToGrid:!0};function Ee(r,t){return typeof r=="function"?r.call(t):r}Ut.resolve=Ee;function fp(r){const t=Object.keys(r).reduce((e,n)=>{const s=e;return n==="fallbackRouter"||n==="draggingRouter"||n==="fallbackRoute"?s[n]=r[n]:s[n]=Ee(r[n],r),e},{});if(t.padding){const e=hp.NumberExt.normalizeSides(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}return t.directions.forEach(e=>{const n=new Ks.Point(0,0),s=new Ks.Point(e.offsetX,e.offsetY);e.angle=Ks.Angle.normalize(n.theta(s))}),t}Ut.resolveOptions=fp;var On={},Ki={},Zi={};Object.defineProperty(Zi,"__esModule",{value:!0});Zi.SortedSet=void 0;const gp=$,Ql=1,tc=2;class pp{constructor(){this.items=[],this.hash={},this.values={}}add(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=Ql,this.values[t]=e;const n=gp.ArrayExt.sortedIndexBy(this.items,t,s=>this.values[s]);this.items.splice(n,0,t)}pop(){const t=this.items.shift();return t&&(this.hash[t]=tc),t}isOpen(t){return this.hash[t]===Ql}isClose(t){return this.hash[t]===tc}isEmpty(){return this.items.length===0}}Zi.SortedSet=pp;var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0});Qi.ObstacleMap=void 0;const ec=$,mp=I;class yp{constructor(t){this.options=t,this.mapGridSize=100,this.map={}}build(t,e){const n=this.options,s=n.excludeTerminals.reduce((c,i)=>{const o=e[i];if(o){const l=t.getCell(o.cell);l&&c.push(l)}return c},[]);let a=[];const u=t.getCell(e.getSourceCellId());u&&(a=ec.ArrayExt.union(a,u.getAncestors().map(c=>c.id)));const h=t.getCell(e.getTargetCellId());h&&(a=ec.ArrayExt.union(a,h.getAncestors().map(c=>c.id)));const d=this.mapGridSize;return t.getNodes().reduce((c,i)=>{const o=s.some(m=>m.id===i.id),l=i.shape?n.excludeShapes.includes(i.shape):!1,f=n.excludeNodes.some(m=>typeof m=="string"?i.id===m:m===i),g=a.includes(i.id),p=l||o||f||g;if(i.isVisible()&&!p){const m=i.getBBox().moveAndExpand(n.paddingBox),y=m.getOrigin().snapToGrid(d),b=m.getCorner().snapToGrid(d);for(let v=y.x;v<=b.x;v+=d)for(let x=y.y;x<=b.y;x+=d){const P=new mp.Point(v,x).toString();c[P]==null&&(c[P]=[]),c[P].push(m)}}return c},this.map),this}isAccessible(t){const e=t.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[e];return n?n.every(s=>!s.containsPoint(t)):!0}}Qi.ObstacleMap=yp;var q={};Object.defineProperty(q,"__esModule",{value:!0});q.reconstructRoute=q.getRectPoints=q.getCost=q.normalizePoint=q.getKey=q.align=q.round=q.getGrid=q.getGridOffsets=q.getDirectionChange=q.getDirectionAngle=q.getTargetEndpoint=q.getSourceEndpoint=q.getTargetBBox=q.getSourceBBox=void 0;const he=I;function nc(r,t){const e=r.sourceBBox.clone();return t&&t.paddingBox?e.moveAndExpand(t.paddingBox):e}q.getSourceBBox=nc;function ic(r,t){const e=r.targetBBox.clone();return t&&t.paddingBox?e.moveAndExpand(t.paddingBox):e}q.getTargetBBox=ic;function bp(r,t){return r.sourceAnchor?r.sourceAnchor:nc(r,t).getCenter()}q.getSourceEndpoint=bp;function vp(r,t){return r.targetAnchor?r.targetAnchor:ic(r,t).getCenter()}q.getTargetEndpoint=vp;function wp(r,t,e,n,s){const a=360/e,u=r.theta(xp(r,t,n,s)),h=he.Angle.normalize(u+a/2);return a*Math.floor(h/a)}q.getDirectionAngle=wp;function xp(r,t,e,n){const s=n.step,a=t.x-r.x,u=t.y-r.y,h=a/e.x,d=u/e.y,c=h*s,i=d*s;return new he.Point(r.x+c,r.y+i)}function Pp(r,t){const e=Math.abs(r-t);return e>180?360-e:e}q.getDirectionChange=Pp;function Op(r,t){const e=t.step;return t.directions.forEach(n=>{n.gridOffsetX=n.offsetX/e*r.x,n.gridOffsetY=n.offsetY/e*r.y}),t.directions}q.getGridOffsets=Op;function Ep(r,t,e){return{source:t.clone(),x:rc(e.x-t.x,r),y:rc(e.y-t.y,r)}}q.getGrid=Ep;function rc(r,t){if(!r)return t;const e=Math.abs(r),n=Math.round(e/t);if(!n)return e;const s=n*t,u=(e-s)/n;return t+u}function Cp(r,t){const e=t.source,n=he.GeometryUtil.snapToGrid(r.x-e.x,t.x)+e.x,s=he.GeometryUtil.snapToGrid(r.y-e.y,t.y)+e.y;return new he.Point(n,s)}function sc(r,t){return r.round(t)}q.round=sc;function tr(r,t,e){return sc(Cp(r.clone(),t),e)}q.align=tr;function Zs(r){return r.toString()}q.getKey=Zs;function er(r){return new he.Point(r.x===0?0:Math.abs(r.x)/r.x,r.y===0?0:Math.abs(r.y)/r.y)}q.normalizePoint=er;function _p(r,t){let e=1/0;for(let n=0,s=t.length;n<s;n+=1){const a=r.manhattanDistance(t[n]);a<e&&(e=a)}return e}q.getCost=_p;function Sp(r,t,e,n,s){const a=s.precision,u=s.directionMap,h=r.diff(t.getCenter()),d=Object.keys(u).reduce((c,i)=>{if(e.includes(i)){const o=u[i],l=new he.Point(r.x+o.x*(Math.abs(h.x)+t.width),r.y+o.y*(Math.abs(h.y)+t.height)),g=new he.Line(r,l).intersect(t)||[];let p,m=null;for(let y=0;y<g.length;y+=1){const b=g[y],v=r.squaredDistance(b);(p==null||v>p)&&(p=v,m=b)}if(m){let y=tr(m,n,a);t.containsPoint(y)&&(y=tr(y.translate(o.x*n.x,o.y*n.y),n,a)),c.push(y)}}return c},[]);return t.containsPoint(r)||d.push(tr(r,n,a)),d}q.getRectPoints=Sp;function Mp(r,t,e,n,s){const a=[];let u=er(s.diff(e)),h=Zs(e),d=r[h],c;for(;d;){c=t[h];const l=er(c.diff(d));l.equals(u)||(a.unshift(c),u=l),h=Zs(d),d=r[h]}const i=t[h];return er(i.diff(n)).equals(u)||a.unshift(i),a}q.reconstructRoute=Mp;var Ap=E&&E.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e);var s=Object.getOwnPropertyDescriptor(t,e);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,n,s)}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),Np=E&&E.__setModuleDefault||(Object.create?function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}:function(r,t){r.default=t}),Tp=E&&E.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var e in r)e!=="default"&&Object.prototype.hasOwnProperty.call(r,e)&&Ap(t,r,e);return Np(t,r),t};Object.defineProperty(Ki,"__esModule",{value:!0});Ki.router=void 0;const Qs=$,Ye=I,jp=Zi,Dp=Qi,Z=Tp(q),Lp=Ut;function $p(r,t,e,n,s){const a=s.precision;let u,h;Ye.Rectangle.isRectangle(t)?u=Z.round(Z.getSourceEndpoint(r,s).clone(),a):u=Z.round(t.clone(),a),Ye.Rectangle.isRectangle(e)?h=Z.round(Z.getTargetEndpoint(r,s).clone(),a):h=Z.round(e.clone(),a);const d=Z.getGrid(s.step,u,h),c=u,i=h;let o,l;if(Ye.Rectangle.isRectangle(t)?o=Z.getRectPoints(c,t,s.startDirections,d,s):o=[c],Ye.Rectangle.isRectangle(e)?l=Z.getRectPoints(h,e,s.endDirections,d,s):l=[i],o=o.filter(f=>n.isAccessible(f)),l=l.filter(f=>n.isAccessible(f)),o.length>0&&l.length>0){const f=new jp.SortedSet,g={},p={},m={};for(let w=0,O=o.length;w<O;w+=1){const M=o[w],T=Z.getKey(M);f.add(T,Z.getCost(M,l)),g[T]=M,m[T]=0}const y=s.previousDirectionAngle,b=y===void 0;let v,x;const P=Z.getGridOffsets(d,s),C=P.length,_=l.reduce((w,O)=>{const M=Z.getKey(O);return w.push(M),w},[]),A=Ye.Point.equalPoints(o,l);let S=s.maxLoopCount;for(;!f.isEmpty()&&S>0;){const w=f.pop(),O=g[w],M=p[w],T=m[w],j=O.equals(c),N=M==null;let D;if(N?b?j?D=null:D=Z.getDirectionAngle(c,O,C,d,s):D=y:D=Z.getDirectionAngle(M,O,C,d,s),!(N&&A)&&_.indexOf(w)>=0)return s.previousDirectionAngle=D,Z.reconstructRoute(p,g,O,c,i);for(let F=0;F<C;F+=1){v=P[F];const z=v.angle;if(x=Z.getDirectionChange(D,z),!(b&&j)&&x>s.maxDirectionChange)continue;const W=Z.align(O.clone().translate(v.gridOffsetX||0,v.gridOffsetY||0),d,a),U=Z.getKey(W);if(f.isClose(U)||!n.isAccessible(W))continue;if(_.indexOf(U)>=0&&!W.equals(i)){const et=Z.getDirectionAngle(W,i,C,d,s);if(Z.getDirectionChange(z,et)>s.maxDirectionChange)continue}const Me=v.cost,Ae=j?0:s.penalties[x],zt=T+Me+Ae;(!f.isOpen(U)||zt<m[U])&&(g[U]=W,p[U]=O,m[U]=zt,f.add(U,zt+Z.getCost(W,l)))}S-=1}}return s.fallbackRoute?Qs.FunctionExt.call(s.fallbackRoute,this,c,i,s):null}function Bp(r,t=10){if(r.length<=1)return r;for(let e=0,n=r.length;e<n-1;e+=1){const s=r[e],a=r[e+1];if(s.x===a.x){const u=t*Math.round(s.x/t);s.x!==u&&(s.x=u,a.x=u)}else if(s.y===a.y){const u=t*Math.round(s.y/t);s.y!==u&&(s.y=u,a.y=u)}}return r}const Rp=function(r,t,e){const n=(0,Lp.resolveOptions)(t),s=Z.getSourceBBox(e,n),a=Z.getTargetBBox(e,n),u=Z.getSourceEndpoint(e,n),h=new Dp.ObstacleMap(n).build(e.graph.model,e.cell),d=r.map(f=>Ye.Point.create(f)),c=[];let i=u,o,l;for(let f=0,g=d.length;f<=g;f+=1){let p=null;if(o=l||s,l=d[f],l==null){l=a;const y=e.cell;if((y.getSourceCellId()==null||y.getTargetCellId()==null)&&typeof n.draggingRouter=="function"){const v=o===s?u:o,x=l.getOrigin();p=Qs.FunctionExt.call(n.draggingRouter,e,v,x,n)}}if(p==null&&(p=$p(e,o,l,h,n)),p===null)return console.warn("Unable to execute manhattan algorithm, use orth instead"),Qs.FunctionExt.call(n.fallbackRouter,this,r,n,e);const m=p[0];m&&m.equals(i)&&p.shift(),i=p[p.length-1]||i,c.push(...p)}return n.snapToGrid?Bp(c,e.graph.grid.getGridSize()):c};Ki.router=Rp;Object.defineProperty(On,"__esModule",{value:!0});On.manhattan=void 0;const Ip=$,Vp=Ki,Fp=Ut,zp=function(r,t,e){return Ip.FunctionExt.call(Vp.router,this,r,Object.assign(Object.assign({},Fp.defaults),t),e)};On.manhattan=zp;Object.defineProperty(Yi,"__esModule",{value:!0});Yi.metro=void 0;const kp=$,En=I,oc=Ut,Hp=On,Gp={maxDirectionChange:45,directions(){const r=(0,oc.resolve)(this.step,this),t=(0,oc.resolve)(this.cost,this),e=Math.ceil(Math.sqrt(r*r<<1));return[{cost:t,offsetX:r,offsetY:0},{cost:e,offsetX:r,offsetY:r},{cost:t,offsetX:0,offsetY:r},{cost:e,offsetX:-r,offsetY:r},{cost:t,offsetX:-r,offsetY:0},{cost:e,offsetX:-r,offsetY:-r},{cost:t,offsetX:0,offsetY:-r},{cost:e,offsetX:r,offsetY:-r}]},fallbackRoute(r,t,e){const n=r.theta(t),s=[];let a={x:t.x,y:r.y},u={x:r.x,y:t.y};if(n%180>90){const v=a;a=u,u=v}const h=n%90<45?a:u,d=new En.Line(r,h),c=90*Math.ceil(n/90),i=En.Point.fromPolar(d.squaredLength(),En.Angle.toRad(c+135),h),o=new En.Line(t,i),l=d.intersectsWithLine(o),f=l||t,g=l?f:r,p=360/e.directions.length,m=g.theta(t),y=En.Angle.normalize(m+p/2),b=p*Math.floor(y/p);return e.previousDirectionAngle=b,f&&s.push(f.round()),s.push(t),s}},qp=function(r,t,e){return kp.FunctionExt.call(Hp.manhattan,this,r,Object.assign(Object.assign({},Gp),t),e)};Yi.metro=qp;var nr={};Object.defineProperty(nr,"__esModule",{value:!0});nr.er=void 0;const Wp=function(r,t,e){const n=t.offset||32,s=t.min==null?16:t.min;let a=0,u=t.direction;const h=e.sourceBBox,d=e.targetBBox,c=h.getCenter(),i=d.getCenter();if(typeof n=="number"&&(a=n),u==null){let y=d.left-h.right,b=d.top-h.bottom;y>=0&&b>=0?u=y>=b?"L":"T":y<=0&&b>=0?(y=h.left-d.right,y>=0?u=y>=b?"R":"T":u="T"):y>=0&&b<=0?(b=h.top-d.bottom,b>=0?u=y>=b?"L":"B":u="L"):(y=h.left-d.right,b=h.top-d.bottom,y>=0&&b>=0?u=y>=b?"R":"B":y<=0&&b>=0?u="B":y>=0&&b<=0?u="R":u=Math.abs(y)>Math.abs(b)?"R":"B")}u==="H"?u=i.x-c.x>=0?"L":"R":u==="V"&&(u=i.y-c.y>=0?"T":"B"),n==="center"&&(u==="L"?a=(d.left-h.right)/2:u==="R"?a=(h.left-d.right)/2:u==="T"?a=(d.top-h.bottom)/2:u==="B"&&(a=(h.top-d.bottom)/2));let o,l,f;const g=u==="L"||u==="R";if(g){if(i.y===c.y)return[...r];f=u==="L"?1:-1,o="x",l="width"}else{if(i.x===c.x)return[...r];f=u==="T"?1:-1,o="y",l="height"}const p=c.clone(),m=i.clone();if(p[o]+=f*(h[l]/2+a),m[o]-=f*(d[l]/2+a),g){const y=p.x,b=m.x,v=h.width/2+s,x=d.width/2+s;i.x>c.x?b<=y&&(p.x=Math.max(b,c.x+v),m.x=Math.min(y,i.x-x)):b>=y&&(p.x=Math.min(b,c.x-v),m.x=Math.max(y,i.x+x))}else{const y=p.y,b=m.y,v=h.height/2+s,x=d.height/2+s;i.y>c.y?b<=y&&(p.y=Math.max(b,c.y+v),m.y=Math.min(y,i.y-x)):b>=y&&(p.y=Math.min(b,c.y-v),m.y=Math.max(y,i.y+x))}return[p.toJSON(),...r,m.toJSON()]};nr.er=Wp;var ir={};Object.defineProperty(ir,"__esModule",{value:!0});ir.loop=void 0;const Vt=I;function Ke(r,t){if(t!=null&&t!==!1){const e=typeof t=="boolean"?0:t;if(e>0){const n=Vt.Point.create(r[1]).move(r[2],e),s=Vt.Point.create(r[1]).move(r[0],e);return[n.toJSON(),...r,s.toJSON()]}{const n=r[1];return[Object.assign({},n),...r,Object.assign({},n)]}}return r}const Up=function(r,t,e){const n=t.width||50,a=(t.height||80)/2,u=t.angle||"auto",h=e.sourceAnchor,d=e.targetAnchor,c=e.sourceBBox,i=e.targetBBox;if(h.equals(d)){const o=y=>{const b=Vt.Angle.toRad(y),v=Math.sin(b),x=Math.cos(b),P=new Vt.Point(h.x+x*n,h.y+v*n),C=new Vt.Point(P.x-x*a,P.y-v*a),_=C.clone().rotate(-90,P),A=C.clone().rotate(90,P);return[_.toJSON(),P.toJSON(),A.toJSON()]},l=y=>{const b=h.clone().move(y,-1),v=new Vt.Line(b,y);return!c.containsPoint(y)&&!c.intersectsWithLine(v)},f=[0,90,180,270,45,135,225,315];if(typeof u=="number")return Ke(o(u),t.merge);const g=c.getCenter();if(g.equals(h))return Ke(o(0),t.merge);const p=g.angleBetween(h,g.clone().translate(1,0));let m=o(p);if(l(m[1]))return Ke(m,t.merge);for(let y=1,b=f.length;y<b;y+=1)if(m=o(p+f[y]),l(m[1]))return Ke(m,t.merge);return Ke(m,t.merge)}{const o=new Vt.Line(h,d);let l=o.parallel(-n),f=l.getCenter(),g=l.start.clone().move(l.end,a),p=l.end.clone().move(l.start,a);const m=o.parallel(-1),y=new Vt.Line(m.start,f),b=new Vt.Line(m.end,f);if((c.containsPoint(f)||i.containsPoint(f)||c.intersectsWithLine(y)||c.intersectsWithLine(b)||i.intersectsWithLine(y)||i.intersectsWithLine(b))&&(l=o.parallel(n),f=l.getCenter(),g=l.start.clone().move(l.end,a),p=l.end.clone().move(l.start,a)),t.merge){const v=new Vt.Line(h,d),x=new Vt.Line(f,v.center).setLength(Number.MAX_SAFE_INTEGER),P=c.intersectsWithLine(x),C=i.intersectsWithLine(x),_=P?Array.isArray(P)?P:[P]:[];C&&(Array.isArray(C)?_.push(...C):_.push(C));const A=v.center.closest(_);A?(e.sourceAnchor=A.clone(),e.targetAnchor=A.clone()):(e.sourceAnchor=v.center.clone(),e.targetAnchor=v.center.clone())}return Ke([g.toJSON(),f.toJSON(),p.toJSON()],t.merge)}};ir.loop=Up;(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Ji,r),e(Xi,r),e(Pn,r),e(Yi,r),e(On,r),e(nr,r),e(ir,r)})(Yl);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.Router=void 0;const s=ot,a=n(Yl);(function(u){u.presets=a,u.registry=s.Registry.create({type:"router"}),u.registry.register(u.presets,!0)})(r.Router||(r.Router={}))})(Xl);var ac={},lc={},rr={};Object.defineProperty(rr,"__esModule",{value:!0});rr.normal=void 0;const cc=I,Jp=function(r,t,e,n={}){const s=[r,...e,t],a=new cc.Polyline(s),u=new cc.Path(a);return n.raw?u:u.serialize()};rr.normal=Jp;var sr={};Object.defineProperty(sr,"__esModule",{value:!0});sr.loop=void 0;const Ce=I,Xp=function(r,t,e,n={}){const s=e.length===3?0:1,a=Ce.Point.create(e[0+s]),u=Ce.Point.create(e[2+s]),h=Ce.Point.create(e[1+s]);if(!Ce.Point.equals(r,t)){const c=new Ce.Point((r.x+t.x)/2,(r.y+t.y)/2),i=c.angleBetween(Ce.Point.create(r).rotate(90,c),h);i>1&&(a.rotate(180-i,c),u.rotate(180-i,c),h.rotate(180-i,c))}const d=`
     M ${r.x} ${r.y}
     Q ${a.x} ${a.y} ${h.x} ${h.y}
     Q ${u.x} ${u.y} ${t.x} ${t.y}
  `;return n.raw?Ce.Path.parse(d):d};sr.loop=Xp;var or={};Object.defineProperty(or,"__esModule",{value:!0});or.rounded=void 0;const de=I,Yp=function(r,t,e,n={}){const s=new de.Path;s.appendSegment(de.Path.createSegment("M",r));const a=1/3,u=2/3,h=n.radius||10;let d,c;for(let i=0,o=e.length;i<o;i+=1){const l=de.Point.create(e[i]),f=e[i-1]||r,g=e[i+1]||t;d=c||l.distance(f)/2,c=l.distance(g)/2;const p=-Math.min(h,d),m=-Math.min(h,c),y=l.clone().move(f,p).round(),b=l.clone().move(g,m).round(),v=new de.Point(a*y.x+u*l.x,u*l.y+a*y.y),x=new de.Point(a*b.x+u*l.x,u*l.y+a*b.y);s.appendSegment(de.Path.createSegment("L",y)),s.appendSegment(de.Path.createSegment("C",v,x,b))}return s.appendSegment(de.Path.createSegment("L",t)),n.raw?s:s.serialize()};or.rounded=Yp;var ar={};Object.defineProperty(ar,"__esModule",{value:!0});ar.smooth=void 0;const Ze=I,Kp=function(r,t,e,n={}){let s,a=n.direction;if(e&&e.length!==0){const u=[r,...e,t],h=Ze.Curve.throughPoints(u);s=new Ze.Path(h)}else if(s=new Ze.Path,s.appendSegment(Ze.Path.createSegment("M",r)),a||(a=Math.abs(r.x-t.x)>=Math.abs(r.y-t.y)?"H":"V"),a==="H"){const u=(r.x+t.x)/2;s.appendSegment(Ze.Path.createSegment("C",u,r.y,u,t.y,t.x,t.y))}else{const u=(r.y+t.y)/2;s.appendSegment(Ze.Path.createSegment("C",r.x,u,t.x,u,t.x,t.y))}return n.raw?s:s.serialize()};ar.smooth=Kp;var lr={};Object.defineProperty(lr,"__esModule",{value:!0});lr.jumpover=void 0;const nt=I,uc=1,cr=1/3,ur=2/3;function Zp(r){let t=r.graph._jumpOverUpdateList;if(t==null&&(t=r.graph._jumpOverUpdateList=[],r.graph.on("cell:mouseup",()=>{const e=r.graph._jumpOverUpdateList;setTimeout(()=>{for(let n=0;n<e.length;n+=1)e[n].update()})}),r.graph.on("model:reseted",()=>{t=r.graph._jumpOverUpdateList=[]})),t.indexOf(r)<0){t.push(r);const e=()=>t.splice(t.indexOf(r),1);r.cell.once("change:connector",e),r.cell.once("removed",e)}}function to(r,t,e=[]){const n=[r,...e,t],s=[];return n.forEach((a,u)=>{const h=n[u+1];h!=null&&s.push(new nt.Line(a,h))}),s}function Qp(r,t){const e=[];return t.forEach(n=>{const s=r.intersectsWithLine(n);s&&e.push(s)}),e}function hc(r,t){return new nt.Line(r,t).squaredLength()}function tm(r,t,e){return t.reduce((n,s,a)=>{if(hr.includes(s))return n;const u=n.pop()||r,h=nt.Point.create(s).move(u.start,-e);let d=nt.Point.create(s).move(u.start,+e);const c=t[a+1];if(c!=null){const l=d.distance(c);l<=e&&(d=c.move(u.start,l),hr.push(c))}else if(h.distance(u.end)<e*2+uc)return n.push(u),n;if(d.distance(u.start)<e*2+uc)return n.push(u),n;const o=new nt.Line(h,d);return Cn.push(o),n.push(new nt.Line(u.start,h),o,new nt.Line(d,u.end)),n},[])}function dc(r,t,e,n){const s=new nt.Path;let a;return a=nt.Path.createSegment("M",r[0].start),s.appendSegment(a),r.forEach((u,h)=>{if(Cn.includes(u)){let d,c,i,o;if(e==="arc"){d=-90,c=u.start.diff(u.end),(c.x<0||c.x===0&&c.y<0)&&(d+=180);const f=u.getCenter(),g=new nt.Line(f,u.end).rotate(d,f);let p;p=new nt.Line(u.start,f),i=p.pointAt(2/3).rotate(d,u.start),o=g.pointAt(1/3).rotate(-d,g.end),a=nt.Path.createSegment("C",i,o,g.end),s.appendSegment(a),p=new nt.Line(f,u.end),i=g.pointAt(1/3).rotate(d,g.end),o=p.pointAt(1/3).rotate(-d,u.end),a=nt.Path.createSegment("C",i,o,u.end),s.appendSegment(a)}else if(e==="gap")a=nt.Path.createSegment("M",u.end),s.appendSegment(a);else if(e==="cubic"){d=u.start.theta(u.end);const l=t*.6;let f=t*1.35;c=u.start.diff(u.end),(c.x<0||c.x===0&&c.y<0)&&(f*=-1),i=new nt.Point(u.start.x+l,u.start.y+f).rotate(d,u.start),o=new nt.Point(u.end.x-l,u.end.y+f).rotate(d,u.end),a=nt.Path.createSegment("C",i,o,u.end),s.appendSegment(a)}}else{const d=r[h+1];n===0||!d||Cn.includes(d)?(a=nt.Path.createSegment("L",u.end),s.appendSegment(a)):em(n,s,u.end,u.start,d.end)}}),s}function em(r,t,e,n,s){const a=e.distance(n)/2,u=e.distance(s)/2,h=-Math.min(r,a),d=-Math.min(r,u),c=e.clone().move(n,h).round(),i=e.clone().move(s,d).round(),o=new nt.Point(cr*c.x+ur*e.x,ur*e.y+cr*c.y),l=new nt.Point(cr*i.x+ur*e.x,ur*e.y+cr*i.y);let f;f=nt.Path.createSegment("L",c),t.appendSegment(f),f=nt.Path.createSegment("C",o,l,i),t.appendSegment(f)}let Cn,hr;const nm=function(r,t,e,n={}){Cn=[],hr=[],Zp(this);const s=n.size||5,a=n.type||"arc",u=n.radius||0,h=n.ignoreConnectors||["smooth"],d=this.graph,i=d.model.getEdges();if(i.length===1)return dc(to(r,t,e),s,a,u);const o=this.cell,l=i.indexOf(o),f=d.options.connecting.connector||{},g=i.filter((x,P)=>{const C=x.getConnector()||f;return h.includes(C.name)?!1:P>l?C.name!=="jumpover":!0}),p=g.map(x=>d.findViewByCell(x)),m=to(r,t,e),y=p.map(x=>x==null?[]:x===this?m:to(x.sourcePoint,x.targetPoint,x.routePoints)),b=[];m.forEach(x=>{const P=g.reduce((C,_,A)=>{if(_!==o){const S=Qp(x,y[A]);C.push(...S)}return C},[]).sort((C,_)=>hc(x.start,C)-hc(x.start,_));P.length>0?b.push(...tm(x,P,s)):b.push(x)});const v=dc(b,s,a,u);return Cn=[],hr=[],n.raw?v:v.serialize()};lr.jumpover=nm;(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(rr,r),e(sr,r),e(or,r),e(ar,r),e(lr,r)})(lc);(function(r){var t=E&&E.__createBinding||(Object.create?function(u,h,d,c){c===void 0&&(c=d);var i=Object.getOwnPropertyDescriptor(h,d);(!i||("get"in i?!h.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return h[d]}}),Object.defineProperty(u,c,i)}:function(u,h,d,c){c===void 0&&(c=d),u[c]=h[d]}),e=E&&E.__setModuleDefault||(Object.create?function(u,h){Object.defineProperty(u,"default",{enumerable:!0,value:h})}:function(u,h){u.default=h}),n=E&&E.__importStar||function(u){if(u&&u.__esModule)return u;var h={};if(u!=null)for(var d in u)d!=="default"&&Object.prototype.hasOwnProperty.call(u,d)&&t(h,u,d);return e(h,u),h};Object.defineProperty(r,"__esModule",{value:!0}),r.Connector=void 0;const s=ot,a=n(lc);(function(u){u.presets=a,u.registry=s.Registry.create({type:"connector"}),u.registry.register(u.presets,!0)})(r.Connector||(r.Connector={}))})(ac);(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Ha,r),e(Wa,r),e(Ja,r),e(Bs,r),e(ll,r),e(gl,r),e(vl,r),e(ks,r),e(Rs,r),e(Bl,r),e(Fl,r),e(Gl,r),e(Xl,r),e(ac,r),e(ot,r)})(Dt);var dr={},im=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(dr,"__esModule",{value:!0});dr.Store=void 0;const ct=$;class fc extends ct.Basecoat{constructor(t={}){super();this.pending=!1,this.changing=!1,this.data={},this.mutate(ct.ObjectExt.cloneDeep(t)),this.changed={}}mutate(t,e={}){const n=e.unset===!0,s=e.silent===!0,a=[],u=this.changing;this.changing=!0,u||(this.previous=ct.ObjectExt.cloneDeep(this.data),this.changed={});const h=this.data,d=this.previous,c=this.changed;if(Object.keys(t).forEach(i=>{const o=i,l=t[o];ct.ObjectExt.isEqual(h[o],l)||a.push(o),ct.ObjectExt.isEqual(d[o],l)?delete c[o]:c[o]=l,n?delete h[o]:h[o]=l}),!s&&a.length>0&&(this.pending=!0,this.pendingOptions=e,a.forEach(i=>{this.emit("change:*",{key:i,options:e,store:this,current:h[i],previous:d[i]})})),u)return this;if(!s)for(;this.pending;)this.pending=!1,this.emit("changed",{current:h,previous:d,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(t,e){if(t==null)return this.data;const n=this.data[t];return n==null?e:n}getPrevious(t){if(this.previous){const e=this.previous[t];return e==null?void 0:e}}set(t,e,n){return t!=null&&(typeof t=="object"?this.mutate(t,e):this.mutate({[t]:e},n)),this}remove(t,e){const n=void 0,s={};let a;if(typeof t=="string")s[t]=n,a=e;else if(Array.isArray(t))t.forEach(u=>s[u]=n),a=e;else{for(const u in this.data)s[u]=n;a=t}return this.mutate(s,Object.assign(Object.assign({},a),{unset:!0})),this}getByPath(t){return ct.ObjectExt.getByPath(this.data,t,"/")}setByPath(t,e,n={}){const s="/",a=Array.isArray(t)?[...t]:t.split(s),u=Array.isArray(t)?t.join(s):t,h=a[0],d=a.length;if(n.propertyPath=u,n.propertyValue=e,n.propertyPathArray=a,d===1)this.set(h,e,n);else{const c={};let i=c,o=h;for(let g=1;g<d;g+=1){const p=a[g],m=Number.isFinite(Number(p));i=i[o]=m?[]:{},o=p}ct.ObjectExt.setByPath(c,a,e,s);const l=ct.ObjectExt.cloneDeep(this.data);n.rewrite&&ct.ObjectExt.unsetByPath(l,t,s);const f=ct.ObjectExt.merge(l,c);this.set(h,f[h],n)}return this}removeByPath(t,e){const n=Array.isArray(t)?t:t.split("/"),s=n[0];if(n.length===1)this.remove(s,e);else{const a=n.slice(1),u=ct.ObjectExt.cloneDeep(this.get(s));u&&ct.ObjectExt.unsetByPath(u,a),this.set(s,u,e)}return this}hasChanged(t){return t==null?Object.keys(this.changed).length>0:t in this.changed}getChanges(t){if(t==null)return this.hasChanged()?ct.ObjectExt.cloneDeep(this.changed):null;const e=this.changing?this.previous:this.data,n={};let s;for(const a in t){const u=t[a];ct.ObjectExt.isEqual(e[a],u)||(n[a]=u,s=!0)}return s?ct.ObjectExt.cloneDeep(n):null}toJSON(){return ct.ObjectExt.cloneDeep(this.data)}clone(){const t=this.constructor;return new t(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}im([ct.Basecoat.dispose()],fc.prototype,"dispose",null);dr.Store=fc;var gc={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Animation=void 0;const t=$;class e{constructor(s){this.cell=s,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(s,a,u={},h="/"){const d=this.cell.getPropByPath(s),c=t.ObjectExt.defaults(u,e.defaultOptions),i=this.getTiming(c.timing),o=this.getInterp(c.interp,d,a);let l=0;const f=Array.isArray(s)?s.join(h):s,g=Array.isArray(s)?s:s.split(h),p=()=>{const m=new Date().getTime();l===0&&(l=m);let b=(m-l)/c.duration;b<1?this.ids[f]=requestAnimationFrame(p):b=1;const v=o(i(b));this.cell.setPropByPath(g,v),u.progress&&u.progress(Object.assign({progress:b,currentValue:v},this.getArgs(f))),b===1&&(this.cell.notify("transition:complete",this.getArgs(f)),u.complete&&u.complete(this.getArgs(f)),this.cell.notify("transition:finish",this.getArgs(f)),u.finish&&u.finish(this.getArgs(f)),this.clean(f))};return setTimeout(()=>{this.stop(s,void 0,h),this.cache[f]={startValue:d,targetValue:a,options:c},this.ids[f]=requestAnimationFrame(p),this.cell.notify("transition:start",this.getArgs(f)),u.start&&u.start(this.getArgs(f))},u.delay),this.stop.bind(this,s,h,u)}stop(s,a={},u="/"){const h=Array.isArray(s)?s:s.split(u);return Object.keys(this.ids).filter(d=>t.ObjectExt.isEqual(h,d.split(u).slice(0,h.length))).forEach(d=>{cancelAnimationFrame(this.ids[d]);const c=this.cache[d],i=this.getArgs(d),o=Object.assign(Object.assign({},c.options),a),l=o.jumpedToEnd;l&&c.targetValue!=null&&(this.cell.setPropByPath(d,c.targetValue),this.cell.notify("transition:end",Object.assign({},i)),this.cell.notify("transition:complete",Object.assign({},i)),o.complete&&o.complete(Object.assign({},i)));const f=Object.assign({jumpedToEnd:l},i);this.cell.notify("transition:stop",Object.assign({},f)),o.stop&&o.stop(Object.assign({},f)),this.cell.notify("transition:finish",Object.assign({},i)),o.finish&&o.finish(Object.assign({},i)),this.clean(d)}),this}clean(s){delete this.ids[s],delete this.cache[s]}getTiming(s){return typeof s=="string"?t.Timing[s]:s}getInterp(s,a,u){return s?s(a,u):typeof u=="number"?t.Interp.number(a,u):typeof u=="string"?u[0]==="#"?t.Interp.color(a,u):t.Interp.unit(a,u):t.Interp.object(a,u)}getArgs(s){const a=this.cache[s];return{path:s,startValue:a.startValue,targetValue:a.targetValue,cell:this.cell}}}r.Animation=e,function(n){n.defaultOptions={delay:10,duration:100,timing:"linear"}}(e=r.Animation||(r.Animation={}))})(gc);(function(r){var t=E&&E.__decorate||function(c,i,o,l){var f=arguments.length,g=f<3?i:l===null?l=Object.getOwnPropertyDescriptor(i,o):l,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,i,o,l);else for(var m=c.length-1;m>=0;m--)(p=c[m])&&(g=(f<3?p(g):f>3?p(i,o,g):p(i,o))||g);return f>3&&g&&Object.defineProperty(i,o,g),g},e=E&&E.__rest||function(c,i){var o={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&i.indexOf(l)<0&&(o[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(c);f<l.length;f++)i.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(c,l[f])&&(o[l[f]]=c[l[f]]);return o};Object.defineProperty(r,"__esModule",{value:!0}),r.Cell=void 0;const n=$,s=I,a=Dt,u=dr,h=gc;class d extends n.Basecoat{static config(i){const{markup:o,propHooks:l,attrHooks:f}=i,g=e(i,["markup","propHooks","attrHooks"]);o!=null&&(this.markup=o),l&&(this.propHooks=this.propHooks.slice(),Array.isArray(l)?this.propHooks.push(...l):typeof l=="function"?this.propHooks.push(l):Object.values(l).forEach(p=>{typeof p=="function"&&this.propHooks.push(p)})),f&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),f)),this.defaults=n.ObjectExt.merge({},this.defaults,g)}static getMarkup(){return this.markup}static getDefaults(i){return i?this.defaults:n.ObjectExt.cloneDeep(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(i,o){return this.propHooks.reduce((l,f)=>f?n.FunctionExt.call(f,i,l):l,o)}get[Symbol.toStringTag](){return d.toStringTag}constructor(i={}){super();const l=this.constructor.getDefaults(!0),f=n.ObjectExt.merge({},this.preprocess(l),this.preprocess(i));this.id=f.id||n.StringExt.uuid(),this.store=new u.Store(f),this.animation=new h.Animation(this),this.setup(),this.init(),this.postprocess(i)}init(){}get model(){return this._model}set model(i){this._model!==i&&(this._model=i)}preprocess(i,o){const l=i.id,g=this.constructor.applyPropHooks(this,i);return l==null&&o!==!0&&(g.id=n.StringExt.uuid()),g}postprocess(i){}setup(){this.store.on("change:*",i=>{const{key:o,current:l,previous:f,options:g}=i;this.notify("change:*",{key:o,options:g,current:l,previous:f,cell:this}),this.notify(`change:${o}`,{options:g,current:l,previous:f,cell:this});const p=o;(p==="source"||p==="target")&&this.notify("change:terminal",{type:p,current:l,previous:f,options:g,cell:this})}),this.store.on("changed",({options:i})=>this.notify("changed",{options:i,cell:this}))}notify(i,o){this.trigger(i,o);const l=this.model;return l&&(l.notify(`cell:${i}`,o),this.isNode()?l.notify(`node:${i}`,Object.assign(Object.assign({},o),{node:this})):this.isEdge()&&l.notify(`edge:${i}`,Object.assign(Object.assign({},o),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(i){return this.store===i.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(i,o){return i==null?this.store.get():this.store.get(i,o)}setProp(i,o,l){if(typeof i=="string")this.store.set(i,o,l);else{const f=this.preprocess(i,!0);this.store.set(n.ObjectExt.merge({},this.getProp(),f),o),this.postprocess(i)}return this}removeProp(i,o){return typeof i=="string"||Array.isArray(i)?this.store.removeByPath(i,o):this.store.remove(o),this}hasChanged(i){return i==null?this.store.hasChanged():this.store.hasChanged(i)}getPropByPath(i){return this.store.getByPath(i)}setPropByPath(i,o,l={}){return this.model&&(i==="children"?this._children=o?o.map(f=>this.model.getCell(f)).filter(f=>f!=null):null:i==="parent"&&(this._parent=o?this.model.getCell(o):null)),this.store.setByPath(i,o,l),this}removePropByPath(i,o={}){const l=Array.isArray(i)?i:i.split("/");return l[0]==="attrs"&&(o.dirty=!0),this.store.removeByPath(l,o),this}prop(i,o,l){return i==null?this.getProp():typeof i=="string"||Array.isArray(i)?arguments.length===1?this.getPropByPath(i):o==null?this.removePropByPath(i,l||{}):this.setPropByPath(i,o,l||{}):this.setProp(i,o||{})}previous(i){return this.store.getPrevious(i)}get zIndex(){return this.getZIndex()}set zIndex(i){i==null?this.removeZIndex():this.setZIndex(i)}getZIndex(){return this.store.get("zIndex")}setZIndex(i,o={}){return this.store.set("zIndex",i,o),this}removeZIndex(i={}){return this.store.remove("zIndex",i),this}toFront(i={}){const o=this.model;if(o){let l=o.getMaxZIndex(),f;i.deep?(f=this.getDescendants({deep:!0,breadthFirst:!0}),f.unshift(this)):f=[this],l=l-f.length+1;const g=o.total();let p=o.indexOf(this)!==g-f.length;p||(p=f.some((m,y)=>m.getZIndex()!==l+y)),p&&this.batchUpdate("to-front",()=>{l+=f.length,f.forEach((m,y)=>{m.setZIndex(l+y,i)})})}return this}toBack(i={}){const o=this.model;if(o){let l=o.getMinZIndex(),f;i.deep?(f=this.getDescendants({deep:!0,breadthFirst:!0}),f.unshift(this)):f=[this];let g=o.indexOf(this)!==0;g||(g=f.some((p,m)=>p.getZIndex()!==l+m)),g&&this.batchUpdate("to-back",()=>{l-=f.length,f.forEach((p,m)=>{p.setZIndex(l+m,i)})})}return this}get markup(){return this.getMarkup()}set markup(i){i==null?this.removeMarkup():this.setMarkup(i)}getMarkup(){let i=this.store.get("markup");return i==null&&(i=this.constructor.getMarkup()),i}setMarkup(i,o={}){return this.store.set("markup",i,o),this}removeMarkup(i={}){return this.store.remove("markup",i),this}get attrs(){return this.getAttrs()}set attrs(i){i==null?this.removeAttrs():this.setAttrs(i)}getAttrs(){const i=this.store.get("attrs");return i?Object.assign({},i):{}}setAttrs(i,o={}){if(i==null)this.removeAttrs(o);else{const l=f=>this.store.set("attrs",f,o);if(o.overwrite===!0)l(i);else{const f=this.getAttrs();o.deep===!1?l(Object.assign(Object.assign({},f),i)):l(n.ObjectExt.merge({},f,i))}}return this}replaceAttrs(i,o={}){return this.setAttrs(i,Object.assign(Object.assign({},o),{overwrite:!0}))}updateAttrs(i,o={}){return this.setAttrs(i,Object.assign(Object.assign({},o),{deep:!1}))}removeAttrs(i={}){return this.store.remove("attrs",i),this}getAttrDefinition(i){if(!i)return null;const l=this.constructor.getAttrHooks()||{};let f=l[i]||a.Attr.registry.get(i);if(!f){const g=n.StringExt.camelCase(i);f=l[g]||a.Attr.registry.get(g)}return f||null}getAttrByPath(i){return i==null||i===""?this.getAttrs():this.getPropByPath(this.prefixAttrPath(i))}setAttrByPath(i,o,l={}){return this.setPropByPath(this.prefixAttrPath(i),o,l),this}removeAttrByPath(i,o={}){return this.removePropByPath(this.prefixAttrPath(i),o),this}prefixAttrPath(i){return Array.isArray(i)?["attrs"].concat(i):`attrs/${i}`}attr(i,o,l){return i==null?this.getAttrByPath():typeof i=="string"||Array.isArray(i)?arguments.length===1?this.getAttrByPath(i):o==null?this.removeAttrByPath(i,l||{}):this.setAttrByPath(i,o,l||{}):this.setAttrs(i,o||{})}get visible(){return this.isVisible()}set visible(i){this.setVisible(i)}setVisible(i,o={}){return this.store.set("visible",i,o),this}isVisible(){return this.store.get("visible")!==!1}show(i={}){return this.isVisible()||this.setVisible(!0,i),this}hide(i={}){return this.isVisible()&&this.setVisible(!1,i),this}toggleVisible(i,o={}){const l=typeof i=="boolean"?i:!this.isVisible(),f=typeof i=="boolean"?o:i;return l?this.show(f):this.hide(f),this}get data(){return this.getData()}set data(i){this.setData(i)}getData(){return this.store.get("data")}setData(i,o={}){if(i==null)this.removeData(o);else{const l=f=>this.store.set("data",f,o);if(o.overwrite===!0)l(i);else{const f=this.getData();o.deep===!1?l(typeof i=="object"?Object.assign(Object.assign({},f),i):i):l(n.ObjectExt.merge({},f,i))}}return this}replaceData(i,o={}){return this.setData(i,Object.assign(Object.assign({},o),{overwrite:!0}))}updateData(i,o={}){return this.setData(i,Object.assign(Object.assign({},o),{deep:!1}))}removeData(i={}){return this.store.remove("data",i),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const i=this.getParentId();if(i&&this.model){const o=this.model.getCell(i);return this._parent=o,o}return null}getChildren(){const i=this.store.get("children");if(i&&i.length&&this.model){const o=i.map(l=>{var f;return(f=this.model)===null||f===void 0?void 0:f.getCell(l)}).filter(l=>l!=null);return this._children=o,[...o]}return null}hasParent(){return this.parent!=null}isParentOf(i){return i!=null&&i.getParent()===this}isChildOf(i){return i!=null&&this.getParent()===i}eachChild(i,o){return this.children&&this.children.forEach(i,o),this}filterChild(i,o){return this.children?this.children.filter(i,o):[]}getChildCount(){return this.children==null?0:this.children.length}getChildIndex(i){return this.children==null?-1:this.children.indexOf(i)}getChildAt(i){return this.children!=null&&i>=0?this.children[i]:null}getAncestors(i={}){const o=[];let l=this.getParent();for(;l;)o.push(l),l=i.deep!==!1?l.getParent():null;return o}getDescendants(i={}){if(i.deep!==!1){if(i.breadthFirst){const o=[],l=this.getChildren()||[];for(;l.length>0;){const f=l.shift(),g=f.getChildren();o.push(f),g&&l.push(...g)}return o}{const o=this.getChildren()||[];return o.forEach(l=>{o.push(...l.getDescendants(i))}),o}}return this.getChildren()||[]}isDescendantOf(i,o={}){if(i==null)return!1;if(o.deep!==!1){let l=this.getParent();for(;l;){if(l===i)return!0;l=l.getParent()}return!1}return this.isChildOf(i)}isAncestorOf(i,o={}){return i==null?!1:i.isDescendantOf(this,o)}contains(i){return this.isAncestorOf(i)}getCommonAncestor(...i){return d.getCommonAncestor(this,...i)}setParent(i,o={}){return this._parent=i,i?this.store.set("parent",i.id,o):this.store.remove("parent",o),this}setChildren(i,o={}){return this._children=i,i!=null?this.store.set("children",i.map(l=>l.id),o):this.store.remove("children",o),this}unembed(i,o={}){const l=this.children;if(l!=null&&i!=null){const f=this.getChildIndex(i);f!==-1&&(l.splice(f,1),i.setParent(null,o),this.setChildren(l,o))}return this}embed(i,o={}){return i.addTo(this,o),this}addTo(i,o={}){return d.isCell(i)?i.addChild(this,o):i.addCell(this,o),this}insertTo(i,o,l={}){return i.insertChild(this,o,l),this}addChild(i,o={}){return this.insertChild(i,void 0,o)}insertChild(i,o,l={}){if(i!=null&&i!==this){const f=i.getParent(),g=this!==f;let p=o;if(p==null&&(p=this.getChildCount(),g||(p-=1)),f){const y=f.getChildren();if(y){const b=y.indexOf(i);b>=0&&(i.setParent(null,l),y.splice(b,1),f.setChildren(y,l))}}let m=this.children;if(m==null?(m=[],m.push(i)):m.splice(p,0,i),i.setParent(this,l),this.setChildren(m,l),g&&this.model){const y=this.model.getIncomingEdges(this),b=this.model.getOutgoingEdges(this);y&&y.forEach(v=>v.updateParent(l)),b&&b.forEach(v=>v.updateParent(l))}this.model&&this.model.addCell(i,l)}return this}removeFromParent(i={}){const o=this.getParent();if(o!=null){const l=o.getChildIndex(this);o.removeChildAt(l,i)}return this}removeChild(i,o={}){const l=this.getChildIndex(i);return this.removeChildAt(l,o)}removeChildAt(i,o={}){const l=this.getChildAt(i);return this.children!=null&&l!=null&&(this.unembed(l,o),l.remove(o)),l}remove(i={}){return this.batchUpdate("remove",()=>{const o=this.getParent();o&&o.removeChild(this,i),i.deep!==!1&&this.eachChild(l=>l.remove(i)),this.model&&this.model.removeCell(this,i)}),this}transition(i,o,l={},f="/"){return this.animation.start(i,o,l,f)}stopTransition(i,o,l="/"){return this.animation.stop(i,o,l),this}getTransitions(){return this.animation.get()}translate(i,o,l){return this}scale(i,o,l,f){return this}addTools(i,o,l){const f=Array.isArray(i)?i:[i],g=typeof o=="string"?o:null,p=typeof o=="object"?o:typeof l=="object"?l:{};if(p.reset)return this.setTools({name:g,items:f,local:p.local},p);let m=n.ObjectExt.cloneDeep(this.getTools());if(m==null||g==null||m.name===g)return m==null&&(m={}),m.items||(m.items=[]),m.name=g,m.items=[...m.items,...f],this.setTools(Object.assign({},m),p)}setTools(i,o={}){return i==null?this.removeTools():this.store.set("tools",d.normalizeTools(i),o),this}getTools(){return this.store.get("tools")}removeTools(i={}){return this.store.remove("tools",i),this}hasTools(i){const o=this.getTools();return o==null?!1:i==null?!0:o.name===i}hasTool(i){const o=this.getTools();return o==null?!1:o.items.some(l=>typeof l=="string"?l===i:l.name===i)}removeTool(i,o={}){const l=n.ObjectExt.cloneDeep(this.getTools());if(l){let f=!1;const g=l.items.slice(),p=m=>{g.splice(m,1),f=!0};if(typeof i=="number")p(i);else for(let m=g.length-1;m>=0;m-=1){const y=g[m];(typeof y=="string"?y===i:y.name===i)&&p(m)}f&&(l.items=g,this.setTools(l,o))}return this}getBBox(i){return new s.Rectangle}getConnectionPoint(i,o){return new s.Point}toJSON(i={}){const o=Object.assign({},this.store.get()),l=Object.prototype.toString,f=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!o.shape){const _=this.constructor;throw new Error(`Unable to serialize ${f} missing "shape" prop, check the ${f} "${_.name||l.call(_)}"`)}const g=this.constructor,p=i.diff===!0,m=o.attrs||{},y=g.getDefaults(!0),b=p?this.preprocess(y,!0):y,v=b.attrs||{},x={};Object.entries(o).forEach(([_,A])=>{if(A!=null&&!Array.isArray(A)&&typeof A=="object"&&!n.ObjectExt.isPlainObject(A))throw new Error(`Can only serialize ${f} with plain-object props, but got a "${l.call(A)}" type of key "${_}" on ${f} "${this.id}"`);if(_!=="attrs"&&_!=="shape"&&p){const S=b[_];n.ObjectExt.isEqual(A,S)&&delete o[_]}}),Object.keys(m).forEach(_=>{const A=m[_],S=v[_];Object.keys(A).forEach(w=>{const O=A[w],M=S?S[w]:null;O!=null&&typeof O=="object"&&!Array.isArray(O)?Object.keys(O).forEach(T=>{const j=O[T];if(S==null||M==null||!n.ObjectExt.isObject(M)||!n.ObjectExt.isEqual(M[T],j)){x[_]==null&&(x[_]={}),x[_][w]==null&&(x[_][w]={});const N=x[_][w];N[T]=j}}):(S==null||!n.ObjectExt.isEqual(M,O))&&(x[_]==null&&(x[_]={}),x[_][w]=O)})});const P=Object.assign(Object.assign({},o),{attrs:n.ObjectExt.isEmpty(x)?void 0:x});P.attrs==null&&delete P.attrs;const C=P;return C.angle===0&&delete C.angle,n.ObjectExt.cloneDeep(C)}clone(i={}){if(!i.deep){const l=Object.assign({},this.store.get());i.keepId||delete l.id,delete l.parent,delete l.children;const f=this.constructor;return new f(l)}return d.deepClone(this)[this.id]}findView(i){return i.findViewByCell(this)}startBatch(i,o={},l=this.model){return this.notify("batch:start",{name:i,data:o,cell:this}),l&&l.startBatch(i,Object.assign(Object.assign({},o),{cell:this})),this}stopBatch(i,o={},l=this.model){return l&&l.stopBatch(i,Object.assign(Object.assign({},o),{cell:this})),this.notify("batch:stop",{name:i,data:o,cell:this}),this}batchUpdate(i,o,l){const f=this.model;this.startBatch(i,l,f);const g=o();return this.stopBatch(i,l,f),g}dispose(){this.removeFromParent(),this.store.dispose()}}d.defaults={},d.attrHooks={},d.propHooks=[],t([n.Basecoat.dispose()],d.prototype,"dispose",null),r.Cell=d,function(c){function i(o){return typeof o=="string"?{items:[o]}:Array.isArray(o)?{items:o}:o.items?o:{items:[o]}}c.normalizeTools=i}(d=r.Cell||(r.Cell={})),function(c){c.toStringTag=`X6.${c.name}`;function i(o){if(o==null)return!1;if(o instanceof c)return!0;const l=o[Symbol.toStringTag],f=o;return(l==null||l===c.toStringTag)&&typeof f.isNode=="function"&&typeof f.isEdge=="function"&&typeof f.prop=="function"&&typeof f.attr=="function"}c.isCell=i}(d=r.Cell||(r.Cell={})),function(c){function i(...g){const p=g.filter(y=>y!=null).map(y=>y.getAncestors()).sort((y,b)=>y.length-b.length);return p.shift().find(y=>p.every(b=>b.includes(y)))||null}c.getCommonAncestor=i;function o(g,p={}){let m=null;for(let y=0,b=g.length;y<b;y+=1){const v=g[y];let x=v.getBBox(p);if(x){if(v.isNode()){const P=v.getAngle();P!=null&&P!==0&&(x=x.bbox(P))}m=m==null?x:m.union(x)}}return m}c.getCellsBBox=o;function l(g){const p=[g,...g.getDescendants({deep:!0})];return c.cloneCells(p)}c.deepClone=l;function f(g){const p=n.ArrayExt.uniq(g),m=p.reduce((y,b)=>(y[b.id]=b.clone(),y),{});return p.forEach(y=>{const b=m[y.id];if(b.isEdge()){const P=b.getSourceCellId(),C=b.getTargetCellId();P&&m[P]&&b.setSource(Object.assign(Object.assign({},b.getSource()),{cell:m[P].id})),C&&m[C]&&b.setTarget(Object.assign(Object.assign({},b.getTarget()),{cell:m[C].id}))}const v=y.getParent();v&&m[v.id]&&b.setParent(m[v.id]);const x=y.getChildren();if(x&&x.length){const P=x.reduce((C,_)=>(m[_.id]&&C.push(m[_.id]),C),[]);P.length>0&&b.setChildren(P)}}),m}c.cloneCells=f}(d=r.Cell||(r.Cell={})),function(c){c.config({propHooks(i){var{tools:o}=i,l=e(i,["tools"]);return o&&(l.tools=c.normalizeTools(o)),l}})}(d=r.Cell||(r.Cell={}))})(Fe);var fr={},eo={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ShareRegistry=void 0,function(t){let e,n;function s(h,d){return d?e!=null&&e.exist(h):n!=null&&n.exist(h)}t.exist=s;function a(h){e=h}t.setEdgeRegistry=a;function u(h){n=h}t.setNodeRegistry=u}(r.ShareRegistry||(r.ShareRegistry={}))})(eo);var gr={};Object.defineProperty(gr,"__esModule",{value:!0});gr.PortManager=void 0;const pr=$,rm=I,_n=Dt;class sm{constructor(t){this.ports=[],this.groups={},this.init(pr.ObjectExt.cloneDeep(t))}getPorts(){return this.ports}getGroup(t){return t!=null?this.groups[t]:null}getPortsByGroup(t){return this.ports.filter(e=>e.group===t||e.group==null&&t==null)}getPortsLayoutByGroup(t,e){const n=this.getPortsByGroup(t),s=t?this.getGroup(t):null,a=s?s.position:null,u=a?a.name:null;let h;if(u!=null){const o=_n.PortLayout.registry.get(u);if(o==null)return _n.PortLayout.registry.onNotFound(u);h=o}else h=_n.PortLayout.presets.left;const d=n.map(o=>o&&o.position&&o.position.args||{}),c=a&&a.args||{};return h(d,e,c).map((o,l)=>{const f=n[l];return{portLayout:o,portId:f.id,portSize:f.size,portAttrs:f.attrs,labelSize:f.label.size,labelLayout:this.getPortLabelLayout(f,rm.Point.create(o.position),e)}})}init(t){const{groups:e,items:n}=t;e!=null&&Object.keys(e).forEach(s=>{this.groups[s]=this.parseGroup(e[s])}),Array.isArray(n)&&n.forEach(s=>{this.ports.push(this.parsePort(s))})}parseGroup(t){return Object.assign(Object.assign({},t),{label:this.getLabel(t,!0),position:this.getPortPosition(t.position,!0)})}parsePort(t){const e=Object.assign({},t),n=this.getGroup(t.group)||{};return e.markup=e.markup||n.markup,e.attrs=pr.ObjectExt.merge({},n.attrs,e.attrs),e.position=this.createPosition(n,e),e.label=pr.ObjectExt.merge({},n.label,this.getLabel(e)),e.zIndex=this.getZIndex(n,e),e.size=Object.assign(Object.assign({},n.size),e.size),e}getZIndex(t,e){return typeof e.zIndex=="number"?e.zIndex:typeof t.zIndex=="number"||t.zIndex==="auto"?t.zIndex:"auto"}createPosition(t,e){return pr.ObjectExt.merge({name:"left",args:{}},t.position,{args:e.args})}getPortPosition(t,e=!1){if(t==null){if(e)return{name:"left",args:{}}}else{if(typeof t=="string")return{name:t,args:{}};if(Array.isArray(t))return{name:"absolute",args:{x:t[0],y:t[1]}};if(typeof t=="object")return t}return{args:{}}}getPortLabelPosition(t,e=!1){if(t==null){if(e)return{name:"left",args:{}}}else{if(typeof t=="string")return{name:t,args:{}};if(typeof t=="object")return t}return{args:{}}}getLabel(t,e=!1){const n=t.label||{};return n.position=this.getPortLabelPosition(n.position,e),n}getPortLabelLayout(t,e,n){const s=t.label.position.name||"left",a=t.label.position.args||{},u=_n.PortLabelLayout.registry.get(s)||_n.PortLabelLayout.presets.left;return u?u(e,n,a):null}}gr.PortManager=sm;(function(r){var t=E&&E.__rest||function(i,o){var l={};for(var f in i)Object.prototype.hasOwnProperty.call(i,f)&&o.indexOf(f)<0&&(l[f]=i[f]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,f=Object.getOwnPropertySymbols(i);g<f.length;g++)o.indexOf(f[g])<0&&Object.prototype.propertyIsEnumerable.call(i,f[g])&&(l[f[g]]=i[f[g]]);return l};Object.defineProperty(r,"__esModule",{value:!0}),r.Node=void 0;const e=I,n=$,s=ot,a=Oe,u=Fe,h=eo,d=gr;class c extends u.Cell{get[Symbol.toStringTag](){return c.toStringTag}constructor(o={}){super(o);this.initPorts()}preprocess(o,l){const{x:f,y:g,width:p,height:m}=o,y=t(o,["x","y","width","height"]);if(f!=null||g!=null){const b=y.position;y.position=Object.assign(Object.assign({},b),{x:f!=null?f:b?b.x:0,y:g!=null?g:b?b.y:0})}if(p!=null||m!=null){const b=y.size;y.size=Object.assign(Object.assign({},b),{width:p!=null?p:b?b.width:0,height:m!=null?m:b?b.height:0})}return super.preprocess(y,l)}isNode(){return!0}size(o,l,f){return o===void 0?this.getSize():typeof o=="number"?this.setSize(o,l,f):this.setSize(o,l)}getSize(){const o=this.store.get("size");return o?Object.assign({},o):{width:1,height:1}}setSize(o,l,f){return typeof o=="object"?this.resize(o.width,o.height,l):this.resize(o,l,f),this}resize(o,l,f={}){this.startBatch("resize",f);const g=f.direction;if(g){const p=this.getSize();switch(g){case"left":case"right":l=p.height;break;case"top":case"bottom":o=p.width;break}let y={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[g];const b=e.Angle.normalize(this.getAngle()||0);f.absolute&&(y+=Math.floor((b+45)/90),y%=4);const v=this.getBBox();let x;y===0?x=v.getBottomLeft():y===1?x=v.getCorner():y===2?x=v.getTopRight():x=v.getOrigin();const P=x.clone().rotate(-b,v.getCenter()),C=Math.sqrt(o*o+l*l)/2;let _=y*Math.PI/2;_+=Math.atan(y%2==0?l/o:o/l),_-=e.Angle.toRad(b);const S=e.Point.fromPolar(C,_,P).clone().translate(o/-2,l/-2);this.store.set("size",{width:o,height:l},f),this.setPosition(S.x,S.y,f)}else this.store.set("size",{width:o,height:l},f);return this.stopBatch("resize",f),this}scale(o,l,f,g={}){const p=this.getBBox().scale(o,l,f==null?void 0:f);return this.startBatch("scale",g),this.setPosition(p.x,p.y,g),this.resize(p.width,p.height,g),this.stopBatch("scale"),this}position(o,l,f){return typeof o=="number"?this.setPosition(o,l,f):this.getPosition(o)}getPosition(o={}){if(o.relative){const f=this.getParent();if(f!=null&&f.isNode()){const g=this.getPosition(),p=f.getPosition();return{x:g.x-p.x,y:g.y-p.y}}}const l=this.store.get("position");return l?Object.assign({},l):{x:0,y:0}}setPosition(o,l,f={}){let g,p,m;if(typeof o=="object"?(g=o.x,p=o.y,m=l||{}):(g=o,p=l,m=f||{}),m.relative){const y=this.getParent();if(y!=null&&y.isNode()){const b=y.getPosition();g+=b.x,p+=b.y}}if(m.deep){const y=this.getPosition();this.translate(g-y.x,p-y.y,m)}else this.store.set("position",{x:g,y:p},m);return this}translate(o=0,l=0,f={}){if(o===0&&l===0)return this;f.translateBy=f.translateBy||this.id;const g=this.getPosition();if(f.restrict!=null&&f.translateBy===this.id){const m=this.getBBox({deep:!0}),y=f.restrict,b=g.x-m.x,v=g.y-m.y,x=Math.max(y.x+b,Math.min(y.x+y.width+b-m.width,g.x+o)),P=Math.max(y.y+v,Math.min(y.y+y.height+v-m.height,g.y+l));o=x-g.x,l=P-g.y}const p={x:g.x+o,y:g.y+l};return f.tx=o,f.ty=l,f.transition?(typeof f.transition!="object"&&(f.transition={}),this.transition("position",p,Object.assign(Object.assign({},f.transition),{interp:n.Interp.object})),this.eachChild(m=>{var y;((y=f.exclude)===null||y===void 0?void 0:y.includes(m))||m.translate(o,l,f)})):(this.startBatch("translate",f),this.store.set("position",p,f),this.eachChild(m=>{var y;((y=f.exclude)===null||y===void 0?void 0:y.includes(m))||m.translate(o,l,f)}),this.stopBatch("translate",f)),this}angle(o,l){return o==null?this.getAngle():this.rotate(o,l)}getAngle(){return this.store.get("angle",0)}rotate(o,l={}){const f=this.getAngle();if(l.center){const g=this.getSize(),p=this.getPosition(),m=this.getBBox().getCenter();m.rotate(f-o,l.center);const y=m.x-g.width/2-p.x,b=m.y-g.height/2-p.y;this.startBatch("rotate",{angle:o,options:l}),this.setPosition(p.x+y,p.y+b,l),this.rotate(o,Object.assign(Object.assign({},l),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",l.absolute?o:(f+o)%360,l);return this}getBBox(o={}){if(o.deep){const l=this.getDescendants({deep:!0,breadthFirst:!0});return l.push(this),u.Cell.getCellsBBox(l)}return e.Rectangle.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(o,l){const f=this.getBBox(),g=f.getCenter(),p=o.getTerminal(l);if(p==null)return g;const m=p.port;if(!m||!this.hasPort(m))return g;const y=this.getPort(m);if(!y||!y.group)return g;const v=this.getPortsPosition(y.group)[m].position,x=e.Point.create(v).translate(f.getOrigin()),P=this.getAngle();return P&&x.rotate(-P,g),x}fit(o={}){const f=(this.getChildren()||[]).filter(v=>v.isNode());if(f.length===0)return this;this.startBatch("fit-embeds",o),o.deep&&f.forEach(v=>v.fit(o));let{x:g,y:p,width:m,height:y}=u.Cell.getCellsBBox(f);const b=n.NumberExt.normalizeSides(o.padding);return g-=b.left,p-=b.top,m+=b.left+b.right,y+=b.bottom+b.top,this.store.set({position:{x:g,y:p},size:{width:m,height:y}},o),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(o){this.setPortContainerMarkup(o)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||a.Markup.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(o,l={}){return this.store.set("portContainerMarkup",a.Markup.clone(o),l),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(o){this.setPortMarkup(o)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||a.Markup.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(o,l={}){return this.store.set("portMarkup",a.Markup.clone(o),l),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(o){this.setPortLabelMarkup(o)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||a.Markup.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(o,l={}){return this.store.set("portLabelMarkup",a.Markup.clone(o),l),this}get ports(){const o=this.store.get("ports",{items:[]});return o.items==null&&(o.items=[]),o}getPorts(){return n.ObjectExt.cloneDeep(this.ports.items)}getPortsByGroup(o){return this.getPorts().filter(l=>l.group===o)}getPort(o){return n.ObjectExt.cloneDeep(this.ports.items.find(l=>l.id&&l.id===o))}getPortAt(o){return this.ports.items[o]||null}hasPorts(){return this.ports.items.length>0}hasPort(o){return this.getPortIndex(o)!==-1}getPortIndex(o){const l=typeof o=="string"?o:o.id;return l!=null?this.ports.items.findIndex(f=>f.id===l):-1}getPortsPosition(o){const l=this.getSize();return this.port.getPortsLayoutByGroup(o,new e.Rectangle(0,0,l.width,l.height)).reduce((g,p)=>{const m=p.portLayout;return g[p.portId]={position:Object.assign({},m.position),angle:m.angle||0},g},{})}getPortProp(o,l){return this.getPropByPath(this.prefixPortPath(o,l))}setPortProp(o,l,f,g){if(typeof l=="string"||Array.isArray(l)){const y=this.prefixPortPath(o,l),b=f;return this.setPropByPath(y,b,g)}const p=this.prefixPortPath(o),m=l;return this.setPropByPath(p,m,f)}removePortProp(o,l,f){return typeof l=="string"||Array.isArray(l)?this.removePropByPath(this.prefixPortPath(o,l),f):this.removePropByPath(this.prefixPortPath(o),l)}portProp(o,l,f,g){return l==null?this.getPortProp(o):typeof l=="string"||Array.isArray(l)?arguments.length===2?this.getPortProp(o,l):f==null?this.removePortProp(o,l,g):this.setPortProp(o,l,f,g):this.setPortProp(o,l,f)}prefixPortPath(o,l){const f=this.getPortIndex(o);if(f===-1)throw new Error(`Unable to find port with id: "${o}"`);return l==null||l===""?["ports","items",`${f}`]:Array.isArray(l)?["ports","items",`${f}`,...l]:`ports/items/${f}/${l}`}addPort(o,l){const f=[...this.ports.items];return f.push(o),this.setPropByPath("ports/items",f,l),this}addPorts(o,l){return this.setPropByPath("ports/items",[...this.ports.items,...o],l),this}insertPort(o,l,f){const g=[...this.ports.items];return g.splice(o,0,l),this.setPropByPath("ports/items",g,f),this}removePort(o,l={}){return this.removePortAt(this.getPortIndex(o),l)}removePortAt(o,l={}){if(o>=0){const f=[...this.ports.items];f.splice(o,1),l.rewrite=!0,this.setPropByPath("ports/items",f,l)}return this}removePorts(o,l){let f;if(Array.isArray(o)){if(f=l||{},o.length){f.rewrite=!0;const p=[...this.ports.items].filter(m=>!o.some(y=>{const b=typeof y=="string"?y:y.id;return m.id===b}));this.setPropByPath("ports/items",p,f)}}else f=o||{},f.rewrite=!0,this.setPropByPath("ports/items",[],f);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(o,l){return this.port.getPortsLayoutByGroup(o,l)}initPorts(){this.updatePortData(),this.on("change:ports",()=>{this.processRemovedPort(),this.updatePortData()})}processRemovedPort(){const o=this.ports,l={};o.items.forEach(m=>{m.id&&(l[m.id]=!0)});const f={};(this.store.getPrevious("ports")||{items:[]}).items.forEach(m=>{m.id&&!l[m.id]&&(f[m.id]=!0)});const p=this.model;p&&!n.ObjectExt.isEmpty(f)&&(p.getConnectedEdges(this,{incoming:!0}).forEach(b=>{const v=b.getTargetPortId();v&&f[v]&&b.remove()}),p.getConnectedEdges(this,{outgoing:!0}).forEach(b=>{const v=b.getSourcePortId();v&&f[v]&&b.remove()}))}validatePorts(){const o={},l=[];return this.ports.items.forEach(f=>{typeof f!="object"&&l.push(`Invalid port ${f}.`),f.id==null&&(f.id=this.generatePortId()),o[f.id]&&l.push("Duplicitied port id."),o[f.id]=!0}),l}generatePortId(){return n.StringExt.uuid()}updatePortData(){const o=this.validatePorts();if(o.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(o.join(" "));const l=this.port?this.port.getPorts():null;this.port=new d.PortManager(this.ports);const f=this.port.getPorts(),g=l?f.filter(m=>l.find(y=>y.id===m.id)?null:m):[...f],p=l?l.filter(m=>f.find(y=>y.id===m.id)?null:m):[];g.length>0&&this.notify("ports:added",{added:g,cell:this,node:this}),p.length>0&&this.notify("ports:removed",{removed:p,cell:this,node:this})}}r.Node=c,c.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(i){i.toStringTag=`X6.${i.name}`;function o(l){if(l==null)return!1;if(l instanceof i)return!0;const f=l[Symbol.toStringTag],g=l;return(f==null||f===i.toStringTag)&&typeof g.isNode=="function"&&typeof g.isEdge=="function"&&typeof g.prop=="function"&&typeof g.attr=="function"&&typeof g.size=="function"&&typeof g.position=="function"}i.isNode=o}(c=r.Node||(r.Node={})),function(i){i.config({propHooks(o){var{ports:l}=o,f=t(o,["ports"]);return l&&(f.ports=Array.isArray(l)?{items:l}:l),f}})}(c=r.Node||(r.Node={})),function(i){i.registry=s.Registry.create({type:"node",process(o,l){if(h.ShareRegistry.exist(o,!0))throw new Error(`Node with name '${o}' was registered by anthor Edge`);if(typeof l=="function")return l.config({shape:o}),l;let f=i;const{inherit:g}=l,p=t(l,["inherit"]);if(g)if(typeof g=="string"){const y=this.get(g);y==null?this.onNotFound(g,"inherited"):f=y}else f=g;p.constructorName==null&&(p.constructorName=o);const m=f.define.call(f,p);return m.config({shape:o}),m}}),h.ShareRegistry.setNodeRegistry(i.registry)}(c=r.Node||(r.Node={})),function(i){let o=0;function l(p){return p?n.StringExt.pascalCase(p):(o+=1,`CustomNode${o}`)}function f(p){const{constructorName:m,overwrite:y}=p,b=t(p,["constructorName","overwrite"]),v=n.ObjectExt.createClass(l(m||b.shape),this);return v.config(b),b.shape&&i.registry.register(b.shape,v,y),v}i.define=f;function g(p){const m=p.shape||"rect",y=i.registry.get(m);return y?new y(p):i.registry.onNotFound(m)}i.create=g}(c=r.Node||(r.Node={}))})(fr);var Sn={};(function(r){var t=E&&E.__rest||function(c,i){var o={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&i.indexOf(l)<0&&(o[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(c);f<l.length;f++)i.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(c,l[f])&&(o[l[f]]=c[l[f]]);return o};Object.defineProperty(r,"__esModule",{value:!0}),r.Edge=void 0;const e=$,n=I,s=ot,a=Oe,u=eo,h=Fe;class d extends h.Cell{get[Symbol.toStringTag](){return d.toStringTag}constructor(i={}){super(i)}preprocess(i,o){const{source:l,sourceCell:f,sourcePort:g,sourcePoint:p,target:m,targetCell:y,targetPort:b,targetPoint:v}=i,P=t(i,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),C=_=>typeof _=="string"||typeof _=="number";if(l!=null)if(h.Cell.isCell(l))P.source={cell:l.id};else if(C(l))P.source={cell:l};else if(n.Point.isPoint(l))P.source=l.toJSON();else if(Array.isArray(l))P.source={x:l[0],y:l[1]};else{const _=l.cell;h.Cell.isCell(_)?P.source=Object.assign(Object.assign({},l),{cell:_.id}):P.source=l}if(f!=null||g!=null){let _=P.source;if(f!=null){const A=C(f)?f:f.id;_?_.cell=A:_=P.source={cell:A}}g!=null&&_&&(_.port=g)}else p!=null&&(P.source=n.Point.create(p).toJSON());if(m!=null)if(h.Cell.isCell(m))P.target={cell:m.id};else if(C(m))P.target={cell:m};else if(n.Point.isPoint(m))P.target=m.toJSON();else if(Array.isArray(m))P.target={x:m[0],y:m[1]};else{const _=m.cell;h.Cell.isCell(_)?P.target=Object.assign(Object.assign({},m),{cell:_.id}):P.target=m}if(y!=null||b!=null){let _=P.target;if(y!=null){const A=C(y)?y:y.id;_?_.cell=A:_=P.target={cell:A}}b!=null&&_&&(_.port=b)}else v!=null&&(P.target=n.Point.create(v).toJSON());return super.preprocess(P,o)}setup(){super.setup(),this.on("change:labels",i=>this.onLabelsChanged(i)),this.on("change:vertices",i=>this.onVertexsChanged(i))}isEdge(){return!0}disconnect(i={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},i),this}get source(){return this.getSource()}set source(i){this.setSource(i)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(i,o,l={}){return this.setTerminal("source",i,o,l)}get target(){return this.getTarget()}set target(i){this.setTarget(i)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(i,o,l={}){return this.setTerminal("target",i,o,l)}getTerminal(i){return Object.assign({},this.store.get(i))}setTerminal(i,o,l,f={}){if(h.Cell.isCell(o))return this.store.set(i,e.ObjectExt.merge({},l,{cell:o.id}),f),this;const g=o;return n.Point.isPoint(o)||g.x!=null&&g.y!=null?(this.store.set(i,e.ObjectExt.merge({},l,{x:g.x,y:g.y}),f),this):(this.store.set(i,e.ObjectExt.cloneDeep(o),f),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(i){const o=this[i];if(n.Point.isPointLike(o))return n.Point.create(o);const l=this.getTerminalCell(i);return l?l.getConnectionPoint(this,i):new n.Point}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(i){if(this.model){const o=i==="source"?this.getSourceCellId():this.getTargetCellId();if(o)return this.model.getCell(o)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(i){let o=this;const l={};for(;o&&o.isEdge();){if(l[o.id])return null;l[o.id]=!0,o=o.getTerminalCell(i)}return o&&o.isNode()?o:null}get router(){return this.getRouter()}set router(i){i==null?this.removeRouter():this.setRouter(i)}getRouter(){return this.store.get("router")}setRouter(i,o,l){return typeof i=="object"?this.store.set("router",i,o):this.store.set("router",{name:i,args:o},l),this}removeRouter(i={}){return this.store.remove("router",i),this}get connector(){return this.getConnector()}set connector(i){i==null?this.removeConnector():this.setConnector(i)}getConnector(){return this.store.get("connector")}setConnector(i,o,l){return typeof i=="object"?this.store.set("connector",i,o):this.store.set("connector",{name:i,args:o},l),this}removeConnector(i={}){return this.store.remove("connector",i)}getDefaultLabel(){const i=this.constructor,o=this.store.get("defaultLabel")||i.defaultLabel||{};return e.ObjectExt.cloneDeep(o)}get labels(){return this.getLabels()}set labels(i){this.setLabels(i)}getLabels(){return[...this.store.get("labels",[])].map(i=>this.parseLabel(i))}setLabels(i,o={}){return this.store.set("labels",Array.isArray(i)?i:[i],o),this}insertLabel(i,o,l={}){const f=this.getLabels(),g=f.length;let p=o!=null&&Number.isFinite(o)?o:g;return p<0&&(p=g+p+1),f.splice(p,0,this.parseLabel(i)),this.setLabels(f,l)}appendLabel(i,o={}){return this.insertLabel(i,-1,o)}getLabelAt(i){const o=this.getLabels();return i!=null&&Number.isFinite(i)?this.parseLabel(o[i]):null}setLabelAt(i,o,l={}){if(i!=null&&Number.isFinite(i)){const f=this.getLabels();f[i]=this.parseLabel(o),this.setLabels(f,l)}return this}removeLabelAt(i,o={}){const l=this.getLabels(),f=i!=null&&Number.isFinite(i)?i:-1,g=l.splice(f,1);return this.setLabels(l,o),g.length?g[0]:null}parseLabel(i){return typeof i=="string"?this.constructor.parseStringLabel(i):i}onLabelsChanged({previous:i,current:o}){const l=i&&o?o.filter(g=>i.find(p=>g===p||e.ObjectExt.isEqual(g,p))?null:g):o?[...o]:[],f=i&&o?i.filter(g=>o.find(p=>g===p||e.ObjectExt.isEqual(g,p))?null:g):i?[...i]:[];l.length>0&&this.notify("labels:added",{added:l,cell:this,edge:this}),f.length>0&&this.notify("labels:removed",{removed:f,cell:this,edge:this})}get vertices(){return this.getVertices()}set vertices(i){this.setVertices(i)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(i,o={}){const l=Array.isArray(i)?i:[i];return this.store.set("vertices",l.map(f=>n.Point.toJSON(f)),o),this}insertVertex(i,o,l={}){const f=this.getVertices(),g=f.length;let p=o!=null&&Number.isFinite(o)?o:g;return p<0&&(p=g+p+1),f.splice(p,0,n.Point.toJSON(i)),this.setVertices(f,l)}appendVertex(i,o={}){return this.insertVertex(i,-1,o)}getVertexAt(i){return i!=null&&Number.isFinite(i)?this.getVertices()[i]:null}setVertexAt(i,o,l={}){if(i!=null&&Number.isFinite(i)){const f=this.getVertices();f[i]=o,this.setVertices(f,l)}return this}removeVertexAt(i,o={}){const l=this.getVertices(),f=i!=null&&Number.isFinite(i)?i:-1;return l.splice(f,1),this.setVertices(l,o)}onVertexsChanged({previous:i,current:o}){const l=i&&o?o.filter(g=>i.find(p=>n.Point.equals(g,p))?null:g):o?[...o]:[],f=i&&o?i.filter(g=>o.find(p=>n.Point.equals(g,p))?null:g):i?[...i]:[];l.length>0&&this.notify("vertexs:added",{added:l,cell:this,edge:this}),f.length>0&&this.notify("vertexs:removed",{removed:f,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||a.Markup.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}translate(i,o,l={}){return l.translateBy=l.translateBy||this.id,l.tx=i,l.ty=o,this.applyToPoints(f=>({x:(f.x||0)+i,y:(f.y||0)+o}),l)}scale(i,o,l,f={}){return this.applyToPoints(g=>n.Point.create(g).scale(i,o,l).toJSON(),f)}applyToPoints(i,o={}){const l={},f=this.getSource(),g=this.getTarget();n.Point.isPointLike(f)&&(l.source=i(f)),n.Point.isPointLike(g)&&(l.target=i(g));const p=this.getVertices();return p.length>0&&(l.vertices=p.map(i)),this.store.set(l,o),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const i=[this.getSourcePoint(),...this.getVertices().map(o=>n.Point.create(o)),this.getTargetPoint()];return new n.Polyline(i)}updateParent(i){let o=null;const l=this.getSourceCell(),f=this.getTargetCell(),g=this.getParent();return l&&f&&(l===f||l.isDescendantOf(f)?o=f:f.isDescendantOf(l)?o=l:o=h.Cell.getCommonAncestor(l,f)),g&&o&&o.id!==g.id&&g.unembed(this,i),o&&(!g||g.id!==o.id)&&o.embed(this,i),o}hasLoop(i={}){const o=this.getSource(),l=this.getTarget(),f=o.cell,g=l.cell;if(!f||!g)return!1;let p=f===g;if(!p&&i.deep&&this._model){const m=this.getSourceCell(),y=this.getTargetCell();m&&y&&(p=m.isAncestorOf(y,i)||y.isAncestorOf(m,i))}return p}getFragmentAncestor(){const i=[this,this.getSourceNode(),this.getTargetNode()].filter(o=>o!=null);return this.getCommonAncestor(...i)}isFragmentDescendantOf(i){const o=this.getFragmentAncestor();return!!o&&(o.id===i.id||o.isDescendantOf(i))}}r.Edge=d,d.defaults={},function(c){function i(o,l){const f=o,g=l;return f.cell===g.cell?f.port===g.port||f.port==null&&g.port==null:!1}c.equalTerminals=i}(d=r.Edge||(r.Edge={})),function(c){c.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}};function i(o){return{attrs:{label:{text:o}}}}c.parseStringLabel=i}(d=r.Edge||(r.Edge={})),function(c){c.toStringTag=`X6.${c.name}`;function i(o){if(o==null)return!1;if(o instanceof c)return!0;const l=o[Symbol.toStringTag],f=o;return(l==null||l===c.toStringTag)&&typeof f.isNode=="function"&&typeof f.isEdge=="function"&&typeof f.prop=="function"&&typeof f.attr=="function"&&typeof f.disconnect=="function"&&typeof f.getSource=="function"&&typeof f.getTarget=="function"}c.isEdge=i}(d=r.Edge||(r.Edge={})),function(c){c.registry=s.Registry.create({type:"edge",process(i,o){if(u.ShareRegistry.exist(i,!1))throw new Error(`Edge with name '${i}' was registered by anthor Node`);if(typeof o=="function")return o.config({shape:i}),o;let l=c;const{inherit:f="edge"}=o,g=t(o,["inherit"]);if(typeof f=="string"){const m=this.get(f||"edge");m==null&&f?this.onNotFound(f,"inherited"):l=m}else l=f;g.constructorName==null&&(g.constructorName=i);const p=l.define.call(l,g);return p.config({shape:i}),p}}),u.ShareRegistry.setEdgeRegistry(c.registry)}(d=r.Edge||(r.Edge={})),function(c){let i=0;function o(g){return g?e.StringExt.pascalCase(g):(i+=1,`CustomEdge${i}`)}function l(g){const{constructorName:p,overwrite:m}=g,y=t(g,["constructorName","overwrite"]),b=e.ObjectExt.createClass(o(p||y.shape),this);return b.config(y),y.shape&&c.registry.register(y.shape,b,m),b}c.define=l;function f(g){const p=g.shape||"edge",m=c.registry.get(p);return m?new m(g):c.registry.onNotFound(p)}c.create=f}(d=r.Edge||(r.Edge={})),function(c){const i="basic.edge";c.config({shape:i,propHooks(o){const{label:l,vertices:f}=o,g=t(o,["label","vertices"]);if(l){g.labels==null&&(g.labels=[]);const p=typeof l=="string"?c.parseStringLabel(l):l;g.labels.push(p)}return f&&Array.isArray(f)&&(g.vertices=f.map(p=>n.Point.create(p).toJSON())),g}}),c.registry.register(i,c)}(d=r.Edge||(r.Edge={}))})(Sn);var pc={},Mn={},om=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(Mn,"__esModule",{value:!0});Mn.Collection=void 0;const mc=$;class no extends mc.Basecoat{constructor(t,e={}){super();this.length=0,this.comparator=e.comparator||"zIndex",this.clean(),t&&this.reset(t,{silent:!0})}toJSON(){return this.cells.map(t=>t.toJSON())}add(t,e,n){let s,a;typeof e=="number"?(s=e,a=Object.assign({merge:!1},n)):(s=this.length,a=Object.assign({merge:!1},e)),s>this.length&&(s=this.length),s<0&&(s+=this.length+1);const u=Array.isArray(t)?t:[t],h=this.comparator&&typeof e!="number"&&a.sort!==!1,d=this.comparator||null;let c=!1;const i=[],o=[];return u.forEach(l=>{const f=this.get(l);f?a.merge&&!l.isSameStore(f)&&(f.setProp(l.getProp(),n),o.push(f),h&&!c&&(d==null||typeof d=="function"?c=f.hasChanged():typeof d=="string"?c=f.hasChanged(d):c=d.some(g=>f.hasChanged(g)))):(i.push(l),this.reference(l))}),i.length&&(h&&(c=!0),this.cells.splice(s,0,...i),this.length=this.cells.length),c&&this.sort({silent:!0}),a.silent||(i.forEach((l,f)=>{const g={cell:l,index:s+f,options:a};this.trigger("added",g),a.dryrun||l.notify("added",Object.assign({},g))}),c&&this.trigger("sorted"),(i.length||o.length)&&this.trigger("updated",{added:i,merged:o,removed:[],options:a})),this}remove(t,e={}){const n=Array.isArray(t)?t:[t],s=this.removeCells(n,e);return!e.silent&&s.length>0&&this.trigger("updated",{options:e,removed:s,added:[],merged:[]}),Array.isArray(t)?s:s[0]}removeCells(t,e){const n=[];for(let s=0;s<t.length;s+=1){const a=this.get(t[s]);if(a==null)continue;const u=this.cells.indexOf(a);this.cells.splice(u,1),this.length-=1,delete this.map[a.id],n.push(a),this.unreference(a),e.dryrun||a.remove(),e.silent||(this.trigger("removed",{cell:a,index:u,options:e}),e.dryrun||a.notify("removed",{cell:a,index:u,options:e}))}return n}reset(t,e={}){const n=this.cells.slice();if(n.forEach(s=>this.unreference(s)),this.clean(),this.add(t,Object.assign({silent:!0},e)),!e.silent){const s=this.cells.slice();this.trigger("reseted",{options:e,previous:n,current:s});const a=[],u=[];s.forEach(h=>{n.some(c=>c.id===h.id)||a.push(h)}),n.forEach(h=>{s.some(c=>c.id===h.id)||u.push(h)}),this.trigger("updated",{options:e,added:a,removed:u,merged:[]})}return this}push(t,e){return this.add(t,this.length,e)}pop(t){const e=this.at(this.length-1);return this.remove(e,t)}unshift(t,e){return this.add(t,0,e)}shift(t){const e=this.at(0);return this.remove(e,t)}get(t){if(t==null)return null;const e=typeof t=="string"||typeof t=="number"?t:t.id;return this.map[e]||null}has(t){return this.get(t)!=null}at(t){return t<0&&(t+=this.length),this.cells[t]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(t){return this.cells.indexOf(t)}toArray(){return this.cells.slice()}sort(t={}){return this.comparator!=null&&(this.cells=mc.ArrayExt.sortBy(this.cells,this.comparator),t.silent||this.trigger("sorted")),this}clone(){const t=this.constructor;return new t(this.cells.slice(),{comparator:this.comparator})}reference(t){this.map[t.id]=t,t.on("*",this.notifyCellEvent,this)}unreference(t){t.off("*",this.notifyCellEvent,this),delete this.map[t.id]}notifyCellEvent(t,e){const n=e.cell;this.trigger(`cell:${t}`,e),n&&(n.isNode()?this.trigger(`node:${t}`,Object.assign(Object.assign({},e),{node:n})):n.isEdge()&&this.trigger(`edge:${t}`,Object.assign(Object.assign({},e),{edge:n})))}clean(){this.length=0,this.cells=[],this.map={}}dispose(){this.reset([])}}om([no.dispose()],no.prototype,"dispose",null);Mn.Collection=no;(function(r){var t=E&&E.__decorate||function(c,i,o,l){var f=arguments.length,g=f<3?i:l===null?l=Object.getOwnPropertyDescriptor(i,o):l,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,i,o,l);else for(var m=c.length-1;m>=0;m--)(p=c[m])&&(g=(f<3?p(g):f>3?p(i,o,g):p(i,o))||g);return f>3&&g&&Object.defineProperty(i,o,g),g};Object.defineProperty(r,"__esModule",{value:!0}),r.Model=void 0;const e=$,n=I,s=Fe,a=Sn,u=fr,h=Mn;class d extends e.Basecoat{get[Symbol.toStringTag](){return d.toStringTag}constructor(i=[]){super();this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new h.Collection(i),this.setup()}notify(i,o){this.trigger(i,o);const l=this.graph;return l&&(i==="sorted"||i==="reseted"||i==="updated"?l.trigger(`model:${i}`,o):l.trigger(i,o)),this}setup(){const i=this.collection;i.on("sorted",()=>this.notify("sorted",null)),i.on("updated",o=>this.notify("updated",o)),i.on("cell:change:zIndex",()=>this.sortOnChangeZ()),i.on("added",({cell:o})=>{this.onCellAdded(o)}),i.on("removed",o=>{const l=o.cell;this.onCellRemoved(l,o.options),this.notify("cell:removed",o),l.isNode()?this.notify("node:removed",Object.assign(Object.assign({},o),{node:l})):l.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},o),{edge:l}))}),i.on("reseted",o=>{this.onReset(o.current),this.notify("reseted",o)}),i.on("edge:change:source",({edge:o})=>this.onEdgeTerminalChanged(o,"source")),i.on("edge:change:target",({edge:o})=>{this.onEdgeTerminalChanged(o,"target")})}sortOnChangeZ(){this.collection.sort()}onCellAdded(i){const o=i.id;i.isEdge()?(i.updateParent(),this.edges[o]=!0,this.onEdgeTerminalChanged(i,"source"),this.onEdgeTerminalChanged(i,"target")):this.nodes[o]=!0}onCellRemoved(i,o){const l=i.id;if(i.isEdge()){delete this.edges[l];const f=i.getSource(),g=i.getTarget();if(f&&f.cell){const p=this.outgoings[f.cell],m=p?p.indexOf(l):-1;m>=0&&(p.splice(m,1),p.length===0&&delete this.outgoings[f.cell])}if(g&&g.cell){const p=this.incomings[g.cell],m=p?p.indexOf(l):-1;m>=0&&(p.splice(m,1),p.length===0&&delete this.incomings[g.cell])}}else delete this.nodes[l];o.clear||(o.disconnectEdges?this.disconnectConnectedEdges(i,o):this.removeConnectedEdges(i,o)),i.model===this&&(i.model=null)}onReset(i){this.nodes={},this.edges={},this.outgoings={},this.incomings={},i.forEach(o=>this.onCellAdded(o))}onEdgeTerminalChanged(i,o){const l=o==="source"?this.outgoings:this.incomings,f=i.previous(o);if(f&&f.cell){const p=s.Cell.isCell(f.cell)?f.cell.id:f.cell,m=l[p],y=m?m.indexOf(i.id):-1;y>=0&&(m.splice(y,1),m.length===0&&delete l[p])}const g=i.getTerminal(o);if(g&&g.cell){const p=s.Cell.isCell(g.cell)?g.cell.id:g.cell,m=l[p]||[];m.indexOf(i.id)===-1&&m.push(i.id),l[p]=m}}prepareCell(i,o){return!i.model&&(!o||!o.dryrun)&&(i.model=this),i.zIndex==null&&i.setZIndex(this.getMaxZIndex()+1,{silent:!0}),i}resetCells(i,o={}){return i.map(l=>this.prepareCell(l,Object.assign(Object.assign({},o),{dryrun:!0}))),this.collection.reset(i,o),i.map(l=>this.prepareCell(l,{options:o})),this}clear(i={}){const o=this.getCells();if(o.length===0)return this;const l=Object.assign(Object.assign({},i),{clear:!0});return this.batchUpdate("clear",()=>{const f=o.sort((g,p)=>{const m=g.isEdge()?1:2,y=p.isEdge()?1:2;return m-y});for(;f.length>0;){const g=f.shift();g&&g.remove(l)}},l),this}addNode(i,o={}){const l=u.Node.isNode(i)?i:this.createNode(i);return this.addCell(l,o),l}updateNode(i,o={}){const l=this.createNode(i),f=l.getProp();return l.dispose(),this.updateCell(f,o)}createNode(i){return u.Node.create(i)}addEdge(i,o={}){const l=a.Edge.isEdge(i)?i:this.createEdge(i);return this.addCell(l,o),l}createEdge(i){return a.Edge.create(i)}updateEdge(i,o={}){const l=this.createEdge(i),f=l.getProp();return l.dispose(),this.updateCell(f,o)}addCell(i,o={}){return Array.isArray(i)?this.addCells(i,o):(!this.collection.has(i)&&!this.addings.has(i)&&(this.addings.set(i,!0),this.collection.add(this.prepareCell(i,o),o),i.eachChild(l=>this.addCell(l,o)),this.addings.delete(i)),this)}addCells(i,o={}){const l=i.length;if(l===0)return this;const f=Object.assign(Object.assign({},o),{position:l-1,maxPosition:l-1});return this.startBatch("add",Object.assign(Object.assign({},f),{cells:i})),i.forEach(g=>{this.addCell(g,f),f.position-=1}),this.stopBatch("add",Object.assign(Object.assign({},f),{cells:i})),this}updateCell(i,o={}){const l=i.id&&this.getCell(i.id);return l?this.batchUpdate("update",()=>(Object.entries(i).forEach(([f,g])=>l.setProp(f,g,o)),!0),i):!1}removeCell(i,o={}){const l=typeof i=="string"?this.getCell(i):i;return l&&this.has(l)?this.collection.remove(l,o):null}updateCellId(i,o){if(i.id===o)return;this.startBatch("update",{id:o}),i.prop("id",o);const l=i.clone({keepId:!0});return this.addCell(l),this.getConnectedEdges(i).forEach(g=>{const p=g.getSourceCell(),m=g.getTargetCell();p===i&&g.setSource(Object.assign(Object.assign({},g.getSource()),{cell:o})),m===i&&g.setTarget(Object.assign(Object.assign({},g.getTarget()),{cell:o}))}),this.removeCell(i),this.stopBatch("update",{id:o}),l}removeCells(i,o={}){return i.length?this.batchUpdate("remove",()=>i.map(l=>this.removeCell(l,o))):[]}removeConnectedEdges(i,o={}){const l=this.getConnectedEdges(i);return l.forEach(f=>{f.remove(o)}),l}disconnectConnectedEdges(i,o={}){const l=typeof i=="string"?i:i.id;this.getConnectedEdges(i).forEach(f=>{const g=f.getSourceCellId(),p=f.getTargetCellId();g===l&&f.setSource({x:0,y:0},o),p===l&&f.setTarget({x:0,y:0},o)})}has(i){return this.collection.has(i)}total(){return this.collection.length}indexOf(i){return this.collection.indexOf(i)}getCell(i){return this.collection.get(i)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const i=this.collection.first();return i&&i.getZIndex()||0}getMaxZIndex(){const i=this.collection.last();return i&&i.getZIndex()||0}getCellsFromCache(i){return i?Object.keys(i).map(o=>this.getCell(o)).filter(o=>o!=null):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(i){const o=typeof i=="string"?i:i.id,l=this.outgoings[o];return l?l.map(f=>this.getCell(f)).filter(f=>f&&f.isEdge()):null}getIncomingEdges(i){const o=typeof i=="string"?i:i.id,l=this.incomings[o];return l?l.map(f=>this.getCell(f)).filter(f=>f&&f.isEdge()):null}getConnectedEdges(i,o={}){const l=[],f=typeof i=="string"?this.getCell(i):i;if(f==null)return l;const g={},p=o.indirect;let m=o.incoming,y=o.outgoing;m==null&&y==null&&(m=y=!0);const b=(v,x)=>{const P=x?this.getOutgoingEdges(v):this.getIncomingEdges(v);if(P!=null&&P.forEach(C=>{g[C.id]||(l.push(C),g[C.id]=!0,p&&(m&&b(C,!1),y&&b(C,!0)))}),p&&v.isEdge()){const C=x?v.getTargetCell():v.getSourceCell();C&&C.isEdge()&&(g[C.id]||(l.push(C),b(C,x)))}};if(y&&b(f,!0),m&&b(f,!1),o.deep){const v=f.getDescendants({deep:!0}),x={};v.forEach(C=>{C.isNode()&&(x[C.id]=!0)});const P=(C,_)=>{const A=_?this.getOutgoingEdges(C.id):this.getIncomingEdges(C.id);A!=null&&A.forEach(S=>{if(!g[S.id]){const w=S.getSourceCell(),O=S.getTargetCell();if(!o.enclosed&&w&&x[w.id]&&O&&x[O.id])return;l.push(S),g[S.id]=!0}})};v.forEach(C=>{C.isEdge()||(y&&P(C,!0),m&&P(C,!1))})}return l}isBoundary(i,o){const l=typeof i=="string"?this.getCell(i):i,f=o?this.getIncomingEdges(l):this.getOutgoingEdges(l);return f==null||f.length===0}getBoundaryNodes(i){const o=[];return Object.keys(this.nodes).forEach(l=>{if(this.isBoundary(l,i)){const f=this.getCell(l);f&&o.push(f)}}),o}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(i){return this.isBoundary(i,!0)}isLeaf(i){return this.isBoundary(i,!1)}getNeighbors(i,o={}){let l=o.incoming,f=o.outgoing;l==null&&f==null&&(l=f=!0);const p=this.getConnectedEdges(i,o).reduce((m,y)=>{const b=y.hasLoop(o),v=y.getSourceCell(),x=y.getTargetCell();return l&&v&&v.isNode()&&!m[v.id]&&(b||v!==i&&(!o.deep||!v.isDescendantOf(i)))&&(m[v.id]=v),f&&x&&x.isNode()&&!m[x.id]&&(b||x!==i&&(!o.deep||!x.isDescendantOf(i)))&&(m[x.id]=x),m},{});if(i.isEdge()){if(l){const m=i.getSourceCell();m&&m.isNode()&&!p[m.id]&&(p[m.id]=m)}if(f){const m=i.getTargetCell();m&&m.isNode()&&!p[m.id]&&(p[m.id]=m)}}return Object.keys(p).map(m=>p[m])}isNeighbor(i,o,l={}){let f=l.incoming,g=l.outgoing;return f==null&&g==null&&(f=g=!0),this.getConnectedEdges(i,l).some(p=>{const m=p.getSourceCell(),y=p.getTargetCell();return!!(f&&m&&m.id===o.id||g&&y&&y.id===o.id)})}getSuccessors(i,o={}){const l=[];return this.search(i,(f,g)=>{f!==i&&this.matchDistance(g,o.distance)&&l.push(f)},Object.assign(Object.assign({},o),{outgoing:!0})),l}isSuccessor(i,o,l={}){let f=!1;return this.search(i,(g,p)=>{if(g===o&&g!==i&&this.matchDistance(p,l.distance))return f=!0,!1},Object.assign(Object.assign({},l),{outgoing:!0})),f}getPredecessors(i,o={}){const l=[];return this.search(i,(f,g)=>{f!==i&&this.matchDistance(g,o.distance)&&l.push(f)},Object.assign(Object.assign({},o),{incoming:!0})),l}isPredecessor(i,o,l={}){let f=!1;return this.search(i,(g,p)=>{if(g===o&&g!==i&&this.matchDistance(p,l.distance))return f=!0,!1},Object.assign(Object.assign({},l),{incoming:!0})),f}matchDistance(i,o){return o==null?!0:typeof o=="function"?o(i):Array.isArray(o)&&o.includes(i)?!0:i===o}getCommonAncestor(...i){const o=[];return i.forEach(l=>{l&&(Array.isArray(l)?o.push(...l):o.push(l))}),s.Cell.getCommonAncestor(...o)}getSubGraph(i,o={}){const l=[],f={},g=[],p=[],m=y=>{f[y.id]||(l.push(y),f[y.id]=y,y.isEdge()&&p.push(y),y.isNode()&&g.push(y))};return i.forEach(y=>{m(y),o.deep&&y.getDescendants({deep:!0}).forEach(v=>m(v))}),p.forEach(y=>{const b=y.getSourceCell(),v=y.getTargetCell();b&&!f[b.id]&&(l.push(b),f[b.id]=b,b.isNode()&&g.push(b)),v&&!f[v.id]&&(l.push(v),f[v.id]=v,v.isNode()&&g.push(v))}),g.forEach(y=>{this.getConnectedEdges(y,o).forEach(v=>{const x=v.getSourceCell(),P=v.getTargetCell();!f[v.id]&&x&&f[x.id]&&P&&f[P.id]&&(l.push(v),f[v.id]=v)})}),l}cloneSubGraph(i,o={}){const l=this.getSubGraph(i,o);return this.cloneCells(l)}cloneCells(i){return s.Cell.cloneCells(i)}getNodesFromPoint(i,o){const l=typeof i=="number"?{x:i,y:o||0}:i;return this.getNodes().filter(f=>f.getBBox().containsPoint(l))}getNodesInArea(i,o,l,f,g){const p=typeof i=="number"?new n.Rectangle(i,o,l,f):n.Rectangle.create(i),m=typeof i=="number"?g:o,y=m&&m.strict;return this.getNodes().filter(b=>{const v=b.getBBox();return y?p.containsRect(v):p.isIntersectWithRect(v)})}getEdgesInArea(i,o,l,f,g){const p=typeof i=="number"?new n.Rectangle(i,o,l,f):n.Rectangle.create(i),m=typeof i=="number"?g:o,y=m&&m.strict;return this.getEdges().filter(b=>{const v=b.getBBox();return v.width===0?v.inflate(1,0):v.height===0&&v.inflate(0,1),y?p.containsRect(v):p.isIntersectWithRect(v)})}getNodesUnderNode(i,o={}){const l=i.getBBox();return(o.by==null||o.by==="bbox"?this.getNodesInArea(l):this.getNodesFromPoint(l[o.by])).filter(g=>i.id!==g.id&&!g.isDescendantOf(i))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(i,o={}){return s.Cell.getCellsBBox(i,o)}search(i,o,l={}){l.breadthFirst?this.breadthFirstSearch(i,o,l):this.depthFirstSearch(i,o,l)}breadthFirstSearch(i,o,l={}){const f=[],g={},p={};for(f.push(i),p[i.id]=0;f.length>0;){const m=f.shift();if(m==null||g[m.id]||(g[m.id]=!0,e.FunctionExt.call(o,this,m,p[m.id])===!1))continue;this.getNeighbors(m,l).forEach(b=>{p[b.id]=p[m.id]+1,f.push(b)})}}depthFirstSearch(i,o,l={}){const f=[],g={},p={};for(f.push(i),p[i.id]=0;f.length>0;){const m=f.pop();if(m==null||g[m.id]||(g[m.id]=!0,e.FunctionExt.call(o,this,m,p[m.id])===!1))continue;const y=this.getNeighbors(m,l),b=f.length;y.forEach(v=>{p[v.id]=p[m.id]+1,f.splice(b,0,v)})}}getShortestPath(i,o,l={}){const f={};this.getEdges().forEach(b=>{const v=b.getSourceCellId(),x=b.getTargetCellId();v&&x&&(f[v]||(f[v]=[]),f[x]||(f[x]=[]),f[v].push(x),l.directed||f[x].push(v))});const g=typeof i=="string"?i:i.id,p=e.Dijkstra.run(f,g,l.weight),m=[];let y=typeof o=="string"?o:o.id;for(p[y]&&m.push(y);y=p[y];)m.unshift(y);return m}translate(i,o,l){return this.getCells().filter(f=>!f.hasParent()).forEach(f=>f.translate(i,o,l)),this}resize(i,o,l){return this.resizeCells(i,o,this.getCells(),l)}resizeCells(i,o,l,f={}){const g=this.getCellsBBox(l);if(g){const p=Math.max(i/g.width,0),m=Math.max(o/g.height,0),y=g.getOrigin();l.forEach(b=>b.scale(p,m,y,f))}return this}toJSON(i={}){return d.toJSON(this.getCells(),i)}parseJSON(i){return d.fromJSON(i)}fromJSON(i,o={}){const l=this.parseJSON(i);return this.resetCells(l,o),this}startBatch(i,o={}){return this.batches[i]=(this.batches[i]||0)+1,this.notify("batch:start",{name:i,data:o}),this}stopBatch(i,o={}){return this.batches[i]=(this.batches[i]||0)-1,this.notify("batch:stop",{name:i,data:o}),this}batchUpdate(i,o,l={}){this.startBatch(i,l);const f=o();return this.stopBatch(i,l),f}hasActiveBatch(i=Object.keys(this.batches)){return(Array.isArray(i)?i:[i]).some(l=>this.batches[l]>0)}dispose(){this.collection.dispose()}}t([d.dispose()],d.prototype,"dispose",null),r.Model=d,function(c){c.toStringTag=`X6.${c.name}`;function i(o){if(o==null)return!1;if(o instanceof c)return!0;const l=o[Symbol.toStringTag],f=o;return(l==null||l===c.toStringTag)&&typeof f.addNode=="function"&&typeof f.addEdge=="function"&&f.collection!=null}c.isModel=i}(d=r.Model||(r.Model={})),function(c){function i(l,f={}){return{cells:l.map(g=>g.toJSON(f))}}c.toJSON=i;function o(l){const f=[];return Array.isArray(l)?f.push(...l):(l.cells&&f.push(...l.cells),l.nodes&&l.nodes.forEach(g=>{g.shape==null&&(g.shape="rect"),f.push(g)}),l.edges&&l.edges.forEach(g=>{g.shape==null&&(g.shape="edge"),f.push(g)})),f.map(g=>{const p=g.shape;if(p){if(u.Node.registry.exist(p))return u.Node.create(g);if(a.Edge.registry.exist(p))return a.Edge.create(g)}throw new Error("The `shape` should be specified when creating a node/edge instance")})}c.fromJSON=o}(d=r.Model||(r.Model={}))})(pc);(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Fe,r),e(fr,r),e(Sn,r),e(pc,r),e(Mn,r)})(Ve);(function(r){var t=E&&E.__rest||function(a,u){var h={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&u.indexOf(d)<0&&(h[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,d=Object.getOwnPropertySymbols(a);c<d.length;c++)u.indexOf(d[c])<0&&Object.prototype.propertyIsEnumerable.call(a,d[c])&&(h[d[c]]=a[d[c]]);return h};Object.defineProperty(r,"__esModule",{value:!0}),r.Base=void 0;const e=$,n=Ve;class s extends n.Node{get label(){return this.getLabel()}set label(u){this.setLabel(u)}getLabel(){return this.getAttrByPath("text/text")}setLabel(u,h){return u==null?this.removeLabel():this.setAttrByPath("text/text",u,h),this}removeLabel(){return this.removeAttrByPath("text/text"),this}}r.Base=s,function(a){a.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},a.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},a.config({attrs:{text:Object.assign({},a.labelAttr)},propHooks(u){const{label:h}=u,d=t(u,["label"]);return h&&e.ObjectExt.setByPath(d,"attrs/text/text",h),d},visible:!0})}(s=r.Base||(r.Base={}))})(pn);var am=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.createShape=Pt.getImageUrlHook=Pt.getMarkup=void 0;const lm=$,yc=pn;function bc(r,t="body"){return[{tagName:r,selector:t},{tagName:"text",selector:"label"}]}Pt.getMarkup=bc;function cm(r="xlink:href"){return e=>{const{imageUrl:n,imageWidth:s,imageHeight:a}=e,u=am(e,["imageUrl","imageWidth","imageHeight"]);if(n!=null||s!=null||a!=null){const h=()=>{if(u.attrs){const d=u.attrs.image;n!=null&&(d[r]=n),s!=null&&(d.width=s),a!=null&&(d.height=a),u.attrs.image=d}};u.attrs?(u.attrs.image==null&&(u.attrs.image={}),h()):(u.attrs={image:{}},h())}return u}}Pt.getImageUrlHook=cm;function um(r,t,e={}){const n={constructorName:r,markup:bc(r,e.selector),attrs:{[r]:Object.assign({},yc.Base.bodyAttr)}};return(e.parent||yc.Base).define(lm.ObjectExt.merge(n,t,{shape:r}))}Pt.createShape=um;Object.defineProperty(rn,"__esModule",{value:!0});rn.Rect=void 0;const hm=Pt;rn.Rect=(0,hm.createShape)("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});var An={};Object.defineProperty(An,"__esModule",{value:!0});An.Edge=void 0;const dm=Sn;An.Edge=dm.Edge.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});var mr={};Object.defineProperty(mr,"__esModule",{value:!0});mr.Ellipse=void 0;const fm=Pt;mr.Ellipse=(0,fm.createShape)("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var yr={},io={};(function(r){var t=E&&E.__rest||function(u,h){var d={};for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&h.indexOf(c)<0&&(d[c]=u[c]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,c=Object.getOwnPropertySymbols(u);i<c.length;i++)h.indexOf(c[i])<0&&Object.prototype.propertyIsEnumerable.call(u,c[i])&&(d[c[i]]=u[c[i]]);return d};Object.defineProperty(r,"__esModule",{value:!0}),r.Poly=void 0;const e=I,n=$,s=pn;class a extends s.Base{get points(){return this.getPoints()}set points(h){this.setPoints(h)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(h,d){return h==null?this.removePoints():this.setAttrByPath("body/refPoints",a.pointsToString(h),d),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}r.Poly=a,function(u){function h(d){return typeof d=="string"?d:d.map(c=>Array.isArray(c)?c.join(","):e.Point.isPointLike(c)?`${c.x}, ${c.y}`:"").join(" ")}u.pointsToString=h,u.config({propHooks(d){const{points:c}=d,i=t(d,["points"]);if(c){const o=h(c);o&&n.ObjectExt.setByPath(i,"attrs/body/refPoints",o)}return i}})}(a=r.Poly||(r.Poly={}))})(io);Object.defineProperty(yr,"__esModule",{value:!0});yr.Polygon=void 0;const gm=io,pm=Pt;yr.Polygon=(0,pm.createShape)("polygon",{},{parent:gm.Poly});var br={};Object.defineProperty(br,"__esModule",{value:!0});br.Polyline=void 0;const mm=io,ym=Pt;br.Polyline=(0,ym.createShape)("polyline",{},{parent:mm.Poly});var vr={},bm=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(vr,"__esModule",{value:!0});vr.Path=void 0;const vm=$,wm=pn;vr.Path=wm.Base.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(r){const{path:t}=r,e=bm(r,["path"]);return t&&vm.ObjectExt.setByPath(e,"attrs/body/refD",t),e}});var wr={},xm=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(wr,"__esModule",{value:!0});wr.TextBlock=void 0;const xr=$,Pm=Dt,vc=pn;wr.TextBlock=vc.Base.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},xr.Platform.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:xr.Dom.ns.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},vc.Base.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(r){const{text:t}=r,e=xm(r,["text"]);return t&&xr.ObjectExt.setByPath(e,"attrs/label/text",t),e},attrHooks:{text:{set(r,{cell:t,view:e,refBBox:n,elem:s,attrs:a}){if(s instanceof HTMLElement)s.textContent=r;else{const u=a.style||{},h={text:r,width:-5,height:"100%"},d=Object.assign({textVerticalAnchor:"middle"},u),c=Pm.Attr.presets.textWrap;return xr.FunctionExt.call(c.set,this,h,{cell:t,view:e,elem:s,refBBox:n,attrs:d}),{fill:u.color||null}}},position(r,{refBBox:t,elem:e}){if(e instanceof SVGElement)return t.getCenter()}}}});var Pr={};Object.defineProperty(Pr,"__esModule",{value:!0});Pr.Image=void 0;const wc=Pt;Pr.Image=(0,wc.createShape)("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:(0,wc.getImageUrlHook)()},{selector:"image"});var Or={};Object.defineProperty(Or,"__esModule",{value:!0});Or.Circle=void 0;const Om=Pt;Or.Circle=(0,Om.createShape)("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});var xc={},_e={},Pc={},Er={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.NodeView=void 0;const t=$,e=I,n=$t,s=Fe,a=wn,u=Oe;class h extends a.CellView{constructor(){super(...arguments);this.portsCache={}}get[Symbol.toStringTag](){return h.toStringTag}getContainerClassName(){const c=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||c.push(this.prefixClassName("node-immovable")),c.join(" ")}updateClassName(c){const i=c.target;if(i.hasAttribute("magnet")){const o=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?t.Dom.removeClass(i,o):t.Dom.addClass(i,o)}else{const o=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(o):this.addClass(o)}}isNodeView(){return!0}confirmUpdate(c,i={}){let o=c;return this.hasAction(o,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(o,"render")?(this.render(),o=this.removeAction(o,["render","update","resize","translate","rotate","ports","tools"])):(o=this.handleAction(o,"resize",()=>this.resize(),"update"),o=this.handleAction(o,"update",()=>this.update(),n.Config.useCSSSelector?"ports":null),o=this.handleAction(o,"translate",()=>this.translate()),o=this.handleAction(o,"rotate",()=>this.rotate()),o=this.handleAction(o,"ports",()=>this.renderPorts()),o=this.handleAction(o,"tools",()=>{this.getFlag("tools")===c?this.renderTools():this.updateTools(i)})),o}update(c){this.cleanCache(),n.Config.useCSSSelector&&this.removePorts();const i=this.cell,o=i.getSize(),l=i.getAttrs();this.updateAttrs(this.container,l,{attrs:c===l?null:c,rootBBox:new e.Rectangle(0,0,o.width,o.height),selectors:this.selectors}),n.Config.useCSSSelector&&this.renderPorts()}renderMarkup(){const c=this.cell.markup;if(c){if(typeof c=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(c)}throw new TypeError("Invalid node markup.")}renderJSONMarkup(c){const i=this.parseJSONMarkup(c,this.container);this.selectors=i.selectors,this.container.appendChild(i.fragment)}render(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),n.Config.useCSSSelector||this.renderPorts(),this.renderTools(),this}resize(){this.cell.getAngle()&&this.rotate(),this.update()}translate(){this.updateTransform()}rotate(){this.updateTransform()}getTranslationString(){const c=this.cell.getPosition();return`translate(${c.x},${c.y})`}getRotationString(){const c=this.cell.getAngle();if(c){const i=this.cell.getSize();return`rotate(${c},${i.width/2},${i.height/2})`}}updateTransform(){let c=this.getTranslationString();const i=this.getRotationString();i&&(c+=` ${i}`),this.container.setAttribute("transform",c)}findPortElem(c,i){const o=c?this.portsCache[c]:null;if(!o)return null;const l=o.portContentElement,f=o.portContentSelectors||{};return this.findOne(i,l,f)}cleanPortsCache(){this.portsCache={}}removePorts(){Object.values(this.portsCache).forEach(c=>{t.Dom.remove(c.portElement)})}renderPorts(){const c=this.container,i=[];c.childNodes.forEach(g=>{i.push(g)});const o=this.cell.getParsedPorts(),l=t.ArrayExt.groupBy(o,"zIndex"),f="auto";l[f]&&l[f].forEach(g=>{const p=this.getPortElement(g);c.append(p),i.push(p)}),Object.keys(l).forEach(g=>{if(g!==f){const p=parseInt(g,10);this.appendPorts(l[g],p,i)}}),this.updatePorts()}appendPorts(c,i,o){const l=c.map(f=>this.getPortElement(f));o[i]||i<0?t.Dom.before(o[Math.max(i,0)],l):t.Dom.append(this.container,l)}getPortElement(c){const i=this.portsCache[c.id];return i?i.portElement:this.createPortElement(c)}createPortElement(c){let i=u.Markup.renderMarkup(this.cell.getPortContainerMarkup());const o=i.elem;if(o==null)throw new Error("Invalid port container markup.");i=u.Markup.renderMarkup(this.getPortMarkup(c));const l=i.elem,f=i.selectors;if(l==null)throw new Error("Invalid port markup.");this.setAttrs({port:c.id,"port-group":c.group},l);let g="x6-port";c.group&&(g+=` x6-port-${c.group}`),t.Dom.addClass(o,g),t.Dom.addClass(o,"x6-port"),t.Dom.addClass(l,"x6-port-body"),o.appendChild(l);let p=f,m,y;if(this.existPortLabel(c)){if(i=u.Markup.renderMarkup(this.getPortLabelMarkup(c.label)),m=i.elem,y=i.selectors,m==null)throw new Error("Invalid port label markup.");if(f&&y){for(const v in y)if(f[v]&&v!==this.rootSelector)throw new Error("Selectors within port must be unique.");p=Object.assign(Object.assign({},f),y)}t.Dom.addClass(m,"x6-port-label"),o.appendChild(m)}return this.portsCache[c.id]={portElement:o,portSelectors:p,portLabelElement:m,portLabelSelectors:y,portContentElement:l,portContentSelectors:f},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:c,node:this.cell,container:o,selectors:p,labelContainer:m,labelSelectors:y,contentContainer:l,contentSelectors:f}),o}updatePorts(){const c=this.cell.getParsedGroups(),i=Object.keys(c);i.length===0?this.updatePortGroup():i.forEach(o=>this.updatePortGroup(o))}updatePortGroup(c){const i=e.Rectangle.fromSize(this.cell.getSize()),o=this.cell.getPortsLayoutByGroup(c,i);for(let l=0,f=o.length;l<f;l+=1){const g=o[l],p=g.portId,m=this.portsCache[p]||{},y=g.portLayout;if(this.applyPortTransform(m.portElement,y),g.portAttrs!=null){const v={selectors:m.portSelectors||{}};g.portSize&&(v.rootBBox=e.Rectangle.fromSize(g.portSize)),this.updateAttrs(m.portElement,g.portAttrs,v)}const b=g.labelLayout;if(b&&m.portLabelElement&&(this.applyPortTransform(m.portLabelElement,b,-(y.angle||0)),b.attrs)){const v={selectors:m.portLabelSelectors||{}};g.labelSize&&(v.rootBBox=e.Rectangle.fromSize(g.labelSize)),this.updateAttrs(m.portLabelElement,b.attrs,v)}}}applyPortTransform(c,i,o=0){const l=i.angle,f=i.position,g=t.Dom.createSVGMatrix().rotate(o).translate(f.x||0,f.y||0).rotate(l||0);t.Dom.transform(c,g,{absolute:!0})}getPortMarkup(c){return c.markup||this.cell.portMarkup}getPortLabelMarkup(c){return c.markup||this.cell.portLabelMarkup}existPortLabel(c){return c.attrs&&c.attrs.text}getEventArgs(c,i,o){const l=this,f=l.cell,g=f;return i==null||o==null?{e:c,view:l,node:f,cell:g}:{e:c,x:i,y:o,view:l,node:f,cell:g}}getPortEventArgs(c,i,o){const l=this,f=l.cell,g=f;return o?{e:c,x:o.x,y:o.y,view:l,node:f,cell:g,port:i}:{e:c,view:l,node:f,cell:g,port:i}}notifyMouseDown(c,i,o){super.onMouseDown(c,i,o),this.notify("node:mousedown",this.getEventArgs(c,i,o))}notifyMouseMove(c,i,o){super.onMouseMove(c,i,o),this.notify("node:mousemove",this.getEventArgs(c,i,o))}notifyMouseUp(c,i,o){super.onMouseUp(c,i,o),this.notify("node:mouseup",this.getEventArgs(c,i,o))}notifyPortEvent(c,i,o){const l=this.findAttr("port",i.target);if(l){const f=i.type;c==="node:port:mouseenter"?i.type="mouseenter":c==="node:port:mouseleave"&&(i.type="mouseleave"),this.notify(c,this.getPortEventArgs(i,l,o)),i.type=f}}onClick(c,i,o){super.onClick(c,i,o),this.notify("node:click",this.getEventArgs(c,i,o)),this.notifyPortEvent("node:port:click",c,{x:i,y:o})}onDblClick(c,i,o){super.onDblClick(c,i,o),this.notify("node:dblclick",this.getEventArgs(c,i,o)),this.notifyPortEvent("node:port:dblclick",c,{x:i,y:o})}onContextMenu(c,i,o){super.onContextMenu(c,i,o),this.notify("node:contextmenu",this.getEventArgs(c,i,o)),this.notifyPortEvent("node:port:contextmenu",c,{x:i,y:o})}onMouseDown(c,i,o){this.isPropagationStopped(c)||(this.notifyMouseDown(c,i,o),this.notifyPortEvent("node:port:mousedown",c,{x:i,y:o}),this.startNodeDragging(c,i,o))}onMouseMove(c,i,o){const l=this.getEventData(c),f=l.action;if(f==="magnet")this.dragMagnet(c,i,o);else{if(f==="move"){const p=l.targetView||this;p.dragNode(c,i,o),p.notify("node:moving",{e:c,x:i,y:o,view:p,cell:p.cell,node:p.cell})}this.notifyMouseMove(c,i,o),this.notifyPortEvent("node:port:mousemove",c,{x:i,y:o})}this.setEventData(c,l)}onMouseUp(c,i,o){const l=this.getEventData(c),f=l.action;f==="magnet"?this.stopMagnetDragging(c,i,o):(this.notifyMouseUp(c,i,o),this.notifyPortEvent("node:port:mouseup",c,{x:i,y:o}),f==="move"&&(l.targetView||this).stopNodeDragging(c,i,o));const g=l.targetMagnet;g&&this.onMagnetClick(c,g,i,o),this.checkMouseleave(c)}onMouseOver(c){super.onMouseOver(c),this.notify("node:mouseover",this.getEventArgs(c)),this.notifyPortEvent("node:port:mouseenter",c),this.notifyPortEvent("node:port:mouseover",c)}onMouseOut(c){super.onMouseOut(c),this.notify("node:mouseout",this.getEventArgs(c)),this.notifyPortEvent("node:port:mouseleave",c),this.notifyPortEvent("node:port:mouseout",c)}onMouseEnter(c){this.updateClassName(c),super.onMouseEnter(c),this.notify("node:mouseenter",this.getEventArgs(c))}onMouseLeave(c){super.onMouseLeave(c),this.notify("node:mouseleave",this.getEventArgs(c))}onMouseWheel(c,i,o,l){super.onMouseWheel(c,i,o,l),this.notify("node:mousewheel",Object.assign({delta:l},this.getEventArgs(c,i,o)))}onMagnetClick(c,i,o,l){const f=this.graph;f.view.getMouseMovedCount(c)>f.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:i},this.getEventArgs(c,o,l)))}onMagnetDblClick(c,i,o,l){this.notify("node:magnet:dblclick",Object.assign({magnet:i},this.getEventArgs(c,o,l)))}onMagnetContextMenu(c,i,o,l){this.notify("node:magnet:contextmenu",Object.assign({magnet:i},this.getEventArgs(c,o,l)))}onMagnetMouseDown(c,i,o,l){this.startMagnetDragging(c,o,l)}onCustomEvent(c,i,o,l){this.notify("node:customevent",Object.assign({name:i},this.getEventArgs(c,o,l))),super.onCustomEvent(c,i,o,l)}prepareEmbedding(c){const i=this.graph,l=this.getEventData(c).cell||this.cell,f=i.findViewByCell(l),g=i.snapToGrid(c.clientX,c.clientY);this.notify("node:embed",{e:c,node:l,view:f,cell:l,x:g.x,y:g.y,currentParent:l.getParent()})}processEmbedding(c,i){const o=i.cell||this.cell,l=i.graph||this.graph,f=l.options.embedding,g=f.findParent;let p=typeof g=="function"?t.FunctionExt.call(g,l,{view:this,node:this.cell}).filter(x=>s.Cell.isCell(x)&&this.cell.id!==x.id&&!x.isDescendantOf(this.cell)):l.model.getNodesUnderNode(o,{by:g});if(f.frontOnly&&p.length>0){const x=t.ArrayExt.groupBy(p,"zIndex"),P=t.ArrayExt.max(Object.keys(x).map(C=>parseInt(C,10)));P&&(p=x[P])}p=p.filter(x=>x.visible);let m=null;const y=i.candidateEmbedView,b=f.validate;for(let x=p.length-1;x>=0;x-=1){const P=p[x];if(y&&y.cell.id===P.id){m=y;break}else{const C=P.findView(l);if(b&&t.FunctionExt.call(b,l,{child:this.cell,parent:C.cell,childView:this,parentView:C})){m=C;break}}}this.clearEmbedding(i),m&&m.highlight(null,{type:"embedding"}),i.candidateEmbedView=m;const v=l.snapToGrid(c.clientX,c.clientY);this.notify("node:embedding",{e:c,cell:o,node:o,view:l.findViewByCell(o),x:v.x,y:v.y,currentParent:o.getParent(),candidateParent:m?m.cell:null})}clearEmbedding(c){const i=c.candidateEmbedView;i&&(i.unhighlight(null,{type:"embedding"}),c.candidateEmbedView=null)}finalizeEmbedding(c,i){this.graph.startBatch("embedding");const o=i.cell||this.cell,l=i.graph||this.graph,f=l.findViewByCell(o),g=o.getParent(),p=i.candidateEmbedView;if(p?(p.unhighlight(null,{type:"embedding"}),i.candidateEmbedView=null,(g==null||g.id!==p.cell.id)&&p.cell.insertChild(o,void 0,{ui:!0})):g&&g.unembed(o,{ui:!0}),l.model.getConnectedEdges(o,{deep:!0}).forEach(m=>{m.updateParent({ui:!0})}),f&&p){const m=l.snapToGrid(c.clientX,c.clientY);f.notify("node:embedded",{e:c,cell:o,x:m.x,y:m.y,node:o,view:l.findViewByCell(o),previousParent:g,currentParent:o.getParent()})}this.graph.stopBatch("embedding")}getDelegatedView(){let c=this.cell,i=this;for(;i&&!c.isEdge();){if(!c.hasParent()||i.can("stopDelegateOnDragging"))return i;c=c.getParent(),i=this.graph.findViewByCell(c)}return null}validateMagnet(c,i,o){if(i.getAttribute("magnet")!=="passive"){const l=this.graph.options.connecting.validateMagnet;return l?t.FunctionExt.call(l,this.graph,{e:o,magnet:i,view:c,cell:c.cell}):!0}return!1}startMagnetDragging(c,i,o){if(!this.can("magnetConnectable"))return;c.stopPropagation();const l=c.currentTarget,f=this.graph;this.setEventData(c,{targetMagnet:l}),this.validateMagnet(this,l,c)?(f.options.magnetThreshold<=0&&this.startConnectting(c,l,i,o),this.setEventData(c,{action:"magnet"}),this.stopPropagation(c)):this.onMouseDown(c,i,o),f.view.delegateDragEvents(c,this)}startConnectting(c,i,o,l){this.graph.model.startBatch("add-edge");const f=this.createEdgeFromMagnet(i,o,l);f.setEventData(c,f.prepareArrowheadDragging("target",{x:o,y:l,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(c,{edgeView:f}),f.notifyMouseDown(c,o,l)}getDefaultEdge(c,i){let o;const l=this.graph.options.connecting.createEdge;return l&&(o=t.FunctionExt.call(l,this.graph,{sourceMagnet:i,sourceView:c,sourceCell:c.cell})),o}createEdgeFromMagnet(c,i,o){const l=this.graph,f=l.model,g=this.getDefaultEdge(this,c);return g.setSource(Object.assign(Object.assign({},g.getSource()),this.getEdgeTerminal(c,i,o,g,"source"))),g.setTarget(Object.assign(Object.assign({},g.getTarget()),{x:i,y:o})),g.addTo(f,{async:!1,ui:!0}),g.findView(l)}dragMagnet(c,i,o){const l=this.getEventData(c),f=l.edgeView;if(f)f.onMouseMove(c,i,o),this.autoScrollGraph(c.clientX,c.clientY);else{const g=this.graph,p=g.options.magnetThreshold,m=this.getEventTarget(c),y=l.targetMagnet;if(p==="onleave"){if(y===m||y.contains(m))return}else if(g.view.getMouseMovedCount(c)<=p)return;this.startConnectting(c,y,i,o)}}stopMagnetDragging(c,i,o){const f=this.eventData(c).edgeView;f&&(f.onMouseUp(c,i,o),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(c,i,o){this.notify("node:unhandled:mousedown",{e:c,x:i,y:o,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(c,i,o,l,f){let g=[f];const p=this.graph.getPlugin("selection");if(p&&p.isSelectionMovable()){const m=p.getSelectedCells();m.includes(f)&&(g=m.filter(y=>y.isNode()))}g.forEach(m=>{this.notify(c,{e:i,x:o,y:l,cell:m,node:m,view:m.findView(this.graph)})})}getRestrictArea(c){const i=this.graph.options.translating.restrict,o=typeof i=="function"?t.FunctionExt.call(i,this.graph,c):i;return typeof o=="number"?this.graph.transform.getGraphArea().inflate(o):o===!0?this.graph.transform.getGraphArea():o||null}startNodeDragging(c,i,o){const l=this.getDelegatedView();if(l==null||!l.can("nodeMovable"))return this.notifyUnhandledMouseDown(c,i,o);this.setEventData(c,{targetView:l,action:"move"});const f=e.Point.create(l.cell.getPosition());l.setEventData(c,{moving:!1,offset:f.diff(i,o),restrict:this.getRestrictArea(l)})}dragNode(c,i,o){const l=this.cell,f=this.graph,g=f.getGridSize(),p=this.getEventData(c),m=p.offset,y=p.restrict;p.moving||(p.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",c,i,o,this.cell)),this.autoScrollGraph(c.clientX,c.clientY);const b=e.GeometryUtil.snapToGrid(i+m.x,g),v=e.GeometryUtil.snapToGrid(o+m.y,g);l.setPosition(b,v,{restrict:y,deep:!0,ui:!0}),f.options.embedding.enabled&&(p.embedding||(this.prepareEmbedding(c),p.embedding=!0),this.processEmbedding(c,p))}stopNodeDragging(c,i,o){const l=this.getEventData(c);l.embedding&&this.finalizeEmbedding(c,l),l.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",c,i,o,this.cell)),l.moving=!1,l.embedding=!1}autoScrollGraph(c,i){const o=this.graph.getPlugin("scroller");o&&o.autoScroll(c,i)}}r.NodeView=h,function(d){d.toStringTag=`X6.${d.name}`;function c(i){if(i==null)return!1;if(i instanceof d)return!0;const o=i[Symbol.toStringTag],l=i;return(o==null||o===d.toStringTag)&&typeof l.isNodeView=="function"&&typeof l.isEdgeView=="function"&&typeof l.confirmUpdate=="function"&&typeof l.update=="function"&&typeof l.findPortElem=="function"&&typeof l.resize=="function"&&typeof l.rotate=="function"&&typeof l.translate=="function"}d.isNodeView=c}(h=r.NodeView||(r.NodeView={})),h.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),h.registry.register("node",h,!0)})(Er);(function(r){var t=E&&E.__rest||function(c,i){var o={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&i.indexOf(l)<0&&(o[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(c);f<l.length;f++)i.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(c,l[f])&&(o[l[f]]=c[l[f]]);return o};Object.defineProperty(r,"__esModule",{value:!0}),r.EdgeView=void 0;const e=I,n=$,s=Dt,a=Sn,u=wn,h=Er;class d extends u.CellView{constructor(){super(...arguments);this.POINT_ROUNDING=2,this.labelDestroyFn={}}get[Symbol.toStringTag](){return d.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const i=this.sourceView;if(!i){const l=this.cell.getSource();return new e.Rectangle(l.x,l.y)}const o=this.sourceMagnet;return i.isEdgeElement(o)?new e.Rectangle(this.sourceAnchor.x,this.sourceAnchor.y):i.getBBoxOfElement(o||i.container)}get targetBBox(){const i=this.targetView;if(!i){const l=this.cell.getTarget();return new e.Rectangle(l.x,l.y)}const o=this.targetMagnet;return i.isEdgeElement(o)?new e.Rectangle(this.targetAnchor.x,this.targetAnchor.y):i.getBBoxOfElement(o||i.container)}isEdgeView(){return!0}confirmUpdate(i,o={}){let l=i;if(this.hasAction(l,"source")){if(!this.updateTerminalProperties("source"))return l;l=this.removeAction(l,"source")}if(this.hasAction(l,"target")){if(!this.updateTerminalProperties("target"))return l;l=this.removeAction(l,"target")}return this.hasAction(l,"render")?(this.render(),l=this.removeAction(l,["render","update","labels","tools"]),l):(l=this.handleAction(l,"update",()=>this.update(o)),l=this.handleAction(l,"labels",()=>this.onLabelsChange(o)),l=this.handleAction(l,"tools",()=>this.renderTools()),l)}render(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}renderMarkup(){const i=this.cell.markup;if(i){if(typeof i=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(i)}throw new TypeError("Invalid edge markup.")}renderJSONMarkup(i){const o=this.parseJSONMarkup(i,this.container);this.selectors=o.selectors,this.container.append(o.fragment)}customizeLabels(){if(this.labelContainer){const i=this.cell,o=i.labels;for(let l=0,f=o.length;l<f;l+=1){const g=o[l],p=this.labelCache[l],m=this.labelSelectors[l],y=this.graph.options.onEdgeLabelRendered;if(y){const b=y({edge:i,label:g,container:p,selectors:m});b&&(this.labelDestroyFn[l]=b)}}}}destroyCustomizeLabels(){const i=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(let o=0,l=i.length;o<l;o+=1){const f=this.labelDestroyFn[o],g=this.labelCache[o],p=this.labelSelectors[o];f&&g&&p&&f({edge:this.cell,label:i[o],container:g,selectors:p})}this.labelDestroyFn={}}renderLabels(){const i=this.cell,o=i.getLabels(),l=o.length;let f=this.labelContainer;if(this.labelCache={},this.labelSelectors={},l<=0)return f&&f.parentNode&&f.parentNode.removeChild(f),this;f?this.empty(f):(f=n.Dom.createSvgElement("g"),this.addClass(this.prefixClassName("edge-labels"),f),this.labelContainer=f);for(let g=0,p=o.length;g<p;g+=1){const m=o[g],y=this.normalizeLabelMarkup(this.parseLabelMarkup(m.markup));let b,v;if(y)b=y.node,v=y.selectors;else{const P=i.getDefaultLabel(),C=this.normalizeLabelMarkup(this.parseLabelMarkup(P.markup));b=C.node,v=C.selectors}b.setAttribute("data-index",`${g}`),f.appendChild(b);const x=this.rootSelector;if(v[x])throw new Error("Ambiguous label root selector.");v[x]=b,this.labelCache[g]=b,this.labelSelectors[g]=v}return f.parentNode==null&&this.container.appendChild(f),this.updateLabels(),this.customizeLabels(),this}onLabelsChange(i={}){this.destroyCustomizeLabels(),this.shouldRerenderLabels(i)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(i={}){const o=this.cell.previous("labels");if(o==null)return!0;if("propertyPathArray"in i&&"propertyValue"in i){const l=i.propertyPathArray||[],f=l.length;if(f>1){const g=l[1];if(o[g]){if(f===2)return typeof i.propertyValue=="object"&&n.ObjectExt.has(i.propertyValue,"markup");if(l[2]!=="markup")return!1}}}return!0}parseLabelMarkup(i){return i?typeof i=="string"?this.parseLabelStringMarkup(i):this.parseJSONMarkup(i):null}parseLabelStringMarkup(i){const o=n.Vector.createVectors(i),l=document.createDocumentFragment();for(let f=0,g=o.length;f<g;f+=1){const p=o[f].node;l.appendChild(p)}return{fragment:l,selectors:{}}}normalizeLabelMarkup(i){if(i==null)return;const o=i.fragment;if(!(o instanceof DocumentFragment)||!o.hasChildNodes())throw new Error("Invalid label markup.");let l;const f=o.childNodes;return f.length>1||f[0].nodeName.toUpperCase()!=="G"?l=n.Vector.create("g").append(o):l=n.Vector.create(f[0]),l.addClass(this.prefixClassName("edge-label")),{node:l.node,selectors:i.selectors}}updateLabels(){if(this.labelContainer){const i=this.cell,o=i.labels,l=this.can("edgeLabelMovable"),f=i.getDefaultLabel();for(let g=0,p=o.length;g<p;g+=1){const m=this.labelCache[g],y=this.labelSelectors[g];m.setAttribute("cursor",l?"move":"default");const b=o[g],v=n.ObjectExt.merge({},f.attrs,b.attrs);this.updateAttrs(m,v,{selectors:y,rootBBox:b.size?e.Rectangle.fromSize(b.size):void 0})}}}renderTools(){const i=this.cell.getTools();return this.addTools(i),this}update(i={}){this.cleanCache(),this.updateConnection(i);const o=this.cell.getAttrs(),l=t(o,["text"]);return l!=null&&this.updateAttrs(this.container,l,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(i),this}removeRedundantLinearVertices(i={}){const o=this.cell,l=o.getVertices(),f=[this.sourceAnchor,...l,this.targetAnchor],g=f.length,p=new e.Polyline(f);p.simplify({threshold:.01});const m=p.points.map(b=>b.toJSON()),y=m.length;return g===y?0:(o.setVertices(m.slice(1,y-1),i),g-y)}getTerminalView(i){switch(i){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${i}'`)}}getTerminalAnchor(i){switch(i){case"source":return e.Point.create(this.sourceAnchor);case"target":return e.Point.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${i}'`)}}getTerminalConnectionPoint(i){switch(i){case"source":return e.Point.create(this.sourcePoint);case"target":return e.Point.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${i}'`)}}getTerminalMagnet(i,o={}){switch(i){case"source":{if(o.raw)return this.sourceMagnet;const l=this.sourceView;return l?this.sourceMagnet||l.container:null}case"target":{if(o.raw)return this.targetMagnet;const l=this.targetView;return l?this.targetMagnet||l.container:null}default:throw new Error(`Unknown terminal type '${i}'`)}}updateConnection(i={}){const o=this.cell;if(i.translateBy&&o.isFragmentDescendantOf(i.translateBy)){const l=i.tx||0,f=i.ty||0;this.routePoints=new e.Polyline(this.routePoints).translate(l,f).points,this.translateConnectionPoints(l,f),this.path.translate(l,f)}else{const l=o.getVertices(),f=this.findAnchors(l);this.sourceAnchor=f.source,this.targetAnchor=f.target,this.routePoints=this.findRoutePoints(l);const g=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=g.source,this.targetPoint=g.target;const p=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,p.source||this.sourcePoint,p.target||this.targetPoint)}this.cleanCache()}findAnchors(i){const o=this.cell,l=o.source,f=o.target,g=i[0],p=i[i.length-1];return f.priority&&!l.priority?this.findAnchorsOrdered("target",p,"source",g):this.findAnchorsOrdered("source",g,"target",p)}findAnchorsOrdered(i,o,l,f){let g,p;const m=this.cell,y=m[i],b=m[l],v=this.getTerminalView(i),x=this.getTerminalView(l),P=this.getTerminalMagnet(i),C=this.getTerminalMagnet(l);if(v){let _;o?_=e.Point.create(o):x?_=C:_=e.Point.create(b),g=this.getAnchor(y.anchor,v,P,_,i)}else g=e.Point.create(y);if(x){const _=e.Point.create(f||g);p=this.getAnchor(b.anchor,x,C,_,l)}else p=e.Point.isPointLike(b)?e.Point.create(b):new e.Point;return{[i]:g,[l]:p}}getAnchor(i,o,l,f,g){const p=o.isEdgeElement(l),m=this.graph.options.connecting;let y=typeof i=="string"?{name:i}:i;if(!y){const x=p?(g==="source"?m.sourceEdgeAnchor:m.targetEdgeAnchor)||m.edgeAnchor:(g==="source"?m.sourceAnchor:m.targetAnchor)||m.anchor;y=typeof x=="string"?{name:x}:x}if(!y)throw new Error("Anchor should be specified.");let b;const v=y.name;if(p){const x=s.EdgeAnchor.registry.get(v);if(typeof x!="function")return s.EdgeAnchor.registry.onNotFound(v);b=n.FunctionExt.call(x,this,o,l,f,y.args||{},g)}else{const x=s.NodeAnchor.registry.get(v);if(typeof x!="function")return s.NodeAnchor.registry.onNotFound(v);b=n.FunctionExt.call(x,this,o,l,f,y.args||{},g)}return b?b.round(this.POINT_ROUNDING):new e.Point}findRoutePoints(i=[]){const o=this.graph.options.connecting.router||s.Router.presets.normal,l=this.cell.getRouter()||o;let f;if(typeof l=="function")f=n.FunctionExt.call(l,this,i,{},this);else{const g=typeof l=="string"?l:l.name,p=typeof l=="string"?{}:l.args||{},m=g?s.Router.registry.get(g):s.Router.presets.normal;if(typeof m!="function")return s.Router.registry.onNotFound(g);f=n.FunctionExt.call(m,this,i,p,this)}return f==null?i.map(g=>e.Point.create(g)):f.map(g=>e.Point.create(g))}findConnectionPoints(i,o,l){const f=this.cell,g=this.graph.options.connecting,p=f.getSource(),m=f.getTarget(),y=this.sourceView,b=this.targetView,v=i[0],x=i[i.length-1];let P;if(y&&!y.isEdgeElement(this.sourceMagnet)){const _=this.sourceMagnet||y.container,A=v||l,S=new e.Line(A,o),w=p.connectionPoint||g.sourceConnectionPoint||g.connectionPoint;P=this.getConnectionPoint(w,y,_,S,"source")}else P=o;let C;if(b&&!b.isEdgeElement(this.targetMagnet)){const _=this.targetMagnet||b.container,A=m.connectionPoint||g.targetConnectionPoint||g.connectionPoint,S=x||o,w=new e.Line(S,l);C=this.getConnectionPoint(A,b,_,w,"target")}else C=l;return{source:P,target:C}}getConnectionPoint(i,o,l,f,g){const p=f.end;if(i==null)return p;const m=typeof i=="string"?i:i.name,y=typeof i=="string"?{}:i.args,b=s.ConnectionPoint.registry.get(m);if(typeof b!="function")return s.ConnectionPoint.registry.onNotFound(m);const v=n.FunctionExt.call(b,this,f,o,l,y||{},g);return v?v.round(this.POINT_ROUNDING):p}findMarkerPoints(i,o,l){const f=x=>{const P=this.cell.getAttrs(),C=Object.keys(P);for(let _=0,A=C.length;_<A;_+=1){const S=P[C[_]];if(S[`${x}Marker`]||S[`${x}-marker`]){const w=S.strokeWidth||S["stroke-width"];if(w)return parseFloat(w);break}}return null},g=i[0],p=i[i.length-1];let m,y;const b=f("source");b&&(m=o.clone().move(g||l,-b));const v=f("target");return v&&(y=l.clone().move(p||o,-v)),this.sourceMarkerPoint=m||o.clone(),this.targetMarkerPoint=y||l.clone(),{source:m,target:y}}findPath(i,o,l){const f=this.cell.getConnector()||this.graph.options.connecting.connector;let g,p,m;if(typeof f=="string"?g=f:(g=f.name,p=f.args),g){const b=s.Connector.registry.get(g);if(typeof b!="function")return s.Connector.registry.onNotFound(g);m=b}else m=s.Connector.presets.normal;const y=n.FunctionExt.call(m,this,o,l,i,Object.assign(Object.assign({},p),{raw:!0}),this);return typeof y=="string"?e.Path.parse(y):y}translateConnectionPoints(i,o){this.sourcePoint.translate(i,o),this.targetPoint.translate(i,o),this.sourceAnchor.translate(i,o),this.targetAnchor.translate(i,o),this.sourceMarkerPoint.translate(i,o),this.targetMarkerPoint.translate(i,o)}updateLabelPositions(){if(this.labelContainer==null)return this;if(!this.path)return this;const o=this.cell,l=o.getLabels();if(l.length===0)return this;const f=o.getDefaultLabel(),g=this.normalizeLabelPosition(f.position);for(let p=0,m=l.length;p<m;p+=1){const y=l[p],b=this.labelCache[p];if(!b)continue;const v=this.normalizeLabelPosition(y.position),x=n.ObjectExt.merge({},g,v),P=this.getLabelTransformationMatrix(x);b.setAttribute("transform",n.Dom.matrixToTransformString(P))}return this}updateTerminalProperties(i){const o=this.cell,l=this.graph,f=o[i],g=f&&f.cell,p=`${i}View`;if(!g)return this[p]=null,this.updateTerminalMagnet(i),!0;const m=l.getCellById(g);if(!m)throw new Error(`Edge's ${i} node with id "${g}" not exists`);const y=m.findView(l);return y?(this[p]=y,this.updateTerminalMagnet(i),!0):!1}updateTerminalMagnet(i){const o=`${i}Magnet`,l=this.getTerminalView(i);if(l){let f=l.getMagnetFromEdgeTerminal(this.cell[i]);f===l.container&&(f=null),this[o]=f}else this[o]=null}getLabelPositionAngle(i){const o=this.cell.getLabelAt(i);return o&&o.position&&typeof o.position=="object"&&o.position.angle||0}getLabelPositionArgs(i){const o=this.cell.getLabelAt(i);if(o&&o.position&&typeof o.position=="object")return o.position.options}getDefaultLabelPositionArgs(){const i=this.cell.getDefaultLabel();if(i&&i.position&&typeof i.position=="object")return i.position.options}mergeLabelPositionArgs(i,o){return i===null?null:i===void 0?o===null?null:o:n.ObjectExt.merge({},o,i)}getConnection(){return this.path!=null?this.path.clone():null}getConnectionPathData(){if(this.path==null)return"";const i=this.cache.pathCache;return n.ObjectExt.has(i,"data")||(i.data=this.path.serialize()),i.data||""}getConnectionSubdivisions(){if(this.path==null)return null;const i=this.cache.pathCache;return n.ObjectExt.has(i,"segmentSubdivisions")||(i.segmentSubdivisions=this.path.getSegmentSubdivisions()),i.segmentSubdivisions}getConnectionLength(){if(this.path==null)return 0;const i=this.cache.pathCache;return n.ObjectExt.has(i,"length")||(i.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),i.length}getPointAtLength(i){return this.path==null?null:this.path.pointAtLength(i,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(i){return this.path==null?null:(n.NumberExt.isPercentage(i)&&(i=parseFloat(i)/100),this.path.pointAt(i,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(i){return this.path==null?null:this.path.tangentAtLength(i,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(i){return this.path==null?null:this.path.tangentAt(i,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(i){return this.path==null?null:this.path.closestPoint(i,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(i){return this.path==null?null:this.path.closestPointLength(i,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(i){return this.path==null?null:this.path.closestPointNormalizedLength(i,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(i,o,l,f){const g={distance:0};let p=0,m;typeof l=="number"?(p=l,m=f):m=l,m!=null&&(g.options=m);const y=m&&m.absoluteOffset,b=!(m&&m.absoluteDistance),v=m&&m.absoluteDistance&&m.reverseDistance,x=this.path,P={segmentSubdivisions:this.getConnectionSubdivisions()},C=new e.Point(i,o),_=x.closestPointT(C,P),A=this.getConnectionLength()||0;let S=x.lengthAtT(_,P);b&&(S=A>0?S/A:0),v&&(S=-1*(A-S)||1),g.distance=S;let w;y||(w=x.tangentAtT(_));let O;if(w)O=w.pointOffset(C);else{const M=x.pointAtT(_),T=C.diff(M);O={x:T.x,y:T.y}}return g.offset=O,g.angle=p,g}normalizeLabelPosition(i){return typeof i=="number"?{distance:i}:i}getLabelTransformationMatrix(i){const o=this.normalizeLabelPosition(i),l=o.options||{},f=o.angle||0,g=o.distance,p=g>0&&g<=1;let m=0;const y={x:0,y:0},b=o.offset;b&&(typeof b=="number"?m=b:(b.x!=null&&(y.x=b.x),b.y!=null&&(y.y=b.y)));const v=y.x!==0||y.y!==0||m===0,x=l.keepGradient,P=l.ensureLegibility,C=this.path,_={segmentSubdivisions:this.getConnectionSubdivisions()},A=p?g*this.getConnectionLength():g,S=C.tangentAtLength(A,_);let w,O=f;if(S){if(v)w=S.start,w.translate(y);else{const M=S.clone();M.rotate(-90,S.start),M.setLength(m),w=M.end}x&&(O=S.angle()+f,P&&(O=e.Angle.normalize((O+90)%180-90)))}else w=C.start,v&&w.translate(y);return n.Dom.createSVGMatrix().translate(w.x,w.y).rotate(O)}getVertexIndex(i,o){const f=this.cell.getVertices(),g=this.getClosestPointLength(new e.Point(i,o));let p=0;if(g!=null)for(const m=f.length;p<m;p+=1){const y=f[p],b=this.getClosestPointLength(y);if(b!=null&&g<b)break}return p}getEventArgs(i,o,l){const f=this,g=f.cell,p=g;return o==null||l==null?{e:i,view:f,edge:g,cell:p}:{e:i,x:o,y:l,view:f,edge:g,cell:p}}notifyUnhandledMouseDown(i,o,l){this.notify("edge:unhandled:mousedown",{e:i,x:o,y:l,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(i,o,l){super.onMouseDown(i,o,l),this.notify("edge:mousedown",this.getEventArgs(i,o,l))}notifyMouseMove(i,o,l){super.onMouseMove(i,o,l),this.notify("edge:mousemove",this.getEventArgs(i,o,l))}notifyMouseUp(i,o,l){super.onMouseUp(i,o,l),this.notify("edge:mouseup",this.getEventArgs(i,o,l))}onClick(i,o,l){super.onClick(i,o,l),this.notify("edge:click",this.getEventArgs(i,o,l))}onDblClick(i,o,l){super.onDblClick(i,o,l),this.notify("edge:dblclick",this.getEventArgs(i,o,l))}onContextMenu(i,o,l){super.onContextMenu(i,o,l),this.notify("edge:contextmenu",this.getEventArgs(i,o,l))}onMouseDown(i,o,l){this.notifyMouseDown(i,o,l),this.startEdgeDragging(i,o,l)}onMouseMove(i,o,l){const f=this.getEventData(i);switch(f.action){case"drag-label":{this.dragLabel(i,o,l);break}case"drag-arrowhead":{this.dragArrowhead(i,o,l);break}case"drag-edge":{this.dragEdge(i,o,l);break}}return this.notifyMouseMove(i,o,l),f}onMouseUp(i,o,l){const f=this.getEventData(i);switch(f.action){case"drag-label":{this.stopLabelDragging(i,o,l);break}case"drag-arrowhead":{this.stopArrowheadDragging(i,o,l);break}case"drag-edge":{this.stopEdgeDragging(i,o,l);break}}return this.notifyMouseUp(i,o,l),this.checkMouseleave(i),f}onMouseOver(i){super.onMouseOver(i),this.notify("edge:mouseover",this.getEventArgs(i))}onMouseOut(i){super.onMouseOut(i),this.notify("edge:mouseout",this.getEventArgs(i))}onMouseEnter(i){super.onMouseEnter(i),this.notify("edge:mouseenter",this.getEventArgs(i))}onMouseLeave(i){super.onMouseLeave(i),this.notify("edge:mouseleave",this.getEventArgs(i))}onMouseWheel(i,o,l,f){super.onMouseWheel(i,o,l,f),this.notify("edge:mousewheel",Object.assign({delta:f},this.getEventArgs(i,o,l)))}onCustomEvent(i,o,l,f){if(n.Dom.findParentByClass(i.target,"edge-tool",this.container)){if(i.stopPropagation(),this.can("useEdgeTools")){if(o==="edge:remove"){this.cell.remove({ui:!0});return}this.notify("edge:customevent",Object.assign({name:o},this.getEventArgs(i,l,f)))}this.notifyMouseDown(i,l,f)}else this.notify("edge:customevent",Object.assign({name:o},this.getEventArgs(i,l,f))),super.onCustomEvent(i,o,l,f)}onLabelMouseDown(i,o,l){this.notifyMouseDown(i,o,l),this.startLabelDragging(i,o,l),this.getEventData(i).stopPropagation&&i.stopPropagation()}startEdgeDragging(i,o,l){if(!this.can("edgeMovable")){this.notifyUnhandledMouseDown(i,o,l);return}this.setEventData(i,{x:o,y:l,moving:!1,action:"drag-edge"})}dragEdge(i,o,l){const f=this.getEventData(i);f.moving||(f.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:i,x:o,y:l,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(o-f.x,l-f.y,{ui:!0}),this.setEventData(i,{x:o,y:l}),this.notify("edge:moving",{e:i,x:o,y:l,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(i,o,l){const f=this.getEventData(i);f.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:i,x:o,y:l,view:this,cell:this.cell,edge:this.cell})),f.moving=!1}prepareArrowheadDragging(i,o){const l=this.getTerminalMagnet(i),f={action:"drag-arrowhead",x:o.x,y:o.y,isNewEdge:o.isNewEdge===!0,terminalType:i,initialMagnet:l,initialTerminal:n.ObjectExt.clone(this.cell[i]),fallbackAction:o.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(i),options:o.options};return this.beforeArrowheadDragging(f),f}createValidateConnectionArgs(i){const o=[];o[4]=i,o[5]=this;let l,f=0,g=0;i==="source"?(f=2,l="target"):(g=2,l="source");const p=this.cell[l],m=p.cell;if(m){let y;const b=o[f]=this.graph.findViewByCell(m);b&&(y=b.getMagnetFromEdgeTerminal(p),y===b.container&&(y=void 0)),o[f+1]=y}return(y,b)=>(o[g]=y,o[g+1]=y.container===b?void 0:b,o)}beforeArrowheadDragging(i){i.zIndex=this.cell.zIndex,this.cell.toFront();const o=this.container.style;i.pointerEvents=o.pointerEvents,o.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(i)}afterArrowheadDragging(i){i.zIndex!=null&&(this.cell.setZIndex(i.zIndex,{ui:!0}),i.zIndex=null);const o=this.container;o.style.pointerEvents=i.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(i)}validateConnection(i,o,l,f,g,p,m){const y=this.graph.options.connecting,b=y.allowLoop,v=y.allowNode,x=y.allowEdge,P=y.allowPort,C=y.allowMulti,_=y.validateConnection,A=p?p.cell:null,S=g==="target"?l:i,w=g==="target"?f:o;let O=!0;const M=T=>{const j=g==="source"?m?m.port:null:A?A.getSourcePortId():null,N=g==="target"?m?m.port:null:A?A.getTargetPortId():null;return n.FunctionExt.call(T,this.graph,{edge:A,edgeView:p,sourceView:i,targetView:l,sourcePort:j,targetPort:N,sourceMagnet:o,targetMagnet:f,sourceCell:i?i.cell:null,targetCell:l?l.cell:null,type:g})};if(b!=null&&(typeof b=="boolean"?!b&&i===l&&(O=!1):O=M(b)),O&&P!=null&&(typeof P=="boolean"?!P&&w&&(O=!1):O=M(P)),O&&x!=null&&(typeof x=="boolean"?!x&&d.isEdgeView(S)&&(O=!1):O=M(x)),O&&v!=null&&w==null&&(typeof v=="boolean"?!v&&h.NodeView.isNodeView(S)&&(O=!1):O=M(v)),O&&C!=null&&p){const T=p.cell,j=g==="source"?m:T.getSource(),N=g==="target"?m:T.getTarget(),D=m?this.graph.getCellById(m.cell):null;if(j&&N&&j.cell&&N.cell&&D)if(typeof C=="function")O=M(C);else{const B=this.graph.model.getConnectedEdges(D,{outgoing:g==="source",incoming:g==="target"});B.length&&(C==="withPort"?B.some(z=>{const W=z.getSource(),U=z.getTarget();return W&&U&&W.cell===j.cell&&U.cell===N.cell&&W.port!=null&&W.port===j.port&&U.port!=null&&U.port===N.port})&&(O=!1):C||B.some(z=>{const W=z.getSource(),U=z.getTarget();return W&&U&&W.cell===j.cell&&U.cell===N.cell})&&(O=!1))}}return O&&_!=null&&(O=M(_)),O}allowConnectToBlank(i){const o=this.graph,f=o.options.connecting.allowBlank;if(typeof f!="function")return!!f;const g=o.findViewByCell(i),p=i.getSourceCell(),m=i.getTargetCell(),y=o.findViewByCell(p),b=o.findViewByCell(m);return n.FunctionExt.call(f,o,{edge:i,edgeView:g,sourceCell:p,targetCell:m,sourceView:y,targetView:b,sourcePort:i.getSourcePortId(),targetPort:i.getTargetPortId(),sourceMagnet:g.sourceMagnet,targetMagnet:g.targetMagnet})}validateEdge(i,o,l){const f=this.graph;if(!this.allowConnectToBlank(i)){const p=i.getSourceCellId(),m=i.getTargetCellId();if(!(p&&m))return!1}const g=f.options.connecting.validateEdge;return g?n.FunctionExt.call(g,f,{edge:i,type:o,previous:l}):!0}arrowheadDragging(i,o,l,f){f.x=o,f.y=l,f.currentTarget!==i&&(f.currentMagnet&&f.currentView&&f.currentView.unhighlight(f.currentMagnet,{type:"magnetAdsorbed"}),f.currentView=this.graph.findViewByElem(i),f.currentView?(f.currentMagnet=f.currentView.findMagnet(i),f.currentMagnet&&this.validateConnection(...f.getValidateConnectionArgs(f.currentView,f.currentMagnet),f.currentView.getEdgeTerminal(f.currentMagnet,o,l,this.cell,f.terminalType))?f.currentView.highlight(f.currentMagnet,{type:"magnetAdsorbed"}):f.currentMagnet=null):f.currentMagnet=null),f.currentTarget=i,this.cell.prop(f.terminalType,{x:o,y:l},Object.assign(Object.assign({},f.options),{ui:!0}))}arrowheadDragged(i,o,l){const f=i.currentView,g=i.currentMagnet;if(!g||!f)return;f.unhighlight(g,{type:"magnetAdsorbed"});const p=i.terminalType,m=f.getEdgeTerminal(g,o,l,this.cell,p);this.cell.setTerminal(p,m,{ui:!0})}snapArrowhead(i,o,l){const f=this.graph,{snap:g,allowEdge:p}=f.options.connecting,m=typeof g=="object"&&g.radius||50,y=typeof g=="object"&&g.anchor||"center",b=f.renderer.findViewsInArea({x:i-m,y:o-m,width:2*m,height:2*m},{nodeOnly:!0});if(p){const T=f.renderer.findEdgeViewsFromPoint({x:i,y:o},m).filter(j=>j!==this);b.push(...T)}const v=l.closestView||null,x=l.closestMagnet||null;l.closestView=null,l.closestMagnet=null;let P,C=Number.MAX_SAFE_INTEGER;const _=new e.Point(i,o);b.forEach(T=>{if(T.container.getAttribute("magnet")!=="false"){if(T.isNodeView())P=y==="center"?T.cell.getBBox().getCenter().distance(_):T.cell.getBBox().getNearestPointToPoint(_).distance(_);else if(T.isEdgeView()){const j=T.getClosestPoint(_);j?P=j.distance(_):P=Number.MAX_SAFE_INTEGER}P<m&&P<C&&(x===T.container||this.validateConnection(...l.getValidateConnectionArgs(T,null),T.getEdgeTerminal(T.container,i,o,this.cell,l.terminalType)))&&(C=P,l.closestView=T,l.closestMagnet=T.container)}T.container.querySelectorAll("[magnet]").forEach(j=>{if(j.getAttribute("magnet")!=="false"){const N=T.getBBoxOfElement(j);P=_.distance(N.getCenter()),P<m&&P<C&&(x===j||this.validateConnection(...l.getValidateConnectionArgs(T,j),T.getEdgeTerminal(j,i,o,this.cell,l.terminalType)))&&(C=P,l.closestView=T,l.closestMagnet=j)}})});let A;const S=l.terminalType,w=l.closestView,O=l.closestMagnet,M=x!==O;if(v&&M&&v.unhighlight(x,{type:"magnetAdsorbed"}),w){if(!M)return;w.highlight(O,{type:"magnetAdsorbed"}),A=w.getEdgeTerminal(O,i,o,this.cell,S)}else A={x:i,y:o};this.cell.setTerminal(S,A,{},Object.assign(Object.assign({},l.options),{ui:!0}))}snapArrowheadEnd(i){const o=i.closestView,l=i.closestMagnet;o&&l&&(o.unhighlight(l,{type:"magnetAdsorbed"}),i.currentMagnet=o.findMagnet(l)),i.closestView=null,i.closestMagnet=null}finishEmbedding(i){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(i.zIndex=null)}fallbackConnection(i){switch(i.fallbackAction){case"remove":this.cell.remove({ui:!0});break;case"revert":default:this.cell.prop(i.terminalType,i.initialTerminal,{ui:!0});break}}notifyConnectionEvent(i,o){const l=i.terminalType,f=i.initialTerminal,g=this.cell[l];if(g&&!a.Edge.equalTerminals(f,g)){const m=this.graph,y=f,b=y.cell?m.getCellById(y.cell):null,v=y.port,x=b?m.findViewByCell(b):null,P=b||i.isNewEdge?null:e.Point.create(f).toJSON(),C=g,_=C.cell?m.getCellById(C.cell):null,A=C.port,S=_?m.findViewByCell(_):null,w=_?null:e.Point.create(g).toJSON();this.notify("edge:connected",{e:o,previousCell:b,previousPort:v,previousView:x,previousPoint:P,currentCell:_,currentView:S,currentPort:A,currentPoint:w,previousMagnet:i.initialMagnet,currentMagnet:i.currentMagnet,edge:this.cell,view:this,type:l,isNew:i.isNewEdge})}}highlightAvailableMagnets(i){const o=this.graph,l=o.model.getCells();i.marked={};for(let f=0,g=l.length;f<g;f+=1){const p=o.findViewByCell(l[f]);if(!p||p.cell.id===this.cell.id)continue;const m=Array.prototype.slice.call(p.container.querySelectorAll("[magnet]"));p.container.getAttribute("magnet")!=="false"&&m.push(p.container);const y=m.filter(b=>this.validateConnection(...i.getValidateConnectionArgs(p,b),p.getEdgeTerminal(b,i.x,i.y,this.cell,i.terminalType)));if(y.length>0){for(let b=0,v=y.length;b<v;b+=1)p.highlight(y[b],{type:"magnetAvailable"});p.highlight(null,{type:"nodeAvailable"}),i.marked[p.cell.id]=y}}}unhighlightAvailableMagnets(i){const o=i.marked||{};Object.keys(o).forEach(l=>{const f=this.graph.findViewByCell(l);f&&(o[l].forEach(p=>{f.unhighlight(p,{type:"magnetAvailable"})}),f.unhighlight(null,{type:"nodeAvailable"}))}),i.marked=null}startArrowheadDragging(i,o,l){if(!this.can("arrowheadMovable")){this.notifyUnhandledMouseDown(i,o,l);return}const g=i.target.getAttribute("data-terminal"),p=this.prepareArrowheadDragging(g,{x:o,y:l});this.setEventData(i,p)}dragArrowhead(i,o,l){const f=this.getEventData(i);this.graph.options.connecting.snap?this.snapArrowhead(o,l,f):this.arrowheadDragging(this.getEventTarget(i),o,l,f)}stopArrowheadDragging(i,o,l){const f=this.graph,g=this.getEventData(i);f.options.connecting.snap?this.snapArrowheadEnd(g):this.arrowheadDragged(g,o,l),this.validateEdge(this.cell,g.terminalType,g.initialTerminal)?(this.finishEmbedding(g),this.notifyConnectionEvent(g,i)):this.fallbackConnection(g),this.afterArrowheadDragging(g)}startLabelDragging(i,o,l){if(this.can("edgeLabelMovable")){const f=i.currentTarget,g=parseInt(f.getAttribute("data-index"),10),p=this.getLabelPositionAngle(g),m=this.getLabelPositionArgs(g),y=this.getDefaultLabelPositionArgs(),b=this.mergeLabelPositionArgs(m,y);this.setEventData(i,{index:g,positionAngle:p,positionArgs:b,stopPropagation:!0,action:"drag-label"})}else this.setEventData(i,{stopPropagation:!0});this.graph.view.delegateDragEvents(i,this)}dragLabel(i,o,l){const f=this.getEventData(i),g=this.cell.getLabelAt(f.index),p=n.ObjectExt.merge({},g,{position:this.getLabelPosition(o,l,f.positionAngle,f.positionArgs)});this.cell.setLabelAt(f.index,p)}stopLabelDragging(i,o,l){}}r.EdgeView=d,function(c){c.toStringTag=`X6.${c.name}`;function i(o){if(o==null)return!1;if(o instanceof c)return!0;const l=o[Symbol.toStringTag],f=o;return(l==null||l===c.toStringTag)&&typeof f.isNodeView=="function"&&typeof f.isEdgeView=="function"&&typeof f.confirmUpdate=="function"&&typeof f.update=="function"&&typeof f.getConnection=="function"}c.isEdgeView=i}(d=r.EdgeView||(r.EdgeView={})),d.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),d.registry.register("edge",d,!0)})(Pc);(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(Oe,r),e(Pe,r),e(wn,r),e(Pc,r),e(Er,r),e(Rt,r)})(_e);var ro={},so={};(function(r){var t=E&&E.__decorate||function(h,d,c,i){var o=arguments.length,l=o<3?d:i===null?i=Object.getOwnPropertyDescriptor(d,c):i,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(h,d,c,i);else for(var g=h.length-1;g>=0;g--)(f=h[g])&&(l=(o<3?f(l):o>3?f(d,c,l):f(d,c))||l);return o>3&&l&&Object.defineProperty(d,c,l),l};Object.defineProperty(r,"__esModule",{value:!0}),r.GraphView=void 0;const e=$,n=Ve,s=$t,a=_e;class u extends a.View{get disposeContainer(){return!1}get options(){return this.graph.options}constructor(d){super();this.graph=d;const{selectors:c,fragment:i}=a.Markup.parseJSONMarkup(u.markup);this.background=c.background,this.grid=c.grid,this.svg=c.svg,this.defs=c.defs,this.viewport=c.viewport,this.primer=c.primer,this.stage=c.stage,this.decorator=c.decorator,this.overlay=c.overlay,this.container=this.options.container,this.restore=u.snapshoot(this.container),e.Dom.addClass(this.container,this.prefixClassName("graph")),e.Dom.append(this.container,i),this.delegateEvents()}delegateEvents(){const d=this.constructor;return super.delegateEvents(d.events),this}guard(d,c){return d.type==="mousedown"&&d.button===2||this.options.guard&&this.options.guard(d,c)?!0:d.data&&d.data.guarded!==void 0?d.data.guarded:!(c&&c.cell&&n.Cell.isCell(c.cell)||this.svg===d.target||this.container===d.target||this.svg.contains(d.target))}findView(d){return this.graph.findViewByElem(d)}onDblClick(d){this.options.preventDefaultDblClick&&d.preventDefault();const c=this.normalizeEvent(d),i=this.findView(c.target);if(this.guard(c,i))return;const o=this.graph.snapToGrid(c.clientX,c.clientY);i?i.onDblClick(c,o.x,o.y):this.graph.trigger("blank:dblclick",{e:c,x:o.x,y:o.y})}onClick(d){if(this.getMouseMovedCount(d)<=this.options.clickThreshold){const c=this.normalizeEvent(d),i=this.findView(c.target);if(this.guard(c,i))return;const o=this.graph.snapToGrid(c.clientX,c.clientY);i?i.onClick(c,o.x,o.y):this.graph.trigger("blank:click",{e:c,x:o.x,y:o.y})}}isPreventDefaultContextMenu(d){let c=this.options.preventDefaultContextMenu;return typeof c=="function"&&(c=e.FunctionExt.call(c,this.graph,{view:d})),c}onContextMenu(d){const c=this.normalizeEvent(d),i=this.findView(c.target);if(this.isPreventDefaultContextMenu(i)&&d.preventDefault(),this.guard(c,i))return;const o=this.graph.snapToGrid(c.clientX,c.clientY);i?i.onContextMenu(c,o.x,o.y):this.graph.trigger("blank:contextmenu",{e:c,x:o.x,y:o.y})}delegateDragEvents(d,c){d.data==null&&(d.data={}),this.setEventData(d,{currentView:c||null,mouseMovedCount:0,startPosition:{x:d.clientX,y:d.clientY}});const i=this.constructor;this.delegateDocumentEvents(i.documentEvents,d.data),this.undelegateEvents()}getMouseMovedCount(d){return this.getEventData(d).mouseMovedCount||0}onMouseDown(d){const c=this.normalizeEvent(d),i=this.findView(c.target);if(this.guard(c,i))return;this.options.preventDefaultMouseDown&&d.preventDefault();const o=this.graph.snapToGrid(c.clientX,c.clientY);i?i.onMouseDown(c,o.x,o.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(c.type)&&d.preventDefault(),this.graph.trigger("blank:mousedown",{e:c,x:o.x,y:o.y})),this.delegateDragEvents(c,i)}onMouseMove(d){const c=this.getEventData(d),i=c.startPosition;if(i&&i.x===d.clientX&&i.y===d.clientY||(c.mouseMovedCount==null&&(c.mouseMovedCount=0),c.mouseMovedCount+=1,c.mouseMovedCount<=this.options.moveThreshold))return;const l=this.normalizeEvent(d),f=this.graph.snapToGrid(l.clientX,l.clientY),g=c.currentView;g?g.onMouseMove(l,f.x,f.y):this.graph.trigger("blank:mousemove",{e:l,x:f.x,y:f.y}),this.setEventData(l,c)}onMouseUp(d){this.undelegateDocumentEvents();const c=this.normalizeEvent(d),i=this.graph.snapToGrid(c.clientX,c.clientY),l=this.getEventData(d).currentView;if(l?l.onMouseUp(c,i.x,i.y):this.graph.trigger("blank:mouseup",{e:c,x:i.x,y:i.y}),!d.isPropagationStopped()){const f=new e.Dom.EventObject(d,{type:"click",data:d.data});this.onClick(f)}d.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(d){const c=this.normalizeEvent(d),i=this.findView(c.target);if(!this.guard(c,i))if(i)i.onMouseOver(c);else{if(this.container===c.target)return;this.graph.trigger("blank:mouseover",{e:c})}}onMouseOut(d){const c=this.normalizeEvent(d),i=this.findView(c.target);if(!this.guard(c,i))if(i)i.onMouseOut(c);else{if(this.container===c.target)return;this.graph.trigger("blank:mouseout",{e:c})}}onMouseEnter(d){const c=this.normalizeEvent(d),i=this.findView(c.target);if(this.guard(c,i))return;const o=this.graph.findViewByElem(c.relatedTarget);if(i){if(o===i)return;i.onMouseEnter(c)}else{if(o)return;this.graph.trigger("graph:mouseenter",{e:c})}}onMouseLeave(d){const c=this.normalizeEvent(d),i=this.findView(c.target);if(this.guard(c,i))return;const o=this.graph.findViewByElem(c.relatedTarget);if(i){if(o===i)return;i.onMouseLeave(c)}else{if(o)return;this.graph.trigger("graph:mouseleave",{e:c})}}onMouseWheel(d){const c=this.normalizeEvent(d),i=this.findView(c.target);if(this.guard(c,i))return;const o=c.originalEvent,l=this.graph.snapToGrid(o.clientX,o.clientY),f=Math.max(-1,Math.min(1,o.wheelDelta||-o.detail));i?i.onMouseWheel(c,l.x,l.y,f):this.graph.trigger("blank:mousewheel",{e:c,delta:f,x:l.x,y:l.y})}onCustomEvent(d){const c=d.currentTarget,i=c.getAttribute("event")||c.getAttribute("data-event");if(i){const o=this.findView(c);if(o){const l=this.normalizeEvent(d);if(this.guard(l,o))return;const f=this.graph.snapToGrid(l.clientX,l.clientY);o.onCustomEvent(l,i,f.x,f.y)}}}handleMagnetEvent(d,c){const i=d.currentTarget,o=i.getAttribute("magnet");if(o&&o.toLowerCase()!=="false"){const l=this.findView(i);if(l){const f=this.normalizeEvent(d);if(this.guard(f,l))return;const g=this.graph.snapToGrid(f.clientX,f.clientY);e.FunctionExt.call(c,this.graph,l,f,i,g.x,g.y)}}}onMagnetMouseDown(d){this.handleMagnetEvent(d,(c,i,o,l,f)=>{c.onMagnetMouseDown(i,o,l,f)})}onMagnetDblClick(d){this.handleMagnetEvent(d,(c,i,o,l,f)=>{c.onMagnetDblClick(i,o,l,f)})}onMagnetContextMenu(d){const c=this.findView(d.target);this.isPreventDefaultContextMenu(c)&&d.preventDefault(),this.handleMagnetEvent(d,(i,o,l,f,g)=>{i.onMagnetContextMenu(o,l,f,g)})}onLabelMouseDown(d){const c=d.currentTarget,i=this.findView(c);if(i){const o=this.normalizeEvent(d);if(this.guard(o,i))return;const l=this.graph.snapToGrid(o.clientX,o.clientY);i.onLabelMouseDown(o,l.x,l.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}t([a.View.dispose()],u.prototype,"dispose",null),r.GraphView=u,function(h){const d=`${s.Config.prefixCls}-graph`;h.markup=[{ns:e.Dom.ns.xhtml,tagName:"div",selector:"background",className:`${d}-background`},{ns:e.Dom.ns.xhtml,tagName:"div",selector:"grid",className:`${d}-grid`},{ns:e.Dom.ns.svg,tagName:"svg",selector:"svg",className:`${d}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":e.Dom.ns.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${d}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${d}-svg-primer`},{tagName:"g",selector:"stage",className:`${d}-svg-stage`},{tagName:"g",selector:"decorator",className:`${d}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${d}-svg-overlay`}]}]}];function c(i){const o=i.cloneNode();return i.childNodes.forEach(l=>o.appendChild(l)),()=>{for(e.Dom.empty(i);i.attributes.length>0;)i.removeAttribute(i.attributes[0].name);for(let l=0,f=o.attributes.length;l<f;l+=1){const g=o.attributes[l];i.setAttribute(g.name,g.value)}o.childNodes.forEach(l=>i.appendChild(l))}}h.snapshoot=c}(u=r.GraphView||(r.GraphView={})),function(h){const d=s.Config.prefixCls;h.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${d}-cell`]:"onMouseEnter",[`mouseleave  .${d}-cell`]:"onMouseLeave",[`mouseenter  .${d}-cell-tools`]:"onMouseEnter",[`mouseleave  .${d}-cell-tools`]:"onMouseLeave",[`mousedown   .${d}-cell [event]`]:"onCustomEvent",[`touchstart  .${d}-cell [event]`]:"onCustomEvent",[`mousedown   .${d}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${d}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${d}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${d}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${d}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${d}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${d}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${d}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${d}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${d}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${d}-cell image`]:"onImageDragStart",[`mousedown   .${d}-edge .${d}-edge-label`]:"onLabelMouseDown",[`touchstart  .${d}-edge .${d}-edge-label`]:"onLabelMouseDown"},h.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(u=r.GraphView||(r.GraphView={}))})(so);var Cr={},_r={};Object.defineProperty(_r,"__esModule",{value:!0});_r.content=void 0;_r.content=`.x6-graph {
  position: relative;
  overflow: hidden;
  outline: none;
  touch-action: none;
}
.x6-graph-background,
.x6-graph-grid,
.x6-graph-svg {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-background-stage,
.x6-graph-grid-stage,
.x6-graph-svg-stage {
  user-select: none;
}
.x6-graph.x6-graph-pannable {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph.x6-graph-panning {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-node {
  cursor: move;
  /* stylelint-disable-next-line */
}
.x6-node.x6-node-immovable {
  cursor: default;
}
.x6-node * {
  -webkit-user-drag: none;
}
.x6-node .scalable * {
  vector-effect: non-scaling-stroke;
}
.x6-node [magnet='true'] {
  cursor: crosshair;
  transition: opacity 0.3s;
}
.x6-node [magnet='true']:hover {
  opacity: 0.7;
}
.x6-node foreignObject {
  display: block;
  overflow: visible;
  background-color: transparent;
}
.x6-node foreignObject > body {
  position: static;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
  background-color: transparent;
}
.x6-edge .source-marker,
.x6-edge .target-marker {
  vector-effect: non-scaling-stroke;
}
.x6-edge .connection {
  stroke-linejoin: round;
  fill: none;
}
.x6-edge .connection-wrap {
  cursor: move;
  opacity: 0;
  fill: none;
  stroke: #000;
  stroke-width: 15;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.x6-edge .connection-wrap:hover {
  opacity: 0.4;
  stroke-opacity: 0.4;
}
.x6-edge .vertices {
  cursor: move;
  opacity: 0;
}
.x6-edge .vertices .vertex {
  fill: #1abc9c;
}
.x6-edge .vertices .vertex :hover {
  fill: #34495e;
  stroke: none;
}
.x6-edge .vertices .vertex-remove {
  cursor: pointer;
  fill: #fff;
}
.x6-edge .vertices .vertex-remove-area {
  cursor: pointer;
  opacity: 0.1;
}
.x6-edge .vertices .vertex-group:hover .vertex-remove-area {
  opacity: 1;
}
.x6-edge .arrowheads {
  cursor: move;
  opacity: 0;
}
.x6-edge .arrowheads .arrowhead {
  fill: #1abc9c;
}
.x6-edge .arrowheads .arrowhead :hover {
  fill: #f39c12;
  stroke: none;
}
.x6-edge .tools {
  cursor: pointer;
  opacity: 0;
}
.x6-edge .tools .tool-options {
  display: none;
}
.x6-edge .tools .tool-remove circle {
  fill: #f00;
}
.x6-edge .tools .tool-remove path {
  fill: #fff;
}
.x6-edge:hover .vertices,
.x6-edge:hover .arrowheads,
.x6-edge:hover .tools {
  opacity: 1;
}
.x6-highlight-opacity {
  opacity: 0.3;
}
.x6-cell-tool-editor {
  position: relative;
  display: inline-block;
  min-height: 1em;
  margin: 0;
  padding: 0;
  line-height: 1;
  white-space: normal;
  text-align: center;
  vertical-align: top;
  overflow-wrap: normal;
  outline: none;
  transform-origin: 0 0;
  -webkit-user-drag: none;
}
.x6-edge-tool-editor {
  border: 1px solid #275fc5;
  border-radius: 2px;
}
`;var mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.Base=void 0;const Em=$;class Cm extends Em.Disposable{get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}constructor(t){super();this.graph=t,this.init()}init(){}}mt.Base=Cm;var _m=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(Cr,"__esModule",{value:!0});Cr.CSSManager=void 0;const Oc=$,Sm=$t,Mm=_r,Am=mt;class oo extends Am.Base{init(){Sm.Config.autoInsertCSS&&Oc.CssLoader.ensure("core",Mm.content)}dispose(){Oc.CssLoader.clean("core")}}_m([oo.dispose()],oo.prototype,"dispose",null);Cr.CSSManager=oo;var ao={};(function(r){var t=E&&E.__rest||function(a,u){var h={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&u.indexOf(d)<0&&(h[d]=a[d]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,d=Object.getOwnPropertySymbols(a);c<d.length;c++)u.indexOf(d[c])<0&&Object.prototype.propertyIsEnumerable.call(a,d[c])&&(h[d[c]]=a[d[c]]);return h};Object.defineProperty(r,"__esModule",{value:!0}),r.Options=void 0;const e=$,n=$t,s=Zr;(function(a){function u(h){const{grid:d,panning:c,mousewheel:i,embedding:o}=h,l=t(h,["grid","panning","mousewheel","embedding"]),f=h.container;if(f!=null)l.width==null&&(l.width=f.clientWidth),l.height==null&&(l.height=f.clientHeight);else throw new Error("Ensure the container of the graph is specified and valid");const g=e.ObjectExt.merge({},a.defaults,l),p={size:10,visible:!1};return typeof d=="number"?g.grid={size:d,visible:!1}:typeof d=="boolean"?g.grid=Object.assign(Object.assign({},p),{visible:d}):g.grid=Object.assign(Object.assign({},p),d),["panning","mousewheel","embedding"].forEach(y=>{const b=h[y];typeof b=="boolean"?g[y].enabled=b:g[y]=Object.assign(Object.assign({},g[y]),b)}),g}a.get=u})(r.Options||(r.Options={})),function(a){a.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:n.Config.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:n.Config.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection({type:u,sourceView:h,targetView:d}){return(u==="target"?d:h)!=null},createEdge(){return new s.Edge}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:()=>!1}}(r.Options||(r.Options={}))})(ao);var Sr={},Nm=E&&E.__createBinding||(Object.create?function(r,t,e,n){n===void 0&&(n=e);var s=Object.getOwnPropertyDescriptor(t,e);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(r,n,s)}:function(r,t,e,n){n===void 0&&(n=e),r[n]=t[e]}),Tm=E&&E.__setModuleDefault||(Object.create?function(r,t){Object.defineProperty(r,"default",{enumerable:!0,value:t})}:function(r,t){r.default=t}),jm=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a},Dm=E&&E.__importStar||function(r){if(r&&r.__esModule)return r;var t={};if(r!=null)for(var e in r)e!=="default"&&Object.prototype.hasOwnProperty.call(r,e)&&Nm(t,r,e);return Tm(t,r),t},Lm=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Sr,"__esModule",{value:!0});Sr.GridManager=void 0;const lo=$,Mr=Dm(Dt),Ec=mt;class Cc extends Ec.Base{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(t){this.grid.visible!==t&&(this.grid.visible=t,this.update())}getGridSize(){return this.grid.size}setGridSize(t){this.grid.size=Math.max(t,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(t){this.clear(),this.instance=null,Object.assign(this.grid,t),this.patterns=this.resolveGrid(t),this.update()}update(t={}){const e=this.grid.size;if(e<=1||!this.grid.visible)return this.clear();const n=this.graph.matrix(),s=this.getInstance(),a=Array.isArray(t)?t:[t];this.patterns.forEach((d,c)=>{const i=`pattern_${c}`,o=n.a||1,l=n.d||1,{update:f,markup:g}=d,p=Lm(d,["update","markup"]),m=Object.assign(Object.assign(Object.assign({},p),a[c]),{sx:o,sy:l,ox:n.e||0,oy:n.f||0,width:e*o,height:e*l});s.has(i)||s.add(i,lo.Vector.create("pattern",{id:i,patternUnits:"userSpaceOnUse"},lo.Vector.createVectors(g)).node);const y=s.get(i);typeof f=="function"&&f(y.childNodes[0],m);let b=m.ox%m.width;b<0&&(b+=m.width);let v=m.oy%m.height;v<0&&(v+=m.height),lo.Dom.attr(y,{x:b,y:v,width:m.width,height:m.height})});const u=new XMLSerializer().serializeToString(s.root),h=`url(data:image/svg+xml;base64,${btoa(u)})`;this.elem.style.backgroundImage=h}getInstance(){return this.instance||(this.instance=new Mr.Grid),this.instance}resolveGrid(t){if(!t)return[];const e=t.type;if(e==null)return[Object.assign(Object.assign({},Mr.Grid.presets.dot),t.args)];const n=Mr.Grid.registry.get(e);if(n){let s=t.args||[];return Array.isArray(s)||(s=[s]),Array.isArray(n)?n.map((a,u)=>Object.assign(Object.assign({},a),s[u])):[Object.assign(Object.assign({},n),s[0])]}return Mr.Grid.registry.onNotFound(e)}dispose(){this.stopListening(),this.clear()}}jm([Ec.Base.dispose()],Cc.prototype,"dispose",null);Sr.GridManager=Cc;var Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});Nn.TransformManager=void 0;const yt=$,fe=I,$m=mt,_c=Bt;class Bm extends $m.Base{get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get stage(){return this.graph.view.stage}init(){this.resize()}getMatrix(){const t=this.viewport.getAttribute("transform");return t!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=t),yt.Dom.createSVGMatrix(this.viewportMatrix)}setMatrix(t){const e=yt.Dom.createSVGMatrix(t),n=yt.Dom.matrixToTransformString(e);this.viewport.setAttribute("transform",n),this.viewportMatrix=e,this.viewportTransformString=n}resize(t,e){let n=t===void 0?this.options.width:t,s=e===void 0?this.options.height:e;this.options.width=n,this.options.height=s,typeof n=="number"&&(n=Math.round(n)),typeof s=="number"&&(s=Math.round(s)),this.container.style.width=n==null?"":`${n}px`,this.container.style.height=s==null?"":`${s}px`;const a=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},a)),this}getComputedSize(){let t=this.options.width,e=this.options.height;return yt.NumberExt.isNumber(t)||(t=this.container.clientWidth),yt.NumberExt.isNumber(e)||(e=this.container.clientHeight),{width:t,height:e}}getScale(){return yt.Dom.matrixToScale(this.getMatrix())}scale(t,e=t,n=0,s=0){if(t=this.clampScale(t),e=this.clampScale(e),n||s){const u=this.getTranslation(),h=u.tx-n*(t-1),d=u.ty-s*(e-1);(h!==u.tx||d!==u.ty)&&this.translate(h,d)}const a=this.getMatrix();return a.a=t,a.d=e,this.setMatrix(a),this.graph.trigger("scale",{sx:t,sy:e,ox:n,oy:s}),this}clampScale(t){const e=this.graph.options.scaling;return yt.NumberExt.clamp(t,e.min||.01,e.max||16)}getZoom(){return this.getScale().sx}zoom(t,e){e=e||{};let n=t,s=t;const a=this.getScale(),u=this.getComputedSize();let h=u.width/2,d=u.height/2;if(e.absolute||(n+=a.sx,s+=a.sy),e.scaleGrid&&(n=Math.round(n/e.scaleGrid)*e.scaleGrid,s=Math.round(s/e.scaleGrid)*e.scaleGrid),e.maxScale&&(n=Math.min(e.maxScale,n),s=Math.min(e.maxScale,s)),e.minScale&&(n=Math.max(e.minScale,n),s=Math.max(e.minScale,s)),e.center&&(h=e.center.x,d=e.center.y),n=this.clampScale(n),s=this.clampScale(s),h||d){const c=this.getTranslation(),i=h-(h-c.tx)*(n/a.sx),o=d-(d-c.ty)*(s/a.sy);(i!==c.tx||o!==c.ty)&&this.translate(i,o)}return this.scale(n,s),this}getRotation(){return yt.Dom.matrixToRotation(this.getMatrix())}rotate(t,e,n){if(e==null||n==null){const a=_c.Util.getBBox(this.stage);e=a.width/2,n=a.height/2}const s=this.getMatrix().translate(e,n).rotate(t).translate(-e,-n);return this.setMatrix(s),this}getTranslation(){return yt.Dom.matrixToTranslation(this.getMatrix())}translate(t,e){const n=this.getMatrix();n.e=t||0,n.f=e||0,this.setMatrix(n);const s=this.getTranslation();return this.options.x=s.tx,this.options.y=s.ty,this.graph.trigger("translate",Object.assign({},s)),this}setOrigin(t,e){return this.translate(t||0,e||0)}fitToContent(t,e,n,s){if(typeof t=="object"){const v=t;t=v.gridWidth||1,e=v.gridHeight||1,n=v.padding||0,s=v}else t=t||1,e=e||1,n=n||0,s==null&&(s={});const a=yt.NumberExt.normalizeSides(n),u=s.border||0,h=s.contentArea?fe.Rectangle.create(s.contentArea):this.getContentArea(s);u>0&&h.inflate(u);const d=this.getScale(),c=this.getTranslation(),i=d.sx,o=d.sy;h.x*=i,h.y*=o,h.width*=i,h.height*=o;let l=Math.max(Math.ceil((h.width+h.x)/t),1)*t,f=Math.max(Math.ceil((h.height+h.y)/e),1)*e,g=0,p=0;(s.allowNewOrigin==="negative"&&h.x<0||s.allowNewOrigin==="positive"&&h.x>=0||s.allowNewOrigin==="any")&&(g=Math.ceil(-h.x/t)*t,g+=a.left,l+=g),(s.allowNewOrigin==="negative"&&h.y<0||s.allowNewOrigin==="positive"&&h.y>=0||s.allowNewOrigin==="any")&&(p=Math.ceil(-h.y/e)*e,p+=a.top,f+=p),l+=a.right,f+=a.bottom,l=Math.max(l,s.minWidth||0),f=Math.max(f,s.minHeight||0),l=Math.min(l,s.maxWidth||Number.MAX_SAFE_INTEGER),f=Math.min(f,s.maxHeight||Number.MAX_SAFE_INTEGER);const m=this.getComputedSize(),y=l!==m.width||f!==m.height;return(g!==c.tx||p!==c.ty)&&this.translate(g,p),y&&this.resize(l,f),new fe.Rectangle(-g/i,-p/o,l/i,f/o)}scaleContentToFit(t={}){this.scaleContentToFitImpl(t)}scaleContentToFitImpl(t={},e=!0){let n,s;if(t.contentArea){const y=t.contentArea;n=this.graph.localToGraph(y),s=fe.Point.create(y)}else n=this.getContentBBox(t),s=this.graph.graphToLocal(n);if(!n.width||!n.height)return;const a=yt.NumberExt.normalizeSides(t.padding),u=t.minScale||0,h=t.maxScale||Number.MAX_SAFE_INTEGER,d=t.minScaleX||u,c=t.maxScaleX||h,i=t.minScaleY||u,o=t.maxScaleY||h;let l;if(t.viewportArea)l=t.viewportArea;else{const y=this.getComputedSize(),b=this.getTranslation();l={x:b.tx,y:b.ty,width:y.width,height:y.height}}l=fe.Rectangle.create(l).moveAndExpand({x:a.left,y:a.top,width:-a.left-a.right,height:-a.top-a.bottom});const f=this.getScale();let g=l.width/n.width*f.sx,p=l.height/n.height*f.sy;t.preserveAspectRatio!==!1&&(g=p=Math.min(g,p));const m=t.scaleGrid;if(m&&(g=m*Math.floor(g/m),p=m*Math.floor(p/m)),g=yt.NumberExt.clamp(g,d,c),p=yt.NumberExt.clamp(p,i,o),this.scale(g,p),e){const y=this.options,b=l.x-s.x*g-y.x,v=l.y-s.y*p-y.y;this.translate(b,v)}}getContentArea(t={}){return t.useCellGeometry!==!1?this.model.getAllCellsBBox()||new fe.Rectangle:_c.Util.getBBox(this.stage)}getContentBBox(t={}){return this.graph.localToGraph(this.getContentArea(t))}getGraphArea(){const t=fe.Rectangle.fromSize(this.getComputedSize());return this.graph.graphToLocal(t)}zoomToRect(t,e={}){const n=fe.Rectangle.create(t),s=this.graph;e.contentArea=n,e.viewportArea==null&&(e.viewportArea={x:s.options.x,y:s.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(e,!1);const a=n.getCenter();return this.centerPoint(a.x,a.y),this}zoomToFit(t={}){return this.zoomToRect(this.getContentArea(t),t)}centerPoint(t,e){const n=this.getComputedSize(),s=this.getScale(),a=this.getTranslation(),u=n.width/2,h=n.height/2;t=typeof t=="number"?t:u,e=typeof e=="number"?e:h,t=u-t*s.sx,e=h-e*s.sy,(a.tx!==t||a.ty!==e)&&this.translate(t,e)}centerContent(t){const n=this.graph.getContentArea(t).getCenter();this.centerPoint(n.x,n.y)}centerCell(t){return this.positionCell(t,"center")}positionPoint(t,e,n){const s=this.getComputedSize();e=yt.NumberExt.normalizePercentage(e,Math.max(0,s.width)),e<0&&(e=s.width+e),n=yt.NumberExt.normalizePercentage(n,Math.max(0,s.height)),n<0&&(n=s.height+n);const a=this.getTranslation(),u=this.getScale(),h=e-t.x*u.sx,d=n-t.y*u.sy;(a.tx!==h||a.ty!==d)&&this.translate(h,d)}positionRect(t,e){const n=fe.Rectangle.create(t);switch(e){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}positionCell(t,e){const n=t.getBBox();return this.positionRect(n,e)}positionContent(t,e){const n=this.graph.getContentArea(e);return this.positionRect(n,t)}}Nn.TransformManager=Bm;var Tn={},Rm=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.BackgroundManager=void 0;const Sc=$,Im=I,Vm=Dt,Mc=mt;class Ac extends Mc.Base{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(t={}){let e=t.size||"auto auto",n=t.position||"center";const s=this.graph.transform.getScale(),a=this.graph.translate();if(typeof n=="object"){const u=a.tx+s.sx*(n.x||0),h=a.ty+s.sy*(n.y||0);n=`${u}px ${h}px`}typeof e=="object"&&(e=Im.Rectangle.fromSize(e).scale(s.sx,s.sy),e=`${e.width}px ${e.height}px`),this.elem.style.backgroundSize=e,this.elem.style.backgroundPosition=n}drawBackgroundImage(t,e={}){if(!(t instanceof HTMLImageElement)){this.elem.style.backgroundImage="";return}const n=this.optionsCache;if(n&&n.image!==e.image)return;let s;const a=e.opacity,u=e.size;let h=e.repeat||"no-repeat";const d=Vm.Background.registry.get(h);if(typeof d=="function"){const i=e.quality||1;t.width*=i,t.height*=i;const o=d(t,e);if(!(o instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");s=o.toDataURL("image/png"),e.repeat&&h!==e.repeat?h=e.repeat:h="repeat",typeof u=="object"?(u.width*=o.width/t.width,u.height*=o.height/t.height):u===void 0&&(e.size={width:o.width/i,height:o.height/i})}else s=t.src,u===void 0&&(e.size={width:t.width,height:t.height});n!=null&&typeof e.size=="object"&&e.image===n.image&&e.repeat===n.repeat&&e.quality===n.quality&&(n.size=Sc.ObjectExt.clone(e.size));const c=this.elem.style;c.backgroundImage=`url(${s})`,c.backgroundRepeat=h,c.opacity=a==null||a>=1?"":`${a}`,this.updateBackgroundImage(e)}updateBackgroundColor(t){this.elem.style.backgroundColor=t||""}updateBackgroundOptions(t){this.graph.options.background=t}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(t){const e=t||{};if(this.updateBackgroundOptions(t),this.updateBackgroundColor(e.color),e.image){this.optionsCache=Sc.ObjectExt.clone(e);const n=document.createElement("img");n.onload=()=>this.drawBackgroundImage(n,t),n.setAttribute("crossorigin","anonymous"),n.src=e.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}Rm([Mc.Base.dispose()],Ac.prototype,"dispose",null);Tn.BackgroundManager=Ac;var Ar={},Fm=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(Ar,"__esModule",{value:!0});Ar.PanningManager=void 0;const ft=$,Nc=mt;class Tc extends Nc.Base{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&this.widgetOptions.enabled===!0}init(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}startListening(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),ft.Dom.Event.on(this.graph.container,"mousedown",this.onRightMouseDown),ft.Dom.Event.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new ft.Dom.MouseWheelHandle(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}stopListening(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),ft.Dom.Event.off(this.graph.container,"mousedown",this.onRightMouseDown),ft.Dom.Event.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}allowPanning(t,e){return t.spaceKey=this.isSpaceKeyPressed,this.pannable&&ft.ModifierKey.isMatch(t,this.widgetOptions.modifiers,e)}startPanning(t){const e=this.view.normalizeEvent(t);this.clientX=e.clientX,this.clientY=e.clientY,this.panning=!0,this.updateClassName(),ft.Dom.Event.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),ft.Dom.Event.on(window,"mouseup.panning",this.stopPanning.bind(this))}pan(t){const e=this.view.normalizeEvent(t),n=e.clientX-this.clientX,s=e.clientY-this.clientY;this.clientX=e.clientX,this.clientY=e.clientY,this.graph.translateBy(n,s)}stopPanning(t){this.panning=!1,this.updateClassName(),ft.Dom.Event.off(document.body,".panning"),ft.Dom.Event.off(window,".panning")}updateClassName(){const t=this.view.container,e=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(ft.Dom.addClass(t,e),ft.Dom.removeClass(t,n)):(ft.Dom.removeClass(t,e),ft.Dom.addClass(t,n)):(ft.Dom.removeClass(t,e),ft.Dom.removeClass(t,n))}onMouseDown({e:t}){if(!this.allowBlankMouseDown(t))return;const e=this.graph.getPlugin("selection"),n=e&&e.allowRubberband(t,!0);(this.allowPanning(t,!0)||this.allowPanning(t)&&!n)&&this.startPanning(t)}onRightMouseDown(t){const e=this.widgetOptions.eventTypes;!((e==null?void 0:e.includes("rightMouseDown"))&&t.button===2)||this.allowPanning(t,!0)&&this.startPanning(t)}onMouseWheel(t,e,n){this.graph.translateBy(-e,-n)}onSpaceKeyDown(t){t.which===32&&(this.isSpaceKeyPressed=!0)}onSpaceKeyUp(t){t.which===32&&(this.isSpaceKeyPressed=!1)}allowBlankMouseDown(t){const e=this.widgetOptions.eventTypes;return(e==null?void 0:e.includes("leftMouseDown"))&&t.button===0||(e==null?void 0:e.includes("mouseWheelDown"))&&t.button===1}allowMouseWheel(t){var e;return this.pannable&&!t.ctrlKey&&((e=this.widgetOptions.eventTypes)===null||e===void 0?void 0:e.includes("mouseWheel"))}autoPanning(t,e){const n=10,s=this.graph.getGraphArea();let a=0,u=0;t<=s.left+n&&(a=-n),e<=s.top+n&&(u=-n),t>=s.right-n&&(a=n),e>=s.bottom-n&&(u=n),(a!==0||u!==0)&&this.graph.translateBy(-a,-u)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}Fm([Nc.Base.dispose()],Tc.prototype,"dispose",null);Ar.PanningManager=Tc;var Nr={},zm=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.MouseWheel=void 0;const jn=$,km=mt;class jc extends km.Base{constructor(){super(...arguments);this.cumulatedFactor=1}get widgetOptions(){return this.options.mousewheel}init(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new jn.Dom.MouseWheelHandle(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}get disabled(){return this.widgetOptions.enabled!==!0}enable(t){(this.disabled||t)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(t){const e=this.widgetOptions.guard;return(e==null||e(t))&&jn.ModifierKey.isMatch(t,this.widgetOptions.modifiers)}onMouseWheel(t){const e=this.widgetOptions.guard;if((e==null||e(t))&&jn.ModifierKey.isMatch(t,this.widgetOptions.modifiers)){const n=this.widgetOptions.factor||1.2;this.currentScale==null&&(this.startPos={x:t.clientX,y:t.clientY},this.currentScale=this.graph.transform.getScale().sx),t.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*n*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/n)*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const a=this.currentScale;let u=this.graph.transform.clampScale(a*this.cumulatedFactor);const h=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,d=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if(u=jn.NumberExt.clamp(u,h,d),u!==a)if(this.widgetOptions.zoomAtMousePosition){const i=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(u,{absolute:!0,center:i.clone()})}else this.graph.zoom(u,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}zm([jn.Disposable.dispose()],jc.prototype,"dispose",null);Nr.MouseWheel=jc;var Tr={},Hm=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.VirtualRenderManager=void 0;const Gm=$,Dc=mt;class Lc extends Dc.Base{init(){this.resetRenderArea=Gm.FunctionExt.throttle(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}startListening(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}stopListening(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}enableVirtualRender(){this.options.virtual=!0,this.resetRenderArea()}disableVirtualRender(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}resetRenderArea(){if(this.options.virtual){const t=this.graph.getGraphArea();this.graph.renderer.setRenderArea(t)}}dispose(){this.stopListening()}}Hm([Dc.Base.dispose()],Lc.prototype,"dispose",null);Tr.VirtualRenderManager=Lc;var $c={},jr={},Bc={},Rc={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.JOB_PRIORITY=r.JobQueue=void 0;class t{constructor(){this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}queueJob(s){if(s.priority&e.PRIOR)s.cb();else{const a=this.findInsertionIndex(s);a>=0&&this.queue.splice(a,0,s)}}queueFlush(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.scheduleJob())}queueFlushSync(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.flushJobsSync())}clearJobs(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}flushJobs(){this.isFlushPending=!1,this.isFlushing=!0;const s=this.getCurrentTime();let a;for(;(a=this.queue.shift())&&(a.cb(),!(this.getCurrentTime()-s>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}flushJobsSync(){this.isFlushPending=!1,this.isFlushing=!0;let s;for(;s=this.queue.shift();)try{s.cb()}catch(a){console.log(a)}this.isFlushing=!1}findInsertionIndex(s){let a=0,u=this.queue.length,h=u-1;const d=s.priority;for(;a<=h;){const c=(h-a>>1)+a;d<=this.queue[c].priority?a=c+1:(u=c,h=c-1)}return u}scheduleJob(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}cancelScheduleJob(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}getCurrentTime(){return typeof performance=="object"&&typeof performance.now=="function"?performance.now():Date.now()-this.initialTime}}r.JobQueue=t;var e;(function(n){n[n.Update=2]="Update",n[n.RenderEdge=4]="RenderEdge",n[n.RenderNode=8]="RenderNode",n[n.PRIOR=1048576]="PRIOR"})(e=r.JOB_PRIORITY||(r.JOB_PRIORITY={}))})(Rc);(function(r){var t=E&&E.__decorate||function(u,h,d,c){var i=arguments.length,o=i<3?h:c===null?c=Object.getOwnPropertyDescriptor(h,d):c,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(u,h,d,c);else for(var f=u.length-1;f>=0;f--)(l=u[f])&&(o=(i<3?l(o):i>3?l(h,d,o):l(h,d))||o);return i>3&&o&&Object.defineProperty(h,d,o),o};Object.defineProperty(r,"__esModule",{value:!0}),r.Scheduler=void 0;const e=$,n=_e,s=Rc;class a extends e.Disposable{get model(){return this.graph.model}get container(){return this.graph.view.stage}constructor(h){super();this.views={},this.willRemoveViews={},this.queue=new s.JobQueue,this.graph=h,this.init()}init(){this.startListening(),this.renderViews(this.model.getCells())}startListening(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}onModelReseted({options:h}){this.queue.clearJobs(),this.removeZPivots(),this.resetViews();const d=this.model.getCells();this.renderViews(d,Object.assign(Object.assign({},h),{queue:d.map(c=>c.id)}))}onCellAdded({cell:h,options:d}){this.renderViews([h],d)}onCellRemoved({cell:h}){this.removeViews([h])}onCellZIndexChanged({cell:h,options:d}){const c=this.views[h.id];c&&this.requestViewUpdate(c.view,a.FLAG_INSERT,d,s.JOB_PRIORITY.Update,!0)}onCellVisibleChanged({cell:h,current:d}){this.toggleVisible(h,!!d)}requestViewUpdate(h,d,c={},i=s.JOB_PRIORITY.Update,o=!0){const l=h.cell.id,f=this.views[l];if(!f)return;f.flag=d,f.options=c,(h.hasAction(d,["translate","resize","rotate"])||c.async===!1)&&(i=s.JOB_PRIORITY.PRIOR,o=!1),this.queue.queueJob({id:l,priority:i,cb:()=>{this.renderViewInArea(h,d,c);const m=c.queue;if(m){const y=m.indexOf(h.cell.id);y>=0&&m.splice(y,1),m.length===0&&this.graph.trigger("render:done")}}}),this.getEffectedEdges(h).forEach(m=>{this.requestViewUpdate(m.view,m.flag,c,i,!1)}),o&&this.flush()}setRenderArea(h){this.renderArea=h,this.flushWaitingViews()}isViewMounted(h){if(h==null)return!1;const d=this.views[h.cell.id];return d?d.state===a.ViewState.MOUNTED:!1}renderViews(h,d={}){h.sort((c,i)=>c.isNode()&&i.isEdge()?-1:0),h.forEach(c=>{const i=c.id,o=this.views;let l=0,f=o[i];if(f)l=a.FLAG_INSERT;else{const g=this.createCellView(c);g&&(g.graph=this.graph,l=a.FLAG_INSERT|g.getBootstrapFlag(),f={view:g,flag:l,options:d,state:a.ViewState.CREATED},this.views[i]=f)}f&&this.requestViewUpdate(f.view,l,d,this.getRenderPriority(f.view),!1)}),this.flush()}renderViewInArea(h,d,c={}){const i=h.cell,o=i.id,l=this.views[o];if(!l)return;let f=0;this.isUpdatable(h)?(f=this.updateView(h,d,c),l.flag=f):l.state===a.ViewState.MOUNTED?(f=this.updateView(h,d,c),l.flag=f):l.state=a.ViewState.WAITING,f&&i.isEdge()&&(f&h.getFlag(["source","target"]))==0&&this.queue.queueJob({id:o,priority:s.JOB_PRIORITY.RenderEdge,cb:()=>{this.updateView(h,d,c)}})}removeViews(h){h.forEach(d=>{const c=d.id,i=this.views[c];i&&(this.willRemoveViews[c]=i,delete this.views[c],this.queue.queueJob({id:c,priority:this.getRenderPriority(i.view),cb:()=>{this.removeView(i.view)}}))}),this.flush()}flush(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}flushWaitingViews(){Object.values(this.views).forEach(h=>{if(h&&h.state===a.ViewState.WAITING){const{view:d,flag:c,options:i}=h;this.requestViewUpdate(d,c,i,this.getRenderPriority(d),!1)}}),this.flush()}updateView(h,d,c={}){if(h==null)return 0;if(n.CellView.isCellView(h)){if(d&a.FLAG_REMOVE)return this.removeView(h.cell),0;d&a.FLAG_INSERT&&(this.insertView(h),d^=a.FLAG_INSERT)}return d?h.confirmUpdate(d,c):0}insertView(h){const d=this.views[h.cell.id];if(d){const c=h.cell.getZIndex(),i=this.addZPivot(c);this.container.insertBefore(h.container,i),h.cell.isVisible()||this.toggleVisible(h.cell,!1),d.state=a.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:h})}}resetViews(){this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach(h=>{h&&this.removeView(h.view)}),this.views={},this.willRemoveViews={}}removeView(h){const d=h.cell,c=this.willRemoveViews[d.id];c&&h&&(c.view.remove(),delete this.willRemoveViews[d.id],this.graph.trigger("view:unmounted",{view:h}))}toggleVisible(h,d){const c=this.model.getConnectedEdges(h);for(let o=0,l=c.length;o<l;o+=1){const f=c[o];if(d){const g=f.getSourceCell(),p=f.getTargetCell();if(g&&!g.isVisible()||p&&!p.isVisible())continue;this.toggleVisible(f,!0)}else this.toggleVisible(f,!1)}const i=this.views[h.id];i&&e.Dom.css(i.view.container,{display:d?"unset":"none"})}addZPivot(h=0){this.zPivots==null&&(this.zPivots={});const d=this.zPivots;let c=d[h];if(c)return c;c=d[h]=document.createComment(`z-index:${h+1}`);let i=-1/0;for(const l in d){const f=+l;!(f<h&&f>i&&(i=f,i===h-1))}const o=this.container;if(i!==-1/0){const l=d[i];o.insertBefore(c,l.nextSibling)}else o.insertBefore(c,o.firstChild);return c}removeZPivots(){this.zPivots&&Object.values(this.zPivots).forEach(h=>{h&&h.parentNode&&h.parentNode.removeChild(h)}),this.zPivots={}}createCellView(h){const d={graph:this.graph},c=this.graph.options.createCellView;if(c){const o=e.FunctionExt.call(c,this.graph,h);if(o)return new o(h,d);if(o===null)return null}const i=h.view;if(i!=null&&typeof i=="string"){const o=n.CellView.registry.get(i);return o?new o(h,d):n.CellView.registry.onNotFound(i)}return h.isNode()?new n.NodeView(h,d):h.isEdge()?new n.EdgeView(h,d):null}getEffectedEdges(h){const d=[],c=h.cell,i=this.model.getConnectedEdges(c);for(let o=0,l=i.length;o<l;o+=1){const f=i[o],g=this.views[f.id];if(!g)continue;const p=g.view;if(!this.isViewMounted(p))continue;const m=["update"];f.getTargetCell()===c&&m.push("target"),f.getSourceCell()===c&&m.push("source"),d.push({id:f.id,view:p,flag:p.getFlag(m)})}return d}isUpdatable(h){if(h.isNodeView())return this.renderArea?this.renderArea.isIntersectWithRect(h.cell.getBBox()):!0;if(h.isEdgeView()){const d=h.cell,c=d.getSourceCell(),i=d.getTargetCell();if(this.renderArea&&c&&i)return this.renderArea.isIntersectWithRect(c.getBBox())||this.renderArea.isIntersectWithRect(i.getBBox())}return!0}getRenderPriority(h){return h.cell.isNode()?s.JOB_PRIORITY.RenderNode:s.JOB_PRIORITY.RenderEdge}dispose(){this.stopListening(),Object.keys(this.views).forEach(h=>{this.views[h].view.dispose()}),this.views={}}}t([e.Disposable.dispose()],a.prototype,"dispose",null),r.Scheduler=a,function(u){u.FLAG_INSERT=1<<30,u.FLAG_REMOVE=1<<29,u.FLAG_RENDER=(1<<26)-1}(a=r.Scheduler||(r.Scheduler={})),function(u){(function(h){h[h.CREATED=0]="CREATED",h[h.MOUNTED=1]="MOUNTED",h[h.WAITING=2]="WAITING"})(u.ViewState||(u.ViewState={}))}(a=r.Scheduler||(r.Scheduler={}))})(Bc);var qm=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(jr,"__esModule",{value:!0});jr.Renderer=void 0;const Wm=I,Ic=mt,Um=Ve,Jm=Bc,Vc=Bt;class Fc extends Ic.Base{constructor(){super(...arguments);this.schedule=new Jm.Scheduler(this.graph)}requestViewUpdate(t,e,n={}){this.schedule.requestViewUpdate(t,e,n)}isViewMounted(t){return this.schedule.isViewMounted(t)}setRenderArea(t){this.schedule.setRenderArea(t)}findViewByElem(t){if(t==null)return null;const e=this.options.container,n=typeof t=="string"?e.querySelector(t):t instanceof Element?t:t[0];if(n){const s=this.graph.view.findAttr("data-cell-id",n);if(s){const a=this.schedule.views;if(a[s])return a[s].view}}return null}findViewByCell(t){if(t==null)return null;const e=Um.Cell.isCell(t)?t.id:t,n=this.schedule.views;return n[e]?n[e].view:null}findViewsFromPoint(t){const e={x:t.x,y:t.y};return this.model.getCells().map(n=>this.findViewByCell(n)).filter(n=>n!=null?Vc.Util.getBBox(n.container,{target:this.view.stage}).containsPoint(e):!1)}findEdgeViewsFromPoint(t,e=5){return this.model.getEdges().map(n=>this.findViewByCell(n)).filter(n=>{if(n!=null){const s=n.getClosestPoint(t);if(s)return s.distance(t)<=e}return!1})}findViewsInArea(t,e={}){const n=Wm.Rectangle.create(t);return this.model.getCells().map(s=>this.findViewByCell(s)).filter(s=>{if(s){if(e.nodeOnly&&!s.isNodeView())return!1;const a=Vc.Util.getBBox(s.container,{target:this.view.stage});return a.width===0?a.inflate(1,0):a.height===0&&a.inflate(0,1),e.strict?n.containsRect(a):n.isIntersectWithRect(a)}return!1})}dispose(){this.schedule.dispose()}}qm([Ic.Base.dispose()],Fc.prototype,"dispose",null);jr.Renderer=Fc;(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(jr,r)})($c);var Dr={},zc=E&&E.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(e[n[s]]=r[n[s]]);return e};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.DefsManager=void 0;const Jt=$,kc=Dt,Xm=_e,Ym=mt;class Km extends Ym.Base{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(t){return this.svg.getElementById(t)!=null}filter(t){let e=t.id;const n=t.name;if(e||(e=`filter-${n}-${this.cid}-${Jt.StringExt.hashcode(JSON.stringify(t))}`),!this.isDefined(e)){const s=kc.Filter.registry.get(n);if(s==null)return kc.Filter.registry.onNotFound(n);const a=s(t.args||{}),u=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},t.attrs),{id:e});Jt.Vector.create(Xm.Markup.sanitize(a),u).appendTo(this.defs)}return e}gradient(t){let e=t.id;const n=t.type;if(e||(e=`gradient-${n}-${this.cid}-${Jt.StringExt.hashcode(JSON.stringify(t))}`),!this.isDefined(e)){const a=t.stops.map(d=>{const c=d.opacity!=null&&Number.isFinite(d.opacity)?d.opacity:1;return`<stop offset="${d.offset}" stop-color="${d.color}" stop-opacity="${c}"/>`}),u=`<${n}>${a.join("")}</${n}>`,h=Object.assign({id:e},t.attrs);Jt.Vector.create(u,h).appendTo(this.defs)}return e}marker(t){const{id:e,refX:n,refY:s,markerUnits:a,markerOrient:u,tagName:h,children:d}=t,c=zc(t,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let i=e;if(i||(i=`marker-${this.cid}-${Jt.StringExt.hashcode(JSON.stringify(t))}`),!this.isDefined(i)){h!=="path"&&delete c.d;const o=Jt.Vector.create("marker",{refX:n,refY:s,id:i,overflow:"visible",orient:u!=null?u:"auto",markerUnits:a||"userSpaceOnUse"},d?d.map(l=>{var{tagName:f}=l,g=zc(l,["tagName"]);return Jt.Vector.create(`${f}`||"path",Jt.Dom.kebablizeAttrs(Object.assign(Object.assign({},c),g)))}):[Jt.Vector.create(h||"path",Jt.Dom.kebablizeAttrs(c))]);this.defs.appendChild(o.node)}return i}remove(t){const e=this.svg.getElementById(t);e&&e.parentNode&&e.parentNode.removeChild(e)}}Dr.DefsManager=Km;var Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.CoordManager=void 0;const Zm=$,Ct=I,Qm=mt,Xt=Bt;class ty extends Qm.Base{getClientMatrix(){return Zm.Dom.createSVGMatrix(this.view.stage.getScreenCTM())}getClientOffset(){const t=this.view.svg.getBoundingClientRect();return new Ct.Point(t.left,t.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(t,e){return(typeof t=="number"?this.clientToLocalPoint(t,e):this.clientToLocalPoint(t.x,t.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(t,e){const n=Ct.Point.create(t,e);return Xt.Util.transformPoint(n,this.graph.matrix())}localToClientPoint(t,e){const n=Ct.Point.create(t,e);return Xt.Util.transformPoint(n,this.getClientMatrix())}localToPagePoint(t,e){return(typeof t=="number"?this.localToGraphPoint(t,e):this.localToGraphPoint(t)).translate(this.getPageOffset())}localToGraphRect(t,e,n,s){const a=Ct.Rectangle.create(t,e,n,s);return Xt.Util.transformRectangle(a,this.graph.matrix())}localToClientRect(t,e,n,s){const a=Ct.Rectangle.create(t,e,n,s);return Xt.Util.transformRectangle(a,this.getClientMatrix())}localToPageRect(t,e,n,s){return(typeof t=="number"?this.localToGraphRect(t,e,n,s):this.localToGraphRect(t)).translate(this.getPageOffset())}graphToLocalPoint(t,e){const n=Ct.Point.create(t,e);return Xt.Util.transformPoint(n,this.graph.matrix().inverse())}clientToLocalPoint(t,e){const n=Ct.Point.create(t,e);return Xt.Util.transformPoint(n,this.getClientMatrix().inverse())}clientToGraphPoint(t,e){const n=Ct.Point.create(t,e);return Xt.Util.transformPoint(n,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(t,e){const s=Ct.Point.create(t,e).diff(this.getPageOffset());return this.graphToLocalPoint(s)}graphToLocalRect(t,e,n,s){const a=Ct.Rectangle.create(t,e,n,s);return Xt.Util.transformRectangle(a,this.graph.matrix().inverse())}clientToLocalRect(t,e,n,s){const a=Ct.Rectangle.create(t,e,n,s);return Xt.Util.transformRectangle(a,this.getClientMatrix().inverse())}clientToGraphRect(t,e,n,s){const a=Ct.Rectangle.create(t,e,n,s);return Xt.Util.transformRectangle(a,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(t,e,n,s){const a=Ct.Rectangle.create(t,e,n,s),u=this.getPageOffset();return a.x-=u.x,a.y-=u.y,this.graphToLocalRect(a)}}Lr.CoordManager=ty;var $r={},ey=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty($r,"__esModule",{value:!0});$r.HighlightManager=void 0;const ny=$,co=Dt,iy=mt;class uo extends iy.Base{constructor(){super(...arguments);this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:t,magnet:e,options:n={}}){const s=this.resolveHighlighter(n);if(!s)return;const a=this.getHighlighterId(e,s);if(!this.highlights[a]){const u=s.highlighter;u.highlight(t,e,Object.assign({},s.args)),this.highlights[a]={cellView:t,magnet:e,highlighter:u,args:s.args}}}onCellUnhighlight({magnet:t,options:e={}}){const n=this.resolveHighlighter(e);if(!n)return;const s=this.getHighlighterId(t,n);this.unhighlight(s)}resolveHighlighter(t){const e=this.options;let n=t.highlighter;if(n==null){const h=t.type;n=h&&e.highlighting[h]||e.highlighting.default}if(n==null)return null;const s=typeof n=="string"?{name:n}:n,a=s.name,u=co.Highlighter.registry.get(a);return u==null?co.Highlighter.registry.onNotFound(a):(co.Highlighter.check(a,u),{name:a,highlighter:u,args:s.args||{}})}getHighlighterId(t,e){return ny.Dom.ensureId(t),e.name+t.id+JSON.stringify(e.args)}unhighlight(t){const e=this.highlights[t];e&&(e.highlighter.unhighlight(e.cellView,e.magnet,e.args),delete this.highlights[t])}dispose(){Object.keys(this.highlights).forEach(t=>this.unhighlight(t)),this.stopListening()}}ey([uo.dispose()],uo.prototype,"dispose",null);$r.HighlightManager=uo;var Br={},ry=E&&E.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};Object.defineProperty(Br,"__esModule",{value:!0});Br.SizeManager=void 0;const Hc=$,Gc=mt;class qc extends Gc.Base{getScroller(){const t=this.graph.getPlugin("scroller");return t&&t.options.enabled?t:null}getContainer(){const t=this.getScroller();return t?t.container.parentElement:this.graph.container.parentElement}getSensorTarget(){const t=this.options.autoResize;if(t)return typeof t=="boolean"?this.getContainer():t}init(){if(this.options.autoResize){const e=this.getSensorTarget();e&&Hc.SizeSensor.bind(e,()=>{const n=e.offsetWidth,s=e.offsetHeight;this.resize(n,s)})}}resize(t,e){const n=this.getScroller();n?n.resize(t,e):this.graph.transform.resize(t,e)}dispose(){Hc.SizeSensor.clear(this.graph.container)}}ry([Gc.Base.dispose()],qc.prototype,"dispose",null);Br.SizeManager=qc;(function(r){var t=E&&E.__createBinding||(Object.create?function(S,w,O,M){M===void 0&&(M=O);var T=Object.getOwnPropertyDescriptor(w,O);(!T||("get"in T?!w.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return w[O]}}),Object.defineProperty(S,M,T)}:function(S,w,O,M){M===void 0&&(M=O),S[M]=w[O]}),e=E&&E.__setModuleDefault||(Object.create?function(S,w){Object.defineProperty(S,"default",{enumerable:!0,value:w})}:function(S,w){S.default=w}),n=E&&E.__decorate||function(S,w,O,M){var T=arguments.length,j=T<3?w:M===null?M=Object.getOwnPropertyDescriptor(w,O):M,N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(S,w,O,M);else for(var D=S.length-1;D>=0;D--)(N=S[D])&&(j=(T<3?N(j):T>3?N(w,O,j):N(w,O))||j);return T>3&&j&&Object.defineProperty(w,O,j),j},s=E&&E.__importStar||function(S){if(S&&S.__esModule)return S;var w={};if(S!=null)for(var O in S)O!=="default"&&Object.prototype.hasOwnProperty.call(S,O)&&t(w,S,O);return e(w,S),w};Object.defineProperty(r,"__esModule",{value:!0}),r.Graph=void 0;const a=$,u=I,h=Ve,d=_e,c=s(Dt),i=so,o=Cr,l=ao,f=Sr,g=Nn,p=Tn,m=Ar,y=Nr,b=Tr,v=$c,x=Dr,P=Lr,C=$r,_=Br;class A extends a.Basecoat{get container(){return this.options.container}get[Symbol.toStringTag](){return A.toStringTag}constructor(w){super();this.installedPlugins=new Set,this.options=l.Options.get(w),this.css=new o.CSSManager(this),this.view=new i.GraphView(this),this.defs=new x.DefsManager(this),this.coord=new P.CoordManager(this),this.transform=new g.TransformManager(this),this.highlight=new C.HighlightManager(this),this.grid=new f.GridManager(this),this.background=new p.BackgroundManager(this),this.options.model?this.model=this.options.model:(this.model=new h.Model,this.model.graph=this),this.renderer=new v.Renderer(this),this.panning=new m.PanningManager(this),this.mousewheel=new y.MouseWheel(this),this.virtualRender=new b.VirtualRenderManager(this),this.size=new _.SizeManager(this)}isNode(w){return w.isNode()}isEdge(w){return w.isEdge()}resetCells(w,O={}){return this.model.resetCells(w,O),this}clearCells(w={}){return this.model.clear(w),this}toJSON(w={}){return this.model.toJSON(w)}parseJSON(w){return this.model.parseJSON(w)}fromJSON(w,O={}){return this.model.fromJSON(w,O),this}getCellById(w){return this.model.getCell(w)}addNode(w,O={}){return this.model.addNode(w,O)}addNodes(w,O={}){return this.addCell(w.map(M=>h.Node.isNode(M)?M:this.createNode(M)),O)}createNode(w){return this.model.createNode(w)}removeNode(w,O={}){return this.model.removeCell(w,O)}addEdge(w,O={}){return this.model.addEdge(w,O)}addEdges(w,O={}){return this.addCell(w.map(M=>h.Edge.isEdge(M)?M:this.createEdge(M)),O)}removeEdge(w,O={}){return this.model.removeCell(w,O)}createEdge(w){return this.model.createEdge(w)}addCell(w,O={}){return this.model.addCell(w,O),this}removeCell(w,O={}){return this.model.removeCell(w,O)}removeCells(w,O={}){return this.model.removeCells(w,O)}removeConnectedEdges(w,O={}){return this.model.removeConnectedEdges(w,O)}disconnectConnectedEdges(w,O={}){return this.model.disconnectConnectedEdges(w,O),this}hasCell(w){return this.model.has(w)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(w){return this.model.getOutgoingEdges(w)}getIncomingEdges(w){return this.model.getIncomingEdges(w)}getConnectedEdges(w,O={}){return this.model.getConnectedEdges(w,O)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(w){return this.model.isRoot(w)}isLeafNode(w){return this.model.isLeaf(w)}getNeighbors(w,O={}){return this.model.getNeighbors(w,O)}isNeighbor(w,O,M={}){return this.model.isNeighbor(w,O,M)}getSuccessors(w,O={}){return this.model.getSuccessors(w,O)}isSuccessor(w,O,M={}){return this.model.isSuccessor(w,O,M)}getPredecessors(w,O={}){return this.model.getPredecessors(w,O)}isPredecessor(w,O,M={}){return this.model.isPredecessor(w,O,M)}getCommonAncestor(...w){return this.model.getCommonAncestor(...w)}getSubGraph(w,O={}){return this.model.getSubGraph(w,O)}cloneSubGraph(w,O={}){return this.model.cloneSubGraph(w,O)}cloneCells(w){return this.model.cloneCells(w)}getNodesFromPoint(w,O){return this.model.getNodesFromPoint(w,O)}getNodesInArea(w,O,M,T,j){return this.model.getNodesInArea(w,O,M,T,j)}getNodesUnderNode(w,O={}){return this.model.getNodesUnderNode(w,O)}searchCell(w,O,M={}){return this.model.search(w,O,M),this}getShortestPath(w,O,M={}){return this.model.getShortestPath(w,O,M)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(w,O={}){return this.model.getCellsBBox(w,O)}startBatch(w,O={}){this.model.startBatch(w,O)}stopBatch(w,O={}){this.model.stopBatch(w,O)}batchUpdate(w,O,M){const T=typeof w=="string"?w:"update",j=typeof w=="string"?O:w,N=typeof O=="function"?M:O;this.startBatch(T,N);const D=j();return this.stopBatch(T,N),D}updateCellId(w,O){return this.model.updateCellId(w,O)}findView(w){return h.Cell.isCell(w)?this.findViewByCell(w):this.findViewByElem(w)}findViews(w){return u.Rectangle.isRectangleLike(w)?this.findViewsInArea(w):u.Point.isPointLike(w)?this.findViewsFromPoint(w):[]}findViewByCell(w){return this.renderer.findViewByCell(w)}findViewByElem(w){return this.renderer.findViewByElem(w)}findViewsFromPoint(w,O){const M=typeof w=="number"?{x:w,y:O}:w;return this.renderer.findViewsFromPoint(M)}findViewsInArea(w,O,M,T,j){const N=typeof w=="number"?{x:w,y:O,width:M,height:T}:w,D=typeof w=="number"?j:O;return this.renderer.findViewsInArea(N,D)}matrix(w){return typeof w=="undefined"?this.transform.getMatrix():(this.transform.setMatrix(w),this)}resize(w,O){const M=this.getPlugin("scroller");return M?M.resize(w,O):this.transform.resize(w,O),this}scale(w,O=w,M=0,T=0){return typeof w=="undefined"?this.transform.getScale():(this.transform.scale(w,O,M,T),this)}zoom(w,O){const M=this.getPlugin("scroller");if(M){if(typeof w=="undefined")return M.zoom();M.zoom(w,O)}else{if(typeof w=="undefined")return this.transform.getZoom();this.transform.zoom(w,O)}return this}zoomTo(w,O={}){const M=this.getPlugin("scroller");return M?M.zoom(w,Object.assign(Object.assign({},O),{absolute:!0})):this.transform.zoom(w,Object.assign(Object.assign({},O),{absolute:!0})),this}zoomToRect(w,O={}){const M=this.getPlugin("scroller");return M?M.zoomToRect(w,O):this.transform.zoomToRect(w,O),this}zoomToFit(w={}){const O=this.getPlugin("scroller");return O?O.zoomToFit(w):this.transform.zoomToFit(w),this}rotate(w,O,M){return typeof w=="undefined"?this.transform.getRotation():(this.transform.rotate(w,O,M),this)}translate(w,O){return typeof w=="undefined"?this.transform.getTranslation():(this.transform.translate(w,O),this)}translateBy(w,O){const M=this.translate(),T=M.tx+w,j=M.ty+O;return this.translate(T,j)}getGraphArea(){return this.transform.getGraphArea()}getContentArea(w={}){return this.transform.getContentArea(w)}getContentBBox(w={}){return this.transform.getContentBBox(w)}fitToContent(w,O,M,T){return this.transform.fitToContent(w,O,M,T)}scaleContentToFit(w={}){return this.transform.scaleContentToFit(w),this}center(w){return this.centerPoint(w)}centerPoint(w,O,M){const T=this.getPlugin("scroller");return T?T.centerPoint(w,O,M):this.transform.centerPoint(w,O),this}centerContent(w){const O=this.getPlugin("scroller");return O?O.centerContent(w):this.transform.centerContent(w),this}centerCell(w,O){const M=this.getPlugin("scroller");return M?M.centerCell(w,O):this.transform.centerCell(w),this}positionPoint(w,O,M,T={}){const j=this.getPlugin("scroller");return j?j.positionPoint(w,O,M,T):this.transform.positionPoint(w,O,M),this}positionRect(w,O,M){const T=this.getPlugin("scroller");return T?T.positionRect(w,O,M):this.transform.positionRect(w,O),this}positionCell(w,O,M){const T=this.getPlugin("scroller");return T?T.positionCell(w,O,M):this.transform.positionCell(w,O),this}positionContent(w,O){const M=this.getPlugin("scroller");return M?M.positionContent(w,O):this.transform.positionContent(w,O),this}snapToGrid(w,O){return this.coord.snapToGrid(w,O)}pageToLocal(w,O,M,T){return u.Rectangle.isRectangleLike(w)?this.coord.pageToLocalRect(w):typeof w=="number"&&typeof O=="number"&&typeof M=="number"&&typeof T=="number"?this.coord.pageToLocalRect(w,O,M,T):this.coord.pageToLocalPoint(w,O)}localToPage(w,O,M,T){return u.Rectangle.isRectangleLike(w)?this.coord.localToPageRect(w):typeof w=="number"&&typeof O=="number"&&typeof M=="number"&&typeof T=="number"?this.coord.localToPageRect(w,O,M,T):this.coord.localToPagePoint(w,O)}clientToLocal(w,O,M,T){return u.Rectangle.isRectangleLike(w)?this.coord.clientToLocalRect(w):typeof w=="number"&&typeof O=="number"&&typeof M=="number"&&typeof T=="number"?this.coord.clientToLocalRect(w,O,M,T):this.coord.clientToLocalPoint(w,O)}localToClient(w,O,M,T){return u.Rectangle.isRectangleLike(w)?this.coord.localToClientRect(w):typeof w=="number"&&typeof O=="number"&&typeof M=="number"&&typeof T=="number"?this.coord.localToClientRect(w,O,M,T):this.coord.localToClientPoint(w,O)}localToGraph(w,O,M,T){return u.Rectangle.isRectangleLike(w)?this.coord.localToGraphRect(w):typeof w=="number"&&typeof O=="number"&&typeof M=="number"&&typeof T=="number"?this.coord.localToGraphRect(w,O,M,T):this.coord.localToGraphPoint(w,O)}graphToLocal(w,O,M,T){return u.Rectangle.isRectangleLike(w)?this.coord.graphToLocalRect(w):typeof w=="number"&&typeof O=="number"&&typeof M=="number"&&typeof T=="number"?this.coord.graphToLocalRect(w,O,M,T):this.coord.graphToLocalPoint(w,O)}clientToGraph(w,O,M,T){return u.Rectangle.isRectangleLike(w)?this.coord.clientToGraphRect(w):typeof w=="number"&&typeof O=="number"&&typeof M=="number"&&typeof T=="number"?this.coord.clientToGraphRect(w,O,M,T):this.coord.clientToGraphPoint(w,O)}defineFilter(w){return this.defs.filter(w)}defineGradient(w){return this.defs.gradient(w)}defineMarker(w){return this.defs.marker(w)}getGridSize(){return this.grid.getGridSize()}setGridSize(w){return this.grid.setGridSize(w),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(w){return this.grid.draw(w),this}updateBackground(){return this.background.update(),this}drawBackground(w,O){const M=this.getPlugin("scroller");return M!=null&&(this.options.background==null||!O)?M.drawBackground(w,O):this.background.draw(w),this}clearBackground(w){const O=this.getPlugin("scroller");return O!=null&&(this.options.background==null||!w)?O.clearBackground(w):this.background.clear(),this}enableVirtualRender(){return this.virtualRender.enableVirtualRender(),this}disableVirtualRender(){return this.virtualRender.disableVirtualRender(),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(w){return w==null?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():w?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){const w=this.getPlugin("scroller");return w?w.isPannable():this.panning.pannable}enablePanning(){const w=this.getPlugin("scroller");return w?w.enablePanning():this.panning.enablePanning(),this}disablePanning(){const w=this.getPlugin("scroller");return w?w.disablePanning():this.panning.disablePanning(),this}togglePanning(w){return w==null?this.isPannable()?this.disablePanning():this.enablePanning():w!==this.isPannable()&&(w?this.enablePanning():this.disablePanning()),this}use(w,...O){return this.installedPlugins.has(w)||(this.installedPlugins.add(w),w.init(this,...O)),this}getPlugin(w){return Array.from(this.installedPlugins).find(O=>O.name===w)}getPlugins(w){return Array.from(this.installedPlugins).filter(O=>w.includes(O.name))}enablePlugins(w){let O=w;Array.isArray(O)||(O=[O]);const M=this.getPlugins(O);return M==null||M.forEach(T=>{var j;(j=T==null?void 0:T.enable)===null||j===void 0||j.call(T)}),this}disablePlugins(w){let O=w;Array.isArray(O)||(O=[O]);const M=this.getPlugins(O);return M==null||M.forEach(T=>{var j;(j=T==null?void 0:T.disable)===null||j===void 0||j.call(T)}),this}isPluginEnabled(w){var O;const M=this.getPlugin(w);return(O=M==null?void 0:M.isEnabled)===null||O===void 0?void 0:O.call(M)}disposePlugins(w){let O=w;Array.isArray(O)||(O=[O]);const M=this.getPlugins(O);return M==null||M.forEach(T=>{T.dispose(),this.installedPlugins.delete(T)}),this}dispose(w=!0){w&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach(O=>{O.dispose()})}}n([a.Basecoat.dispose()],A.prototype,"dispose",null),r.Graph=A,function(S){S.View=i.GraphView,S.Renderer=v.Renderer,S.MouseWheel=y.MouseWheel,S.DefsManager=x.DefsManager,S.GridManager=f.GridManager,S.CoordManager=P.CoordManager,S.TransformManager=g.TransformManager,S.HighlightManager=C.HighlightManager,S.BackgroundManager=p.BackgroundManager,S.PanningManager=m.PanningManager}(A=r.Graph||(r.Graph={})),function(S){S.toStringTag=`X6.${S.name}`;function w(O){if(O==null)return!1;if(O instanceof S)return!0;const M=O[Symbol.toStringTag];return M==null||M===S.toStringTag}S.isGraph=w}(A=r.Graph||(r.Graph={})),function(S){function w(O,M){const T=O instanceof HTMLElement?new S({container:O}):new S(O);return M!=null&&T.fromJSON(M),T}S.render=w}(A=r.Graph||(r.Graph={})),function(S){S.registerNode=h.Node.registry.register,S.registerEdge=h.Edge.registry.register,S.registerView=d.CellView.registry.register,S.registerAttr=c.Attr.registry.register,S.registerGrid=c.Grid.registry.register,S.registerFilter=c.Filter.registry.register,S.registerNodeTool=c.NodeTool.registry.register,S.registerEdgeTool=c.EdgeTool.registry.register,S.registerBackground=c.Background.registry.register,S.registerHighlighter=c.Highlighter.registry.register,S.registerPortLayout=c.PortLayout.registry.register,S.registerPortLabelLayout=c.PortLabelLayout.registry.register,S.registerMarker=c.Marker.registry.register,S.registerRouter=c.Router.registry.register,S.registerConnector=c.Connector.registry.register,S.registerAnchor=c.NodeAnchor.registry.register,S.registerEdgeAnchor=c.EdgeAnchor.registry.register,S.registerConnectionPoint=c.ConnectionPoint.registry.register}(A=r.Graph||(r.Graph={})),function(S){S.unregisterNode=h.Node.registry.unregister,S.unregisterEdge=h.Edge.registry.unregister,S.unregisterView=d.CellView.registry.unregister,S.unregisterAttr=c.Attr.registry.unregister,S.unregisterGrid=c.Grid.registry.unregister,S.unregisterFilter=c.Filter.registry.unregister,S.unregisterNodeTool=c.NodeTool.registry.unregister,S.unregisterEdgeTool=c.EdgeTool.registry.unregister,S.unregisterBackground=c.Background.registry.unregister,S.unregisterHighlighter=c.Highlighter.registry.unregister,S.unregisterPortLayout=c.PortLayout.registry.unregister,S.unregisterPortLabelLayout=c.PortLabelLayout.registry.unregister,S.unregisterMarker=c.Marker.registry.unregister,S.unregisterRouter=c.Router.registry.unregister,S.unregisterConnector=c.Connector.registry.unregister,S.unregisterAnchor=c.NodeAnchor.registry.unregister,S.unregisterEdgeAnchor=c.EdgeAnchor.registry.unregister,S.unregisterConnectionPoint=c.ConnectionPoint.registry.unregister}(A=r.Graph||(r.Graph={}))})(ro);(function(r){var t=E&&E.__decorate||function(c,i,o,l){var f=arguments.length,g=f<3?i:l===null?l=Object.getOwnPropertyDescriptor(i,o):l,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,i,o,l);else for(var m=c.length-1;m>=0;m--)(p=c[m])&&(g=(f<3?p(g):f>3?p(i,o,g):p(i,o))||g);return f>3&&g&&Object.defineProperty(i,o,g),g},e=E&&E.__rest||function(c,i){var o={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&i.indexOf(l)<0&&(o[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,l=Object.getOwnPropertySymbols(c);f<l.length;f++)i.indexOf(l[f])<0&&Object.prototype.propertyIsEnumerable.call(c,l[f])&&(o[l[f]]=c[l[f]]);return o};Object.defineProperty(r,"__esModule",{value:!0}),r.HTML=void 0;const n=$,s=_e,a=fr,u=Er,h=ro;class d extends a.Node{}r.HTML=d,function(c){class i extends u.NodeView{init(){super.init(),this.cell.on("change:*",this.onCellChangeAny,this)}onCellChangeAny({key:l}){const f=c.shapeMaps[this.cell.shape];if(f){const{effect:g}=f;(!g||g.includes(l))&&this.renderHTMLComponent()}}confirmUpdate(l){const f=super.confirmUpdate(l);return this.handleAction(f,i.action,()=>this.renderHTMLComponent())}renderHTMLComponent(){const l=this.selectors&&this.selectors.foContent;if(l){n.Dom.empty(l);const f=c.shapeMaps[this.cell.shape];if(!f)return;let{html:g}=f;typeof g=="function"&&(g=g(this.cell)),g&&(typeof g=="string"?l.innerHTML=g:n.Dom.append(l,g))}}dispose(){this.cell.off("change:*",this.onCellChangeAny,this)}}t([i.dispose()],i.prototype,"dispose",null),c.View=i,function(o){o.action="html",o.config({bootstrap:[o.action],actions:{html:o.action}}),u.NodeView.registry.register("html-view",o,!0)}(i=c.View||(c.View={}))}(d=r.HTML||(r.HTML={})),function(c){c.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},s.Markup.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),a.Node.registry.register("html",c,!0)}(d=r.HTML||(r.HTML={})),function(c){c.shapeMaps={};function i(o){const{shape:l,html:f,effect:g,inherit:p}=o,m=e(o,["shape","html","effect","inherit"]);if(!l)throw new Error("should specify shape in config");c.shapeMaps[l]={html:f,effect:g},h.Graph.registerNode(l,Object.assign({inherit:p||"html"},m),!0)}c.register=i}(d=r.HTML||(r.HTML={}))})(xc);(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(rn,r),e(An,r),e(rn,r),e(mr,r),e(yr,r),e(br,r),e(vr,r),e(wr,r),e(Pr,r),e(An,r),e(Or,r),e(xc,r)})(Zr);var Wc={},Uc={};Object.defineProperty(Uc,"__esModule",{value:!0});(function(r){var t=E&&E.__createBinding||(Object.create?function(n,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(n,u,h)}:function(n,s,a,u){u===void 0&&(u=a),n[u]=s[a]}),e=E&&E.__exportStar||function(n,s){for(var a in n)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&t(s,n,a)};Object.defineProperty(r,"__esModule",{value:!0}),e(ro,r),e(so,r),e(Uc,r),e(Nn,r),e(Tn,r),e(ao,r)})(Wc);(function(r){var t=E&&E.__createBinding||(Object.create?function(h,d,c,i){i===void 0&&(i=c);var o=Object.getOwnPropertyDescriptor(d,c);(!o||("get"in o?!d.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return d[c]}}),Object.defineProperty(h,i,o)}:function(h,d,c,i){i===void 0&&(i=c),h[i]=d[c]}),e=E&&E.__setModuleDefault||(Object.create?function(h,d){Object.defineProperty(h,"default",{enumerable:!0,value:d})}:function(h,d){h.default=d}),n=E&&E.__importStar||function(h){if(h&&h.__esModule)return h;var d={};if(h!=null)for(var c in h)c!=="default"&&Object.prototype.hasOwnProperty.call(h,c)&&t(d,h,c);return e(d,h),d},s=E&&E.__exportStar||function(h,d){for(var c in h)c!=="default"&&!Object.prototype.hasOwnProperty.call(d,c)&&t(d,h,c)};Object.defineProperty(r,"__esModule",{value:!0}),r.Registry=r.Shape=void 0;const a=n(Zr);r.Shape=a;const u=n(Dt);r.Registry=u,s(Ve,r),s(_e,r),s(Wc,r),s($t,r),s(Bt,r),s($,r),s(I,r)})(R);const sy=`.x6-widget-dnd {
  position: absolute;
  top: -10000px;
  left: -10000px;
  z-index: 999999;
  display: none;
  cursor: move;
  opacity: 0.7;
  pointer-events: 'cursor';
}
.x6-widget-dnd.dragging {
  display: inline-block;
}
.x6-widget-dnd.dragging * {
  pointer-events: none !important;
}
.x6-widget-dnd .x6-graph {
  background: transparent;
  box-shadow: none;
}
`;var oy=globalThis&&globalThis.__decorate||function(r,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,t,e,n);else for(var h=r.length-1;h>=0;h--)(u=r[h])&&(a=(s<3?u(a):s>3?u(t,e,a):u(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a};class Se extends R.View{get targetScroller(){return this.options.target.getPlugin("scroller")}get targetGraph(){return this.options.target}get targetModel(){return this.targetGraph.model}get snapline(){return this.options.target.getPlugin("snapline")}constructor(t){super();this.name="dnd",this.options=Object.assign(Object.assign({},Se.defaults),t),this.init()}init(){R.CssLoader.ensure(this.name,sy),this.container=document.createElement("div"),R.Dom.addClass(this.container,this.prefixClassName("widget-dnd")),this.draggingGraph=new R.Graph(Object.assign(Object.assign({},this.options.delegateGraphOptions),{container:document.createElement("div"),width:1,height:1,async:!1})),R.Dom.append(this.container,this.draggingGraph.container)}start(t,e){const n=e;n.preventDefault(),this.targetModel.startBatch("dnd"),R.Dom.addClass(this.container,"dragging"),R.Dom.appendTo(this.container,this.options.draggingContainer||document.body),this.sourceNode=t,this.prepareDragging(t,n.clientX,n.clientY);const s=this.updateNodePosition(n.clientX,n.clientY);this.isSnaplineEnabled()&&(this.snapline.captureCursorOffset({e:n,node:t,cell:t,view:this.draggingView,x:s.x,y:s.y}),this.draggingNode.on("change:position",this.snap,this)),this.delegateDocumentEvents(Se.documentEvents,n.data)}isSnaplineEnabled(){return this.snapline&&this.snapline.isEnabled()}prepareDragging(t,e,n){const s=this.draggingGraph,a=s.model,u=this.options.getDragNode(t,{sourceNode:t,draggingGraph:s,targetGraph:this.targetGraph});u.position(0,0);let h=5;if(this.isSnaplineEnabled()&&(h+=this.snapline.options.tolerance||0),this.isSnaplineEnabled()||this.options.scaled){const i=this.targetGraph.transform.getScale();s.scale(i.sx,i.sy),h*=Math.max(i.sx,i.sy)}else s.scale(1,1);this.clearDragging(),a.resetCells([u]);const d=s.findViewByCell(u);d.undelegateEvents(),d.cell.off("changed"),s.fitToContent({padding:h,allowNewOrigin:"any",useCellGeometry:!1});const c=d.getBBox();this.geometryBBox=d.getBBox({useCellGeometry:!0}),this.delta=this.geometryBBox.getTopLeft().diff(c.getTopLeft()),this.draggingNode=u,this.draggingView=d,this.draggingBBox=u.getBBox(),this.padding=h,this.originOffset=this.updateGraphPosition(e,n)}updateGraphPosition(t,e){const n=document.body.scrollTop||document.documentElement.scrollTop,s=document.body.scrollLeft||document.documentElement.scrollLeft,a=this.delta,u=this.geometryBBox,h=this.padding||5,d={left:t-a.x-u.width/2-h+s,top:e-a.y-u.height/2-h+n};return this.draggingGraph&&R.Dom.css(this.container,{left:`${d.left}px`,top:`${d.top}px`}),d}updateNodePosition(t,e){const n=this.targetGraph.clientToLocal(t,e),s=this.draggingBBox;return n.x-=s.width/2,n.y-=s.height/2,this.draggingNode.position(n.x,n.y),n}snap({cell:t,current:e,options:n}){const s=t;if(n.snapped){const a=this.draggingBBox;s.position(a.x+n.tx,a.y+n.ty,{silent:!0}),this.draggingView.translate(),s.position(e.x,e.y,{silent:!0}),this.snapOffset={x:n.tx,y:n.ty}}else this.snapOffset=null}onDragging(t){const e=this.draggingView;if(e){t.preventDefault();const n=this.normalizeEvent(t),s=n.clientX,a=n.clientY;this.updateGraphPosition(s,a);const u=this.updateNodePosition(s,a),h=this.targetGraph.options.embedding.enabled,d=(h||this.isSnaplineEnabled())&&this.isInsideValidArea({x:s,y:a});if(h){e.setEventData(n,{graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView});const c=e.getEventData(n);d?e.processEmbedding(n,c):e.clearEmbedding(c),this.candidateEmbedView=c.candidateEmbedView}this.isSnaplineEnabled()&&(d?this.snapline.snapOnMoving({e:n,view:e,x:u.x,y:u.y}):this.snapline.hide())}}onDragEnd(t){const e=this.draggingNode;if(e){const n=this.normalizeEvent(t),s=this.draggingView,a=this.draggingBBox,u=this.snapOffset;let h=a.x,d=a.y;u&&(h+=u.x,d+=u.y),e.position(h,d,{silent:!0});const c=this.drop(e,{x:n.clientX,y:n.clientY}),i=o=>{o?(this.onDropped(e),this.targetGraph.options.embedding.enabled&&s&&(s.setEventData(n,{cell:o,graph:this.targetGraph,candidateEmbedView:this.candidateEmbedView}),s.finalizeEmbedding(n,s.getEventData(n)))):this.onDropInvalid(),this.candidateEmbedView=null,this.targetModel.stopBatch("dnd")};R.FunctionExt.isAsync(c)?(this.undelegateDocumentEvents(),c.then(i)):i(c)}}clearDragging(){this.draggingNode&&(this.sourceNode=null,this.draggingNode.remove(),this.draggingNode=null,this.draggingView=null,this.delta=null,this.padding=null,this.snapOffset=null,this.originOffset=null,this.undelegateDocumentEvents())}onDropped(t){this.draggingNode===t&&(this.clearDragging(),R.Dom.removeClass(this.container,"dragging"),R.Dom.remove(this.container))}onDropInvalid(){const t=this.draggingNode;t&&this.onDropped(t)}isInsideValidArea(t){let e,n=null;const s=this.targetGraph,a=this.targetScroller;this.options.dndContainer&&(n=this.getDropArea(this.options.dndContainer));const u=n&&n.containsPoint(t);if(a)if(a.options.autoResize)e=this.getDropArea(a.container);else{const h=this.getDropArea(a.container);e=this.getDropArea(s.container).intersectsWithRect(h)}else e=this.getDropArea(s.container);return!u&&e&&e.containsPoint(t)}getDropArea(t){const e=R.Dom.offset(t),n=document.body.scrollTop||document.documentElement.scrollTop,s=document.body.scrollLeft||document.documentElement.scrollLeft;return R.Rectangle.create({x:e.left+parseInt(R.Dom.css(t,"border-left-width"),10)-s,y:e.top+parseInt(R.Dom.css(t,"border-top-width"),10)-n,width:t.clientWidth,height:t.clientHeight})}drop(t,e){if(this.isInsideValidArea(e)){const n=this.targetGraph,s=n.model,a=n.clientToLocal(e),u=this.sourceNode,h=this.options.getDropNode(t,{sourceNode:u,draggingNode:t,targetGraph:this.targetGraph,draggingGraph:this.draggingGraph}),d=h.getBBox();a.x+=d.x-d.width/2,a.y+=d.y-d.height/2;const c=this.snapOffset?1:n.getGridSize();h.position(R.GeometryUtil.snapToGrid(a.x,c),R.GeometryUtil.snapToGrid(a.y,c)),h.removeZIndex();const i=this.options.validateNode,o=i?i(h,{sourceNode:u,draggingNode:t,droppingNode:h,targetGraph:n,draggingGraph:this.draggingGraph}):!0;return typeof o=="boolean"?o?(s.addCell(h,{stencil:this.cid}),h):null:R.FunctionExt.toDeferredBoolean(o).then(l=>l?(s.addCell(h,{stencil:this.cid}),h):null)}return null}onRemove(){this.draggingGraph&&(this.draggingGraph.view.remove(),this.draggingGraph.dispose())}dispose(){this.remove(),R.CssLoader.clean(this.name)}}oy([R.View.dispose()],Se.prototype,"dispose",null);(function(r){r.defaults={getDragNode:t=>t.clone(),getDropNode:t=>t.clone()},r.documentEvents={mousemove:"onDragging",touchmove:"onDragging",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"}})(Se||(Se={}));const ay="LITEFLOW_START",ly="LITEFLOW_END",Yt="LITEFLOW_INTERMEDIATE_END",X="LITEFLOW_EDGE";var rt;(function(r){r.COMMON="NodeComponent",r.BOOLEAN="NodeBooleanComponent",r.SWITCH="NodeSwitchComponent",r.IF="NodeIfComponent",r.FOR="NodeForComponent",r.WHILE="NodeWhileComponent",r.BREAK="NodeBreakComponent",r.ITERATOR="NodeIteratorComponent",r.SCRIPT="ScriptCommonComponent",r.SWITCH_SCRIPT="ScriptSwitchComponent",r.IF_SCRIPT="ScriptIfComponent",r.FOR_SCRIPT="ScriptForComponent",r.WHILE_SCRIPT="ScriptWhileComponent",r.BREAK_SCRIPT="ScriptBreakComponent",r.FALLBACK="fallback",r.VIRTUAL="NodeVirtualComponent"})(rt||(rt={}));var V;(function(r){r.CHAIN="CHAIN",r.THEN="THEN",r.WHEN="WHEN",r.SWITCH="SWITCH",r.IF="IF",r.PRE="PRE",r.FINALLY="FINALLY",r.FOR="FOR",r.WHILE="WHILE",r.ITERATOR="ITERATOR",r.BREAK="BREAK",r.CATCH="CATCH",r.AND="AND",r.OR="OR",r.NOT="NOT",r.ABSTRACT="ABSTRACT"})(V||(V={}));const cy=[{props:{name:"\u4E32\u884C",svg:"/src/views/flogComponents/assets/then-icon.svg",type:V.THEN},id:1},{props:{name:"\u5E76\u884C",svg:"/src/views/flogComponents/assets/when-icon.svg",type:V.WHEN},id:2},{props:{name:"\u9009\u62E9",svg:"/src/views/flogComponents/assets/switch-icon.svg",type:V.SWITCH},id:3},{props:{name:"\u6761\u4EF6",svg:"/src/views/flogComponents/assets/if-icon.svg",type:V.IF},id:4},{props:{name:"for\u5FAA\u73AF",svg:"/src/views/flogComponents/assets/for-icon.svg",type:V.FOR},id:5},{props:{name:"while\u5FAA\u73AF",svg:"/src/views/flogComponents/assets/while-icon.svg",type:V.WHILE},id:6},{props:{name:"iterator\u5FAA\u73AF",svg:"/src/views/flogComponents/assets/iterator-icon.svg",type:V.ITERATOR},id:7},{props:{name:"\u6355\u83B7\u5F02\u5E38(Catch)",svg:"/src/views/flogComponents/assets/catch-icon.svg",type:V.CATCH},id:8},{props:{name:"\u4E0E(And)",svg:"/src/views/flogComponents/assets/and-icon.svg",type:V.AND},id:9},{props:{name:"\u6216(Or)",svg:"/src/views/flogComponents/assets/or-icon.svg",type:V.OR},id:10},{props:{name:"\u975E(Not)",svg:"/src/views/flogComponents/assets/not-icon.svg",type:V.NOT},id:11},{props:{name:"\u8282\u70B9",svg:"/src/views/flogComponents/assets/common-icon.svg",type:V.COMMON},id:12}];function uy(){return"xxxx-xxxx-xxxx-xxxx".replace(/[x]/g,()=>Math.floor(Math.random()*16).toString(16))}const hy=(r,t,e)=>{console.log(t);const n=uy();return{x:t,y:e,id:n,width:r.width||30,height:r.height||30,shape:"image",attrs:{image:{x:0,y:0,href:r.props.svg}},data:JSON.parse(JSON.stringify(r))}};const ge={x:null,y:null},dy={name:"DrawerCom",props:{graph:{type:R.Graph,default:"",required:!0}},data(){return{visible:!0,direction:"ltr",showMore:!0,configList:cy}},mounted(){document.getElementById("graphContainer").addEventListener("dragover",function(r){ge.x=r.clientX,ge.y=r.clientY},!1)},methods:{drag:function(r){},dragend:function(r){console.log(r);const t=document.getElementById("graphContainer").getBoundingClientRect();let e=!1;ge.x>t.left&&ge.x<t.right&&ge.y>t.top&&ge.y<t.bottom&&(e=!0),e===!0&&this.$emit("addNode",hy(r,ge.x,ge.y))}}},fy={style:{"min-width":"300px"},class:"Ec-x6-icon"},gy=Yr(" \u7CFB\u7EDF\u7EC4\u4EF6 "),py={key:0,class:"listBar-cot"},my=["onDrag","onDragend"],yy={style:{display:"flex","flex-direction":"column","align-items":"center"}},by=["src"],vy={style:{"align-items":"center"}};function wy(r,t,e,n,s,a){const u=xu("ArrowDown"),h=Pu;return Ne(),Te("div",fy,[jt("section",{class:"listBar",onClick:t[1]||(t[1]=Su(()=>{},["stop"]))},[jt("p",{onClick:t[0]||(t[0]=d=>s.showMore=!s.showMore)},[bt(h,{class:Ou({arrow:s.showMore})},{default:Qt(()=>[bt(u)]),_:1},8,["class"]),gy]),s.showMore?(Ne(),Te("div",py,[(Ne(!0),Te(Eu,null,Cu(s.configList,(d,c)=>(Ne(),Te("div",{key:c,class:"drag-cot",draggable:"true",onDrag:i=>a.drag(d),onDragend:i=>a.dragend(d)},[jt("div",yy,[jt("img",{class:"icon",src:d.props.svg,style:{width:"45px",height:"45px"},alt:"Icon"},null,8,by),jt("p",vy,vo(d.props.name),1)])],40,my))),128))])):_u("",!0)])])}var xy=Kr(dy,[["render",wy],["__scopeId","data-v-779ca2a8"]]);const Py=r=>(Au("data-v-1e920158"),r=r(),Nu(),r),Oy={class:"liteflowEditorBasicContainer"},Ey=Py(()=>jt("div",{class:"liteflowEditorTitle"},"EL\u8868\u8FBE\u5F0F\uFF1A",-1)),Cy={class:"elContentWrapper"},_y=wo({props:{flowGraph:null},setup(r,{expose:t}){te("");const e=()=>{console.log("\u8F6C\u5316")},n=te(""),s=a=>{Po(()=>{n.value=a}),console.log("Updated ELExpression in Basic:",n.value),Po(()=>{console.log("DOM Updated")})};return xo(()=>{e()}),Mu(()=>{}),t({updateElString:e,updateELExpression:s}),(a,u)=>(Ne(),Te("div",Oy,[Ey,jt("div",Cy,[jt("div",null,vo(n.value),1)])]))}});var Sy=Kr(_y,[["__scopeId","data-v-1e920158"]]);class gt{constructor(){this.cells=[],this.nodes=[]}appendChild(t,e){if(t.parent=this,this.children){if(typeof e=="number")return this.children.splice(e,0,t),!0;if(e){const n=this.children.indexOf(e);if(n!==-1)return this.children.splice(n+1,0,t),!0;if(this.condition===e)return this.appendChild(t,0)}return this.children.push(t),!0}return!1}prependChild(t,e){if(t.parent=this,this.children){if(typeof e=="number")return this.children.splice(e,0,t),!0;if(e){const n=this.children.indexOf(e);if(n!==-1)return this.children.splice(n,0,t),!0;if(this.condition===e)return this.prepend(t)}return this.children.splice(0,0,t),!0}return!1}removeChild(t){if(this.children){const e=this.children.indexOf(t);if(e!==-1)return this.children.splice(e,1),!0}return this.condition&&this.condition===t?this.remove():!1}prepend(t){if(this.parent){if(this.parent.prependChild(t,this))return!0}else return this.prependChild(t);return!1}append(t){if(this.parent){if(this.parent.appendChild(t,this))return!0}else return this.appendChild(t);return!1}remove(){return this.parent?this.parent.removeChild(this):!1}replace(t){return this.parent&&this.parent.replaceChild(this,t),!1}replaceChild(t,e){if(e.parent=this,this.children){const n=this.children.indexOf(t);if(n!==-1)return this.children.splice(n,1,e),!0}return this.condition===t?(this.condition=e,!0):!1}selectNodes(){var t;return((t=this.parent)==null?void 0:t.condition)===this?this.parent.getNodes():this.getNodes()}getNodes(){let t=[...this.nodes];return this.condition&&(t=t.concat(this.condition.getNodes())),this.children&&this.children.length&&this.children.forEach(e=>{t=t.concat(e.getNodes())}),t}getCells(){let t=[...this.cells];return this.condition&&(t=t.concat(this.condition.getCells())),this.children&&this.children.length&&this.children.forEach(e=>{t=t.concat(e.getCells())}),t}resetCells(t,e){this.cells=t||[],this.nodes=e||[]}getStartNode(){return this.startNode}getEndNode(){return this.endNode}addNode(t){return this.nodes.push(t),t}getProperties(){const t=this.properties||{};return Object.keys(t).filter(e=>t[e]===""||t[e]===null).forEach(e=>t[e]=void 0),t}setProperties(t){this.properties=t}propertiesToEL(){const t=this.getProperties();return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>`.${e}(${My(t[e])})`).join("")}toJSON(){const{type:t,condition:e,children:n,properties:s,id:a}=this;return Object.assign({type:t},e?{condition:e.toJSON()}:{},n?{children:n.filter(u=>u).map(u=>u.toJSON())}:{},a?{id:a}:{},s?{properties:this.getProperties()}:{})}isParentOf(t){const e=this.proxy||this;let n=t.proxy||t;for(;n;){if(n.parent===e)return!0;n=n.parent}return!1}}function My(r){return typeof r=="string"?`"${r}"`:typeof r=="object"&&r.name||r}class tt extends gt{constructor(t,e,n,s){super();this.parent=t,this.type=e||rt.COMMON,this.id=n||`Placeholder${Math.ceil(Math.random()*10)}`,this.properties=s}static create(t,e,n){return new tt(t,e,n)}toCells(t=[],e={}){this.resetCells(t);const{id:n,type:s}=this,a=R.Node.create(tn({shape:s,attrs:{label:{text:n}}},e||{}));return a.setData({model:this},{overwrite:!0}),t.push(this.addNode(a)),this.node=a,this.getCells()}getStartNode(){return this.node}getEndNode(){return this.node}toEL(t=""){return`${t}${this.id}${this.propertiesToEL()}`}}class Dn extends gt{constructor(t,e,n){super();this.type=V.THEN,this.children=[],this.parent=t,e&&(this.children=e),this.properties=n}static create(t,e){const n=new Dn(t);return n.appendChild(tt.create(n,e)),n}removeChild(t){return this.children&&this.children.length>1?super.removeChild(t):this.remove()}toCells(t=[],e={}){this.resetCells(t);const{children:n}=this;let s;return n.forEach(a=>{a.toCells([],e);const u=a.getStartNode();s&&t.push(R.Edge.create({shape:X,source:s.id,target:u.id})),s=a.getEndNode()}),this.getCells()}getStartNode(){return this.children[0].getStartNode()}getEndNode(){return this.children[this.children.length-1].getEndNode()}toEL(t){return t?`${t}THEN(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})${this.propertiesToEL()}`:`THEN(${this.children.map(e=>e.toEL()).join(",")})${this.propertiesToEL()}`}}class Ln extends gt{constructor(t){super();this.type=rt.VIRTUAL,this.proxy=t,this.parent=t.parent}prepend(t){return this.proxy.prepend(t)}append(t){return this.proxy.prependChild(t)}remove(){return this.proxy.remove()}replace(t){return this.proxy.replace(t)}toCells(){throw new Error("Method not implemented.")}getCells(){return this.proxy.getCells()}getNodes(){return this.proxy.getNodes()}getStartNode(){return this.proxy.getStartNode()}getEndNode(){return this.proxy.getEndNode()}getProperties(){return this.proxy.getProperties()}setProperties(t){this.proxy.setProperties(t)}propertiesToEL(){return this.proxy.propertiesToEL()}toEL(t){return this.proxy.toEL(t)}toJSON(){return this.proxy.toJSON()}}class Kt extends gt{constructor(t){super();this.type=rt.VIRTUAL,this.proxy=t,this.parent=t.parent}prepend(t){return this.proxy.appendChild(t)}append(t){return this.proxy.append(t)}remove(){return this.proxy.remove()}replace(t){return this.proxy.replace(t)}toCells(){throw new Error("Method not implemented.")}getCells(){return this.proxy.getCells()}getNodes(){return this.proxy.getNodes()}getStartNode(){return this.proxy.getStartNode()}getEndNode(){return this.proxy.getEndNode()}getProperties(){return this.proxy.getProperties()}setProperties(t){this.proxy.setProperties(t)}propertiesToEL(){return this.proxy.propertiesToEL()}toEL(t){return this.proxy.toEL(t)}toJSON(){return this.proxy.toJSON()}}class ho extends gt{constructor(t,e,n){super();this.type=rt.VIRTUAL,this.index=0,this.parent=t,this.index=e,this.proxy=n}prepend(t){return this.replace(t)}append(t){return this.replace(t)}remove(){return!1}replace(t){return this.parent.appendChild(t,this.index)}toCells(){return this.proxy.toCells()}getCells(){return this.proxy.getCells()}getNodes(){return this.proxy.getNodes()}getStartNode(){return this.proxy.getStartNode()}getEndNode(){return this.proxy.getEndNode()}getProperties(){return this.proxy.getProperties()}setProperties(t){this.proxy.setProperties(t)}propertiesToEL(){return this.proxy.propertiesToEL()}toEL(t){return this.proxy.toEL(t)}toJSON(){return this.proxy.toJSON()}}class Rr extends gt{constructor(t,e,n){super();this.type=V.WHEN,this.children=[],this.parent=t,e&&(this.children=e),this.properties=n}static create(t,e){const n=new Rr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{children:n}=this,s=R.Node.create({shape:V.WHEN,attrs:{label:{text:""}}});s.setData({model:new Ln(this)},{overwrite:!0}),t.push(this.addNode(s)),this.startNode=s;const a=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return a.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(a)),this.endNode=a,n.length?n.forEach(u=>{u.toCells([],e);const h=u.getStartNode();t.push(R.Edge.create({shape:X,source:s.id,target:h.id}));const d=u.getEndNode();t.push(R.Edge.create({shape:X,source:d.id,target:a.id}))}):t.push(R.Edge.create({shape:X,source:s.id,target:a.id})),this.getCells()}toEL(t=""){return t?`${t}WHEN(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})${this.propertiesToEL()}`:`WHEN(${this.children.map(e=>e.toEL()).join(", ")})${this.propertiesToEL()}`}}class Ir extends gt{constructor(t,e,n,s){super();this.type=V.SWITCH,this.condition=new tt(this,rt.SWITCH,"x"),this.children=[],this.parent=t,e&&(this.condition=e),n&&(this.children=n),this.properties=s}static create(t,e){const n=new Ir(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{condition:n,children:s}=this;n.toCells([],{shape:rt.SWITCH});let a=n.getStartNode();a.setData({model:n},{overwrite:!0}),this.startNode=a,a=n.getEndNode();const u=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return u.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(u)),this.endNode=u,s.length?s.forEach(h=>{h.toCells([],e);const d=h.getStartNode();t.push(R.Edge.create({shape:X,source:a.id,target:d.id}));const c=h.getEndNode();t.push(R.Edge.create({shape:X,source:c.id,target:u.id}))}):t.push(R.Edge.create({shape:X,source:a.id,target:u.id})),this.getCells()}toEL(t=""){return t?`${t}SWITCH(${this.condition.toEL()}).to(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})`:`SWITCH(${this.condition.toEL()}).to(${this.children.map(e=>e.toEL()).join(", ")})`}}class Vr extends gt{constructor(t,e,n,s){super();this.type=V.IF,this.condition=new tt(this,rt.IF,"x"),this.children=[],this.parent=t,e&&(this.condition=e),n&&(this.children=n),this.properties=s}static create(t,e){const n=new Vr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{condition:n,children:s=[]}=this;n.toCells([],{shape:rt.IF});let a=n.getStartNode();a.setData({model:n,toolbar:{prepend:!0,append:!1,delete:!0,replace:!0}},{overwrite:!0}),this.startNode=a,a=n.getEndNode();const u=R.Node.create({shape:Yt,attrs:{label:{text:""}}});u.setData({model:new Kt(this),toolbar:{prepend:!1,append:!0,delete:!0,replace:!0}},{overwrite:!0}),t.push(this.addNode(u)),this.endNode=u;const[h,d]=s;return[h,d].forEach((c,i)=>{const o=c||tt.create(this,rt.VIRTUAL," ");o.toCells([],e);const l=o.getStartNode();t.push(R.Edge.create({shape:X,source:a.id,target:l.id,label:i?"false":"true"}));const f=o.getEndNode();t.push(R.Edge.create({shape:X,source:f.id,target:u.id,label:" "})),c||(l.setData({model:new ho(this,i,o),toolbar:{prepend:!1,append:!1,delete:!1,replace:!0}},{overwrite:!0}),t.push(this.addNode(l)))}),this.getCells()}appendChild(t,e){if(t.parent=this,this.children){if(typeof e=="number")return this.children[e<=1?e:1]=t,!0;if(e){const n=this.children.indexOf(e);if(n!==-1)return this.children[n<=1?n:1]=t,!0;if(this.condition===e)return this.appendChild(t,0)}return this.children.push(t),!0}return!1}prependChild(t,e){if(t.parent=this,this.children){if(typeof e=="number")return this.children[e]=t,!0;if(e){const n=this.children.indexOf(e);if(n!==-1)return this.children[n]=t,!0;if(this.condition===e)return this.prepend(t)}return this.children.splice(0,this.children[0]?1:0,t),!0}return!1}toEL(t=""){return t?`${t}IF(
${[this.condition.toEL(`${t}  `),...this.children.filter(e=>e).map(e=>e.toEL(`${t}  `))].join(`, 
`)}
${t})${this.propertiesToEL()}`:`IF(${[this.condition.toEL(),...this.children.filter(e=>e).map(e=>e.toEL())].join(", ")})${this.propertiesToEL()}`}}class Fr extends gt{constructor(t,e,n,s){super();this.type=V.FOR,this.condition=new tt(this,rt.FOR,"x"),this.children=[],this.parent=t,e&&(this.condition=e),n&&(this.children=n),this.properties=s}static create(t,e){const n=new Fr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{condition:n,children:s}=this;n.toCells([],{shape:rt.FOR});let a=n.getStartNode();a.setData({model:n},{overwrite:!0}),this.startNode=a,a=n.getEndNode();const u=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return u.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(u)),this.endNode=u,s.length?s.forEach(h=>{h.toCells([],e);const d=h.getStartNode();t.push(R.Edge.create({shape:X,source:a.id,target:d.id}));const c=h.getEndNode();t.push(R.Edge.create({shape:X,source:c.id,target:u.id}))}):t.push(R.Edge.create({shape:X,source:a.id,target:u.id})),this.getCells()}toEL(t=""){return t?`${t}FOR(${this.condition.toEL()}).DO(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})`:`FOR(${this.condition.toEL()}).DO(${this.children.map(e=>e.toEL()).join(", ")})`}}class zr extends gt{constructor(t,e,n,s){super();this.type=V.WHILE,this.condition=new tt(this,rt.WHILE,"x"),this.children=[],this.parent=t,e&&(this.condition=e),n&&(this.children=n),this.properties=s}static create(t,e){const n=new zr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{condition:n,children:s}=this;n.toCells([],{shape:rt.WHILE});let a=n.getStartNode();a.setData({model:n},{overwrite:!0}),this.startNode=a,a=n.getEndNode();const u=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return u.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(u)),this.endNode=u,s.length?s.forEach(h=>{h.toCells([],e);const d=h.getStartNode();t.push(R.Edge.create({shape:X,source:a.id,target:d.id}));const c=h.getEndNode();t.push(R.Edge.create({shape:X,source:c.id,target:u.id}))}):t.push(R.Edge.create({shape:X,source:a.id,target:u.id})),this.getCells()}toEL(t=""){return t?`${t}WHILE(${this.condition.toEL()}).DO(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})${this.propertiesToEL()}`:`WHILE(${this.condition.toEL()}).DO(${this.children.map(e=>e.toEL()).join(", ")})`}}class kr extends gt{constructor(t,e,n,s){super();this.type=V.ITERATOR,this.condition=new tt(this,rt.ITERATOR,"x"),this.children=[],this.parent=t,e&&(this.condition=e),n&&(this.children=n),this.properties=s}static create(t,e){const n=new kr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{condition:n,children:s}=this;n.toCells([],{shape:rt.ITERATOR});let a=n.getStartNode();a.setData({model:n},{overwrite:!0}),this.startNode=a,a=n.getEndNode();const u=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return u.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(u)),this.endNode=u,s.length?s.forEach(h=>{h.toCells([],e);const d=h.getStartNode();t.push(R.Edge.create({shape:X,source:a.id,target:d.id}));const c=h.getEndNode();t.push(R.Edge.create({shape:X,source:c.id,target:u.id}))}):t.push(R.Edge.create({shape:X,source:a.id,target:u.id})),this.getCells()}toEL(t=""){return t?`${t}ITERATOR(${this.condition.toEL()}).DO(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})`:`ITERATOR(${this.condition.toEL()}).DO(${this.children.map(e=>e.toEL()).join(", ")})`}}var Ay="/assets/intermediate-event-catch-error.4c3da0e7.svg";class Hr extends gt{constructor(t,e,n,s){super();this.type=V.CATCH,this.condition=new tt(this,rt.COMMON,"x"),this.children=[],this.parent=t,e&&(this.condition=e),n&&(this.children=n),this.properties=s}static create(t,e){const n=new Hr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{condition:n,children:s}=this,a=R.Node.create({shape:V.CATCH,attrs:{label:{text:""}},portMarkup:[{tagName:"image",selector:"circle",attrs:{x:-6,y:-6,width:12,height:12,"xlink:href":Ay}}],ports:{groups:{bottom:{position:{name:"bottom"},zIndex:1}},items:[{group:"bottom",id:"bottom"}]}});a.setData({model:new Ln(this)},{overwrite:!0}),t.push(this.addNode(a)),this.startNode=a;const u=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return u.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(u)),this.endNode=u,[n,...s].forEach((h,d)=>{const c=h||tt.create(this,rt.VIRTUAL," ");c.toCells([],e);const i=c.getStartNode();t.push(R.Edge.create({shape:X,source:a.id,target:i.id,label:d===1?"\u5F02\u5E38":" ",defaultLabel:{position:{distance:.3}}}));const o=c.getEndNode();t.push(R.Edge.create({shape:X,source:o.id,target:u.id,label:" "})),h||(i.setData({model:new ho(this,d,c),toolbar:{prepend:!1,append:!1,delete:!1,replace:!0}},{overwrite:!0}),t.push(this.addNode(i)))}),this.getCells()}appendChild(t,e){if(t.parent=this,!this.condition)return this.condition=t,!0;if(this.children){if(typeof e=="number")return this.children[0]=t,!0;if(e){if(this.children.indexOf(e)!==-1)return this.children[0]=t,!0;if(this.condition===e)return this.condition=t,!0}return this.children[0]=t,!0}return!1}prependChild(t,e){if(t.parent=this,!this.condition)return this.condition=t,!0;if(this.children){if(typeof e=="number")return this.children[0]=t,!0;if(e){if(this.children.indexOf(e)!==-1)return this.children[0]=t,!0;if(this.condition===e)return this.condition=t,!0}return this.children[0]=t,!0}return!1}removeChild(t){if(this.children){const e=this.children.indexOf(t);if(e!==-1)return this.children.splice(e,1),!0}return this.condition&&this.condition===t?(this.condition=void 0,!0):!1}toEL(t=""){const e=this.condition,[n]=this.children;return t?`${t}CATCH(
${e?e.toEL(`${t}  `):""}
${t})${n?`.DO(
${n.toEL(`${t}  `)}
${t})`:""}${this.propertiesToEL()}`:`CATCH(${e?e.toEL():""})${n?`.DO(${n.toEL()})`:""}${this.propertiesToEL()}`}}class Gr extends gt{constructor(t,e,n){super();this.type=V.AND,this.children=[],this.parent=t,e&&(this.children=e),this.properties=n}static create(t,e){const n=new Gr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{children:n}=this,s=R.Node.create(tn({shape:V.AND,attrs:{label:{text:""}}},e));s.setData({model:new Ln(this)},{overwrite:!0}),t.push(this.addNode(s)),this.startNode=s;const a=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return a.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(a)),this.endNode=a,n.length?n.forEach(u=>{u.toCells([],{});const h=u.getStartNode();t.push(R.Edge.create({shape:X,source:s.id,target:h.id,label:" + ",defaultLabel:{position:{options:{keepGradient:!1,ensureLegibility:!1}}}}));const d=u.getEndNode();t.push(R.Edge.create({shape:X,source:d.id,target:a.id}))}):t.push(R.Edge.create({shape:X,source:s.id,target:a.id})),this.getCells()}toEL(t=""){return t?`${t}AND(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})${this.propertiesToEL()}`:`AND(${this.children.map(e=>e.toEL()).join(", ")})${this.propertiesToEL()}`}}class qr extends gt{constructor(t,e,n){super();this.type=V.OR,this.children=[],this.parent=t,e&&(this.children=e),this.properties=n}static create(t,e){const n=new qr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{children:n}=this,s=R.Node.create(tn({shape:V.OR,attrs:{label:{text:""}}},e));s.setData({model:new Ln(this)},{overwrite:!0}),t.push(this.addNode(s)),this.startNode=s;const a=R.Node.create({shape:Yt,attrs:{label:{text:""}}});return a.setData({model:new Kt(this)},{overwrite:!0}),t.push(this.addNode(a)),this.endNode=a,n.length?n.forEach(u=>{u.toCells([],{});const h=u.getStartNode();t.push(R.Edge.create({shape:X,source:s.id,target:h.id,label:" * ",defaultLabel:{position:{options:{keepGradient:!1,ensureLegibility:!1}}}}));const d=u.getEndNode();t.push(R.Edge.create({shape:X,source:d.id,target:a.id}))}):t.push(R.Edge.create({shape:X,source:s.id,target:a.id})),this.getCells()}toEL(t=""){return t?`${t}OR(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})${this.propertiesToEL()}`:`OR(${this.children.map(e=>e.toEL()).join(", ")})${this.propertiesToEL()}`}}class Wr extends gt{constructor(t,e,n){super();this.type=V.NOT,this.children=[],this.parent=t,e&&(this.children=e),this.properties=n}static create(t,e){const n=new Wr(t);return n.appendChild(tt.create(n,e)),n}toCells(t=[],e={}){this.resetCells(t);const{children:n}=this,s=R.Node.create(tn({shape:V.NOT,attrs:{label:{text:""}}},e));s.setData({model:new Ln(this),toolbar:{prepend:!0,append:!1,delete:!0,replace:!0}},{overwrite:!0}),t.push(this.addNode(s)),this.startNode=s;const a=R.Node.create({shape:Yt,attrs:{label:{text:""}}});a.setData({model:new Kt(this),toolbar:{prepend:!1,append:!0,delete:!0,replace:!0}},{overwrite:!0}),t.push(this.addNode(a)),this.endNode=a;const[u]=n;return[u].forEach((h,d)=>{const c=h||tt.create(this,rt.VIRTUAL," ");c.toCells([],{});const i=c.getStartNode();t.push(R.Edge.create({shape:X,source:s.id,target:i.id,label:" - ",defaultLabel:{attrs:{fo:{x:-20,y:-20}},position:{options:{keepGradient:!1,ensureLegibility:!1}}}}));const o=c.getEndNode();t.push(R.Edge.create({shape:X,source:o.id,target:a.id,label:" "})),h||(i.setData({model:new ho(this,d,c),toolbar:{prepend:!1,append:!1,delete:!1,replace:!0}},{overwrite:!0}),t.push(this.addNode(i)))}),this.getCells()}appendChild(t,e){return t.parent=this,this.children[0]=t,!0}prependChild(t,e){return t.parent=this,this.children[0]=t,!0}toEL(t=""){return t?`${t}NOT(
${this.children.map(e=>e.toEL(`${t}  `)).join(`, 
`)}
${t})${this.propertiesToEL()}`:`NOT(${this.children.map(e=>e.toEL()).join(", ")})${this.propertiesToEL()}`}}class Ny extends gt{constructor(t){super();this.type=V.CHAIN,this.children=[],t&&(this.children=t)}toCells(){this.resetCells();const t=this.cells,e=R.Node.create({shape:ay,attrs:{label:{text:"\u5F00\u59CB"}}});e.setData({model:this,toolbar:{prepend:!1,append:!0,delete:!1,replace:!1}},{overwrite:!0}),t.push(e),this.startNode=e;let n=e;this.children.forEach(a=>{a.toCells([],{}),t.push(R.Edge.create({shape:X,source:n.id,target:a.getStartNode().id})),n=a.getEndNode()});const s=R.Node.create({shape:ly,attrs:{label:{text:"\u7ED3\u675F"}}});return s.setData({model:this,toolbar:{prepend:!0,append:!1,delete:!1,replace:!1}},{overwrite:!0}),t.push(s),this.endNode=s,t.push(R.Edge.create({shape:X,source:n.id,target:s.id})),this.getCells()}toEL(t=""){return`${this.dataPropertyToEL(t)}${this.children.map(e=>e.toEL(t)).join(", ")};`}dataPropertyToEL(t=""){const e=[];let n=[this];for(;n.length;){let s=[];n.forEach(a=>{var h,d;const u=a.getProperties();((h=u.data)==null?void 0:h.name)&&((d=u.data)==null?void 0:d.value)&&e.push(u.data),a.condition&&s.push(a.condition),a.children&&a.children.length&&(s=s.concat(a.children))}),n=s}return e.map(s=>`${t}${s.name||""}=${s.value||""};
`).join("")}toJSON(){return this.children.length?this.children.length===1?this.children[0].toJSON():this.children.map(t=>t.toJSON()):{}}append(t){return this.children.length===1&&this.children[0].type===V.THEN?this.children[0].prependChild(t,0):this.appendChild(t,0)}appendChild(t,e){const n=super.appendChild(t,e);return this.addWrapperIfPossible(),n}prepend(t){return this.children.length===1&&this.children[0].type===V.THEN?this.children[0].appendChild(t):this.appendChild(t)}prependChild(t,e){const n=super.prependChild(t,e);return this.addWrapperIfPossible(),n}addWrapperIfPossible(){if(this.children.length>1){const t=new Dn(this,[]);this.children.forEach(e=>{t.appendChild(e)}),this.children=[t]}}remove(){return!1}}class Ty{static build(t){return jy(t)}static createELNode(t,e,n){switch(t){case V.THEN:return Dn.create(e);case V.WHEN:return Rr.create(e);case V.SWITCH:return Ir.create(e);case V.IF:return Vr.create(e);case V.FOR:return Fr.create(e);case V.WHILE:return zr.create(e);case V.ITERATOR:return kr.create(e);case V.CATCH:return Hr.create(e);case V.AND:return Gr.create(e);case V.OR:return qr.create(e);case V.NOT:return Wr.create(e);case rt.COMMON:default:return tt.create(e,t,n)}}}function jy(r){console.log("builder\u65B9\u6CD5",r);const t=new Ny;if(console.log("\u521D\u59CB\u5316\u7684chain",t),Array.isArray(r))r.forEach(e=>{const n=Ur({parent:t,data:e});n&&t.appendChild(n)});else{const e=Ur({parent:t,data:r});e&&t.appendChild(e)}return console.log("\u8FD4\u56DE\u7684chain",t),t}function Ur({parent:r,data:t}){if(!!(t==null?void 0:t.type))switch(t.type){case V.THEN:return Ft({parent:new Dn(r),data:t});case V.WHEN:return Ft({parent:new Rr(r),data:t});case V.SWITCH:return Ft({parent:new Ir(r),data:t});case V.IF:return Ft({parent:new Vr(r),data:t});case V.FOR:return Ft({parent:new Fr(r),data:t});case V.WHILE:return Ft({parent:new zr(r),data:t});case V.ITERATOR:return Ft({parent:new kr(r),data:t});case V.CATCH:return Ft({parent:new Hr(r),data:t});case V.AND:return Ft({parent:new Gr(r),data:t});case V.OR:return Ft({parent:new qr(r),data:t});case V.NOT:return Ft({parent:new Wr(r),data:t});case rt.COMMON:default:return new tt(r,t.type,t.id,t.properties)}}function Ft({parent:r,data:t}){const{condition:e,children:n=[],properties:s}=t;if(e){const a=Ur({parent:r,data:e});a&&(r.condition=a)}return n&&n.length&&n.forEach(a=>{const u=Ur({parent:r,data:a});u&&r.appendChild(u)}),s&&r.setProperties(s),r}const Dy={class:"about"},Ly=Yr("\u64A4\u9500"),$y=Yr("\u91CD\u505A"),By={style:{flex:"1"}},Ry=wo({setup(r){const t=te(null),e=te(null),n=te(""),s=te(!1),a=te({}),u=x=>{const{e:P,x:C,y:_,cell:A,view:S}=x;A.isEdge()||(a.value.id=A.id,a.value.label=A.label,s.value=!0)},h=te("first"),d=(x,P)=>{console.log(x,P)},c=(x,P)=>{var _;const C=(_=e.value)==null?void 0:_.container.getBoundingClientRect();return!(!C||P.x<C.left||P.x>C.right||P.y<C.top||P.y>C.bottom)};xo(()=>{const x=document.getElementById("graphContainer");if(x){e.value=new R.Graph({container:x,history:!0,width:800,height:600,background:{color:"#fffbe6"},grid:{size:10,visible:!0},scroller:{enabled:!0,pannable:!0,pageVisible:!0,pageBreak:!1},mousewheel:{enabled:!0,modifiers:["ctrl","meta"]},connecting:{snap:!0,allowBlank:!1,allowLoop:!1,allowEdge:!0,highlight:!0,anchor:"center",connectionPoint:"bbox",connector:{name:"rounded",args:{radius:8}},router:"manhattan",validateConnection:({sourceView:A,targetView:S,sourceMagnet:w,targetMagnet:O})=>A!==S},onEdgeLabelRendered:A=>{}}),e.value.on("cell:dblclick",u),e.value.on("node:added",({node:A})=>{const S=g(e.value,A);if(S&&S.store.data.source.cell){const w=e.value.getCellById(A.id);S.getSourceNode(),S.getTargetNode(),w.shape==="flow-chart-rect-end"||w.shape==="flow-chart-rect-start"}});const P={nodes:[{id:"node1",x:60,y:300,width:30,height:30,label:"\u5F00\u59CB",shape:"image",type:"START",attrs:{image:{x:0,y:0,href:"/src/views/flogComponents/assets/start-icon.svg"},label:{text:"\u5F00\u59CB",fontSize:14,textAnchor:"middle",verticalAnchor:"top",y:35}}},{id:"node2",x:700,y:300,width:30,height:30,label:"\u7ED3\u675F",shape:"image",type:"END",attrs:{image:{x:0,y:0,href:"/src/views/flogComponents/assets/end-icon.svg"},label:{text:"\u7ED3\u675F",fontSize:14,textAnchor:"middle",verticalAnchor:"top",y:35}}}],edges:[{source:"node1",target:"node2",label:""}]};e.value.fromJSON(P),console.log(e.value);const C=p(P);console.log("ast\u7ED3\u6784",JSON.stringify(C,null,2));const _=Ty.build({});console.log("hhhh",_)}else console.error("Container not found");t.value=new Se({validateNode:c})});const i=te(null),o=(x,P)=>{var _,A;if(!P)return null;const C=P.getSourceCell();return C?((A=(_=C.data)==null?void 0:_.props)==null?void 0:A.type)||C.getProp("type"):null},l=(x,P)=>{if(!P)return null;const C=P.getSourceCell();return C?C.id:null},f=x=>{var _,A;const P={x:x.x,y:x.y,target:e.value};if(c(x,P)){const S=e.value.createNode({id:`temp-${Date.now()}`,x:x.x,y:x.y,width:30,height:30}),w=g(e.value,S);if(w){let O=function({idPrefix:J,x:et,y:st,width:Zt=30,height:pe=30,type:Tt,imageUrl:Jr}){const Qe=`${J}-${Date.now()}`,fo=Tt==="common"?Qe:"";return e.value.addNode({id:Qe,x:et,y:st,width:Zt,height:pe,type:Tt,label:fo,shape:"image",attrs:{image:{x:0,y:0,href:Jr},label:{text:fo,fontSize:14,textAnchor:"middle",verticalAnchor:"top",y:35}}})},M=function(J,et,st=""){e.value.addEdge({source:J,target:et,label:st})};const T=o(e.value,w);console.log("\u8FDE\u63A5\u8FB9\u7684\u8D77\u59CB\u8282\u70B9\u7C7B\u578B\uFF1A",T);const j=(_=w.source)==null?void 0:_.cell,N=(A=w.target)==null?void 0:A.cell;T!="WHEN"&&T!="SWITCH"&&e.value.removeEdge(w);const D=e.value.pageToLocal(x.x,x.y);let B=e.value.addNode(Object.assign({},x,D)),F=null;console.log("\u8FD9\u662F\u62D6\u62FD\u8282\u70B9\u7684\u7C7B\u578B",x.data.props.type),x.data.props.type==="THEN"&&(x.data.props.type="common",B&&e.value.removeNode(B.id),B=O({idPrefix:"main",x:x.x,y:x.y,type:"common",imageUrl:"/src/views/flogComponents/assets/common-icon.svg"}),e.value.trigger("change:data",B));const z={WHEN:{endType:"when-end",labelTrue:"",labelFalse:""},SWITCH:{endType:"switch-end",labelTrue:"",labelFalse:""},IF:{endType:"if-end",labelTrue:"true",labelFalse:"false"},FOR:{endType:"for-end",labelTrue:"",labelFalse:""},WHILE:{endType:"while-end",labelTrue:"",labelFalse:""},ITERATOR:{endType:"iterator-end",labelTrue:"",labelFalse:""},AND:{endType:"and-end",labelTrue:"",labelFalse:""},OR:{endType:"or-end",labelTrue:"",labelFalse:""},NOT:{endType:"not-end",labelTrue:"",labelFalse:""}};if(z[x.data.props.type]){const{endType:J,labelTrue:et,labelFalse:st}=z[x.data.props.type],Zt=O({idPrefix:"middle",x:x.x+50,y:x.y,type:"common",imageUrl:"/src/views/flogComponents/assets/common-icon.svg"});F=O({idPrefix:"end",x:x.x+100,y:x.y,type:J,imageUrl:"/src/views/flogComponents/assets/intermediate-end-icon.svg"}),M(B.id,Zt.id,et),st&&M(B.id,F.id,st),M(Zt.id,F.id)}if(x.data.props.type==="CATCH"){const J=x.x+100,et=x.y;F=e.value.addNode({id:`end-${Date.now()}`,x:J,y:et,width:30,height:30,type:"catch-end",label:"",shape:"image",attrs:{image:{x:0,y:0,href:"/src/views/flogComponents/assets/intermediate-end-icon.svg"}}});const st=x.x+50,Zt=x.y-50,pe=e.value.addNode({id:`middle-${Date.now()}`,x:st,y:Zt,width:30,height:30,type:"common",shape:"image",attrs:{image:{x:0,y:0,href:"/src/views/flogComponents/assets/common-icon.svg"}},label:""}),Tt=x.x+50,Jr=x.y+50,Qe=e.value.addNode({id:`middle-${Date.now()}`,x:Tt,y:Jr,width:30,height:30,type:"common",shape:"image",attrs:{image:{x:0,y:0,href:"/src/views/flogComponents/assets/common-icon.svg"}},label:""});e.value.addEdge({source:B.id,target:pe.id,label:""}),e.value.addEdge({source:B.id,target:Qe.id,label:"\u5F02\u5E38"}),e.value.addEdge({source:Qe.id,target:F.id,label:""}),e.value.addEdge({source:pe.id,target:F.id,label:""})}if(e.value.addEdge({source:j,target:B.id,label:""}),T==="WHEN"||T==="SWITCH"){const J=l(e.value,w);console.log("\u8FD9\u662FsourceNodeId",J);const et=m(J,T);console.log("EndNode",et),e.value.addEdge({source:x.data.props.type==="WHEN"||x.data.props.type==="SWITCH"||x.data.props.type==="IF"||x.data.props.type==="FOR"||x.data.props.type==="WHILE"||x.data.props.type==="ITERATOR"||x.data.props.type==="AND"||x.data.props.type==="OR"||x.data.props.type==="NOT"||x.data.props.type==="CATCH"?F.id:B.id,target:et,label:""})}else e.value.addEdge({source:x.data.props.type==="WHEN"||x.data.props.type==="SWITCH"||x.data.props.type==="IF"||x.data.props.type==="FOR"||x.data.props.type==="WHILE"||x.data.props.type==="ITERATOR"||x.data.props.type==="AND"||x.data.props.type==="OR"||x.data.props.type==="NOT"||x.data.props.type==="CATCH"?F.id:B.id,target:N,label:""});i.value.updateElString();const W=e.value.toJSON(),U=W.cells.filter(J=>J.shape!=="edge"),Me=W.cells.filter(J=>J.shape==="edge");console.log("nodes",U);const Ae={nodes:U.map(J=>({id:J.id,label:J.label||"",type:J.type?J.type:J.data.props.type})),edges:Me.map(J=>{var et,st;return{source:(et=J.source)==null?void 0:et.cell,target:(st=J.target)==null?void 0:st.cell,label:J.label||""}})},zt=v(Ae);n.value=zt,console.log("Updated EL:",n.value),i.value.updateELExpression(n.value)}}else console.log("\u8282\u70B9\u65E0\u6CD5\u6DFB\u52A0\u5230\u76EE\u6807\u753B\u5E03")};function g(x,P,C=50){const _=x.getEdges(),A=P.getBBox(),S=[A.leftLine,A.rightLine,A.topLine,A.bottomLine];let w=null;return _.forEach(O=>{const M=x.findViewByCell(O);S.forEach(T=>{console.log(T),M&&M.path.intersectsWithLine(T)&&(w=O)})}),w}function p(x){console.log("\u8FD9\u662F\u63A5\u6536\u5230\u7684data",x);const P=new Map;return x.nodes.forEach(C=>{console.log("\u8FD9\u662F\u904D\u5386\u7684node",C);const _={id:C.id,label:C.label||"",type:C.type,children:[]};P.set(C.id,_)}),x.edges.forEach(C=>{const _=P.get(C.source),A=P.get(C.target);_&&A&&_.children.push(A)}),Array.from(P.values())}const m=(x,P)=>{const C=e.value.toJSON(),_=C.cells.filter(j=>j.shape!=="edge"),A=C.cells.filter(j=>j.shape==="edge");_.filter(j=>j.type===P);const S=_.filter(j=>j.type===`${P.toLowerCase()}-end`),w=A.reduce((j,N)=>{var F,z;const D=(F=N.source)==null?void 0:F.cell,B=(z=N.target)==null?void 0:z.cell;return j[D]||(j[D]=[]),j[B]||(j[B]=[]),j[D].push(B),j[B].push(D),j},{}),O=(j,N)=>{const D=[[j]],B=new Set;for(;D.length>0;){const F=D.shift(),z=F[F.length-1];if(B.has(z))continue;if(B.add(z),z===N)return F;(w[z]||[]).forEach(U=>{B.has(U)||D.push([...F,U])})}return null};return S.map(j=>{const N=O(x,j.id);return{endNodeId:j.id,pathLength:N?N.length-1:1/0}}).reduce((j,N)=>N.pathLength<j.pathLength?N:j,{pathLength:1/0}).endNodeId},y=new Set(["WHEN","THEN","SWITCH","IF","FOR","WHILE","ITERATOR","CATCH","AND","OR","NOT"]);function b(x,P){return P.filter(C=>C.source===x).map(C=>C.target)}function v(x){const P=new Map(x.nodes.map(w=>[w.id,w])),C=new Set;function _(w){if(C.has(w))return"";C.add(w);const O=P.get(w);if(!O)return"";const M=b(w,x.edges);if(y.has(O.type||"")){const T=M.map(j=>_(j)).filter(Boolean);return T.length===0?w:`${O.type}(${T.join(", ")})`}return O.type&&O.type.endsWith("-end")?"":w}return x.nodes.filter(w=>y.has(w.type||"")).map(w=>_(w.id)).filter(Boolean).join(";")}return Tu(n,x=>{console.log(11111,x)},{deep:!0}),(x,P)=>{const C=ju,_=Du,A=Lu,S=$u,w=Bu,O=Ru;return Ne(),Te("div",Dy,[jt("div",{ref:(M,T)=>{T.graph=M,e.value=M},id:"graphContainer",style:{flex:"3",border:"1px solid #ccc"}},null,512),jt("div",null,[bt(C,{onClick:x.undo},{default:Qt(()=>[Ly]),_:1},8,["onClick"]),bt(C,{onClick:x.redo},{default:Qt(()=>[$y]),_:1},8,["onClick"])]),bt(xy,{style:{flex:"1"},ref:(M,T)=>{T.drawer=M},onAddNode:f},null,512),jt("div",By,[bt(O,{modelValue:h.value,"onUpdate:modelValue":P[2]||(P[2]=M=>h.value=M),class:"demo-tabs",onTabClick:d},{default:Qt(()=>[bt(_,{label:"EL\u8868\u8FBE\u5F0F",name:"first"},{default:Qt(()=>[bt(Sy,{ref:(M,T)=>{T.basicComponent=M,i.value=M},flowGraph:{graph:e.value}},null,8,["flowGraph"])]),_:1}),bt(_,{label:"\u8282\u70B9\u5C5E\u6027",name:"second"},{default:Qt(()=>[bt(w,{model:a.value,"label-width":"auto",style:{"max-width":"600px"}},{default:Qt(()=>[bt(S,{label:"id:"},{default:Qt(()=>[bt(A,{modelValue:a.value.id,"onUpdate:modelValue":P[0]||(P[0]=M=>a.value.id=M)},null,8,["modelValue"])]),_:1}),bt(S,{label:"label:"},{default:Qt(()=>[bt(A,{modelValue:a.value.label,"onUpdate:modelValue":P[1]||(P[1]=M=>a.value.label=M)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"])])])}}});var zy=Kr(Ry,[["__scopeId","data-v-6add363e"]]);export{zy as default};
